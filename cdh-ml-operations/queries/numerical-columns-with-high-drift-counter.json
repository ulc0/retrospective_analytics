"SELECT \n  granularity AS Granularity,\n  COALESCE(slice_key, \"No slice\") AS `Slice key`,\n  COALESCE(slice_value, \"No slice\") AS `Slice value`,\n  --\n  -- CHANGE METRIC AND THRESHOLDs BELOW TO TUNE DRIFT DETECTION\n  --\n  SUM(IF(ks_test.pvalue < 0.05,1,0)) as count\nFROM `edav_dev_cdh_test`.`dev_cdh_ml_test`.`ml_fs_patbill_drift_metrics`\nWHERE ks_test is NOT NULL -- limit to numerical columns\n  AND drift_type = \"CONSECUTIVE\" -- only consider consecutive drift\n  AND window.start = (SELECT MAX(window.start) from `edav_dev_cdh_test`.`dev_cdh_ml_test`.`ml_fs_patbill_drift_metrics` WHERE drift_type=\"CONSECUTIVE\") -- limit to last window\nGROUP BY 1,2,3"