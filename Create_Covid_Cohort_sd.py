# Databricks notebook source
# MAGIC %md 
# MAGIC ### Create Covid Cohort 

# COMMAND ----------

# MAGIC %md
# MAGIC
# MAGIC This script is designed to create a function that will build the COVID-19 population for Premier data. A user will be able to read in the notebook directly into their workspace. An example will be shown below.
# MAGIC
# MAGIC **Function**: ***covid_cohort***:   
# MAGIC 1) User determines which data types should be used to define the covid population.  The options are only diagnosis, only labs, or all 
# MAGIC 2) Build covid cohort based on selected data types  
# MAGIC 3) Create a row number to filter down to only one row per covid encounter is in the final dataframe  
# MAGIC 4) Return final dataframe  
# MAGIC
# MAGIC **Function**: ***first_covid_cohort***:  
# MAGIC 1) Read in the ***covid_cohort*** with defined parameter values  
# MAGIC 2) Reduces dataframe to only be the first occurence of a covid encounter for each covid patient out of all covid encounters per covid patient ; Occurences are ordered by ADM_MON, DISC_MON, DISC_MON respectively. 
# MAGIC <br>
# MAGIC <br>

# COMMAND ----------


from pyspark.sql import SparkSession 


# COMMAND ----------

# MAGIC %sql
# MAGIC use edav_prd_cdh.cdh_premier

# COMMAND ----------

def covid_cohort(diagnosis=True,labs=False, loinc=False):
    """create covid cohort based on diagnosis codes"""
    windowDept=W.Window.partitionBy("MEDREC_KEY","PAT_KEY").orderBy(F.col("ADM_MON"),F.col("DISC_MON"),F.col("DISC_MON_SEQ"))
    
    diag_cohort=(
        icd_code.select("PAT_KEY","ICD_PRI_SEC","ICD_CODE")
        .join(patdemo, "PAT_KEY", "inner")#.filter("DISC_MON >= 2021205")
        .filter("(ICD_PRI_SEC in ('P','S')) and (ICD_CODE in ('U07.1', 'U07.2', 'J12.82'))" )
        .withColumnRenamed("COVID_PAT_KEY","PAT_KEY")
        .withColumn("Type",F.lit("DX"))
    )
    """Get one row per encounter"""
    diag_cohort=diag_cohort.withColumn("RN",F.row_number().over(windowDept)).filter(F.col("RN")==1)
    
    """create covid cohort based on lab codes"""
    labs_cohort=(
        patlabres
        .select("PAT_KEY","TEST","OBSERVATION")
        .join(patdemo,"PAT_KEY","inner")
        .filter("TEST in ('SARS coronavirus 2 RNA:PrThr:Pt:Respiratory:Ord:Probe.amp.tar','SARS coronavirus 2 RNA:PrThr:Pt:XXX:Ord:Probe.amp.tar') and observation='positive'")
        .withColumnRenamed("COVID_PAT_KEY","PAT_KEY")
        .withColumn("Type",F.lit("LAB"))
    )
    
    """Get one row per encounter"""
    labs_cohort=labs_cohort.withColumn("RN",F.row_number().over(windowDept)).filter(F.col("RN")==1)
    
    """create covid cohort based on loinc code """
    loinc_cohort=(
        genlab
        .select("PAT_KEY","LAB_TEST_LOINC_CODE","LAB_TEST_RESULT")
        .join(patdemo,"PAT_KEY","inner")
        .filter("lab_test_loinc_code in ('94500-6','94845-5', '94534-5', '94756-4', '94757-2', '94559-2', '94533-7', '94502-2', '92142-9', '92141-1', '94309-2', '94307-6', '94308-4', '68993-5', '95406-5', '95409-9', '96091-4', '95425-5', '94758-0', '95423-0', '96448-6') and lab_test_result='Detected'")
        .withColumnRenamed("COVID_PAT_KEY","PAT_KEY")
        .withColumn("Type",F.lit("LOINC"))
    )
    
    """Get one row per encounter"""
    loinc_cohort=loinc_cohort.withColumn("RN",F.row_number().over(windowDept)).filter(F.col("RN")==1)
    
    if (diagnosis==True) and ((labs==False) and (loinc==False)) :
        final= diag_cohort
    elif (labs==True) and ((diagnosis)==False and (loinc==False)):
        final=labs_cohort
    else:
        final= diag_cohort.union(labs_cohort)#.union(loinc_cohort)
        final=final.withColumn("RN",F.row_number().over(windowDept)).filter( (F.col("RN")==1) &(F.col('DISC_MON') > 2020102) )
    return final
     

def first_covid_cohort(diagnosis=True,labs=False, loinc=False):
    """read in function that defines covid cohort and reduce to only the 1st encounter per medrec key"""
    all_covid=covid_cohort(diagnosis=True, labs=False, loinc=False)
    
    windowDept=W.Window.partitionBy("MEDREC_KEY").orderBy(F.col("ADM_MON"),F.col("DISC_MON"),F.col("DISC_MON_SEQ"))
    first=(
        all_covid
        .withColumn("RN",F.row_number().over(windowDept))
        .filter((F.col("RN")==1) & (F.col('DISC_MON') > 2020102))
    )
    return first 


# COMMAND ----------

# Create Underlying conditions 
icd_code = spark.sql("""

select 
     PAT_KEY,
     ICD_VERSION,
     ICD_CODE,
     ICD_PRI_SEC,
     ICD_POA,
     year as year_icd,

(Case when icd_code in ('I60', 'I60.0', 'I60.00', 'I60.01', 'I60.02', 'I60.1', 'I60.10', 'I60.11', 'I60.12', 'I60.2', 'I60.3', 'I60.30', 'I60.31', 'I60.32', 'I60.4', 'I60.5', 'I60.50', 'I60.51', 'I60.52', 'I60.6', 'I60.7', 'I60.8', 'I60.9', 'I61', 'I61.0', 'I61.1', 'I61.2', 'I61.3', 'I61.4', 'I61.5', 'I61.6', 'I61.8', 'I61.9', 'I62', 'I62.0', 'I62.00', 'I62.01', 'I62.02', 'I62.03', 'I62.1', 'I62.9', 'I63', 'I63', 'I63', 'I63.01', 'I63.011', 'I63.012', 'I63.013', 'I63.019', 'I63.02', 'I63.03', 'I63.031', 'I63.032', 'I63.033', 'I63.039', 'I63.09', 'I63.1', 'I63.1', 'I63.11', 'I63.111', 'I63.112', 'I63.113', 'I63.119', 'I63.12', 'I63.13', 'I63.131', 'I63.132', 'I63.133', 'I63.139', 'I63.19', 'I63.2', 'I63.2', 'I63.21', 'I63.211', 'I63.212', 'I63.213', 'I63.219', 'I63.22', 'I63.23', 'I63.231', 'I63.232', 'I63.233', 'I63.239', 'I63.29', 'I63.3', 'I63.3', 'I63.31', 'I63.311', 'I63.312', 'I63.313', 'I63.319', 'I63.32', 'I63.321', 'I63.322', 'I63.323', 'I63.329', 'I63.33', 'I63.331', 'I63.332', 'I63.333', 'I63.339', 'I63.34', 'I63.341', 'I63.342', 'I63.343', 'I63.349', 'I63.39', 'I63.4', 'I63.4', 'I63.41', 'I63.411', 'I63.412', 'I63.413', 'I63.419', 'I63.42', 'I63.421', 'I63.422', 'I63.423', 'I63.429', 'I63.43', 'I63.431', 'I63.432', 'I63.433', 'I63.439', 'I63.44', 'I63.441', 'I63.442', 'I63.443', 'I63.449', 'I63.49', 'I63.5', 'I63.5', 'I63.51', 'I63.511', 'I63.512', 'I63.513', 'I63.519', 'I63.52', 'I63.521', 'I63.522', 'I63.523', 'I63.529', 'I63.53', 'I63.531', 'I63.532', 'I63.533', 'I63.539', 'I63.54', 'I63.541', 'I63.542', 'I63.543', 'I63.549', 'I63.59', 'I63.6', 'I63.8', 'I63.81', 'I63.89', 'I63.9', 'I65', 'I65', 'I65.01', 'I65.02', 'I65.03', 'I65.09', 'I65.1', 'I65.2', 'I65.21', 'I65.22', 'I65.23', 'I65.29', 'I65.8', 'I65.9', 'I66', 'I66', 'I66.01', 'I66.02', 'I66.03', 'I66.09', 'I66.1', 'I66.11', 'I66.12', 'I66.13', 'I66.19', 'I66.2', 'I66.21', 'I66.22', 'I66.23', 'I66.29', 'I66.3', 'I66.8', 'I66.9', 'I67', 'I67', 'I67.1', 'I67.2', 'I67.3', 'I67.4', 'I67.5', 'I67.6', 'I67.7', 'I67.8', 'I67.81', 'I67.82', 'I67.83', 'I67.84', 'I67.841', 'I67.848', 'I67.85', 'I67.85', 'I67.858', 'I67.89', 'I67.9', 'I68', 'I68', 'I68.2', 'I68.8', 'I69', 'I69', 'I69', 'I69.01', 'I69.01', 'I69.011', 'I69.012', 'I69.013', 'I69.014', 'I69.015', 'I69.018', 'I69.019', 'I69.02', 'I69.02', 'I69.021', 'I69.022', 'I69.023', 'I69.028', 'I69.03', 'I69.031', 'I69.032', 'I69.033', 'I69.034', 'I69.039', 'I69.04', 'I69.041', 'I69.042', 'I69.043', 'I69.044', 'I69.049', 'I69.05', 'I69.051', 'I69.052', 'I69.053', 'I69.054', 'I69.059', 'I69.06', 'I69.061', 'I69.062', 'I69.063', 'I69.064', 'I69.065', 'I69.069', 'I69.09', 'I69.09', 'I69.091', 'I69.092', 'I69.093', 'I69.098', 'I69.1', 'I69.1', 'I69.11', 'I69.11', 'I69.111', 'I69.112', 'I69.113', 'I69.114', 'I69.115', 'I69.118', 'I69.119', 'I69.12', 'I69.12', 'I69.121', 'I69.122', 'I69.123', 'I69.128', 'I69.13', 'I69.131', 'I69.132', 'I69.133', 'I69.134', 'I69.139', 'I69.14', 'I69.141', 'I69.142', 'I69.143', 'I69.144', 'I69.149', 'I69.15', 'I69.151', 'I69.152', 'I69.153', 'I69.154', 'I69.159', 'I69.16', 'I69.161', 'I69.162', 'I69.I63', 'I69.164', 'I69.I65', 'I69.I69', 'I69.19', 'I69.19', 'I69.191', 'I69.192', 'I69.193', 'I69.198', 'I69.2', 'I69.2', 'I69.21', 'I69.21', 'I69.211', 'I69.212', 'I69.213', 'I69.214', 'I69.215', 'I69.218', 'I69.219', 'I69.22', 'I69.22', 'I69.221', 'I69.222', 'I69.223', 'I69.228', 'I69.23', 'I69.231', 'I69.232', 'I69.233', 'I69.234', 'I69.239', 'I69.24', 'I69.241', 'I69.242', 'I69.243', 'I69.244', 'I69.249', 'I69.25', 'I69.251', 'I69.252', 'I69.253', 'I69.254', 'I69.259', 'I69.26', 'I69.261', 'I69.262', 'I69.263', 'I69.264', 'I69.265', 'I69.269', 'I69.29', 'I69.29', 'I69.291', 'I69.292', 'I69.293', 'I69.298', 'I69.3', 'I69.3', 'I69.31', 'I69.31', 'I69.311', 'I69.312', 'I69.313', 'I69.314', 'I69.315', 'I69.318', 'I69.319', 'I69.32', 'I69.32', 'I69.321', 'I69.322', 'I69.323', 'I69.328', 'I69.33', 'I69.331', 'I69.332', 'I69.333', 'I69.334', 'I69.339', 'I69.34', 'I69.341', 'I69.342', 'I69.343', 'I69.344', 'I69.349', 'I69.35', 'I69.351', 'I69.352', 'I69.353', 'I69.354', 'I69.359', 'I69.36', 'I69.361', 'I69.362', 'I69.363', 'I69.364', 'I69.365', 'I69.369', 'I69.39', 'I69.39', 'I69.391', 'I69.392', 'I69.393', 'I69.398', 'I69.8', 'I69.8', 'I69.81', 'I69.81', 'I69.811', 'I69.812', 'I69.813', 'I69.814', 'I69.815', 'I69.818', 'I69.819', 'I69.82', 'I69.82', 'I69.821', 'I69.822', 'I69.823', 'I69.828', 'I69.83', 'I69.831', 'I69.832', 'I69.833', 'I69.834', 'I69.839', 'I69.84', 'I69.841', 'I69.842', 'I69.843', 'I69.844', 'I69.849', 'I69.85', 'I69.851', 'I69.852', 'I69.853', 'I69.854', 'I69.859', 'I69.86', 'I69.861', 'I69.862', 'I69.863', 'I69.864', 'I69.865', 'I69.869', 'I69.89', 'I69.89', 'I69.891', 'I69.892', 'I69.893', 'I69.898', 'I69.9', 'I69.9', 'I69.91', 'I69.91', 'I69.911', 'I69.912', 'I69.913', 'I69.914', 'I69.915', 'I69.918', 'I69.919', 'I69.92', 'I69.92', 'I69.921', 'I69.922', 'I69.923', 'I69.928', 'I69.93', 'I69.931', 'I69.932', 'I69.933', 'I69.934', 'I69.939', 'I69.94', 'I69.941', 'I69.942', 'I69.943', 'I69.944', 'I69.949', 'I69.95', 'I69.951', 'I69.952', 'I69.953', 'I69.954', 'I69.959', 'I69.96', 'I69.961', 'I69.962', 'I69.963', 'I69.964', 'I69.965', 'I69.969', 'I69.99', 'I69.99', 'I69.991', 'I69.992', 'I69.993', 'I69.998')
then 1 else 0 end) as Cerebrovascular_Disease,

 (Case when icd_code in ('C00', 'C00.0', 'C00.1', 'C00.2', 'C00.3', 'C00.4', 'C00.5', 'C00.6', 'C00.8', 'C00.9', 'C01', 'C02', 'C02.0', 'C02.1', 'C02.2', 'C02.3', 'C02.4', 'C02.8', 'C02.9', 'C03', 'C03.0', 'C03.1', 'C03.9', 'C04', 'C04.0', 'C04.1', 'C04.8', 'C04.9', 'C05', 'C05.0', 'C05.1', 'C05.2', 'C05.8', 'C05.9', 'C06', 'C06.0', 'C06.1', 'C06.2', 'C06.8', 'C06.80', 'C06.89', 'C06.9', 'C07', 'C08', 'C08.0', 'C08.1', 'C08.9', 'C09', 'C09.0', 'C09.1', 'C09.8', 'C09.9', 'C10', 'C10.0', 'C10.1', 'C10.2', 'C10.3', 'C10.4', 'C10.8', 'C10.9', 'C11', 'C11.0', 'C11.1', 'C11.2', 'C11.3', 'C11.8', 'C11.9', 'C12', 'C13', 'C13.0', 'C13.1', 'C13.2', 'C14', 'C14.0', 'C14.2', 'C14.8', 'C15', 'C15.3', 'C15.4', 'C15.5', 'C15.8', 'C15.9', 'C16', 'C16.0', 'C16.1', 'C16.2', 'C16.3', 'C16.4', 'C16.5', 'C16.6', 'C16.8', 'C16.9', 'C17', 'C17.0', 'C17.1', 'C17.2', 'C17.3', 'C17.8', 'C17.9', 'C18', 'C18.0', 'C18.1', 'C18.2', 'C18.3', 'C18.4', 'C18.5', 'C18.6', 'C18.7', 'C18.8', 'C18.9', 'C19', 'C20', 'C21', 'C21.0', 'C21.1', 'C21.2', 'C21.8', 'C22', 'C22.0', 'C22.1', 'C22.2', 'C22.3', 'C22.4', 'C22.7', 'C22.8', 'C22.9', 'C23', 'C24', 'C24.0', 'C24.1', 'C24.8', 'C24.9', 'C25', 'C25.0', 'C25.1', 'C25.2', 'C25.3', 'C25.4', 'C25.7', 'C25.8', 'C25.9', 'C26', 'C26.0', 'C26.1', 'C26.9', 'C30', 'C30.0', 'C30.1', 'C31', 'C31.0', 'C31.1', 'C31.2', 'C31.3', 'C31.8', 'C31.9', 'C32', 'C32.0', 'C32.1', 'C32.2', 'C32.3', 'C32.8', 'C32.9', 'C33', 'C34', 'C34.0', 'C34.00', 'C34.01', 'C34.02', 'C34.1', 'C34.10', 'C34.11', 'C34.12', 'C34.2', 'C34.3', 'C34.30', 'C34.31', 'C34.32', 'C34.8', 'C34.80', 'C34.81', 'C34.82', 'C34.9', 'C34.90', 'C34.91', 'C34.92', 'C37', 'C38', 'C38.0', 'C38.1', 'C38.2', 'C38.3', 'C38.4', 'C38.8', 'C39', 'C39.0', 'C39.9', 'C40', 'C40.0', 'C40.00', 'C40.01', 'C40.02', 'C40.1', 'C40.10', 'C40.11', 'C40.12', 'C40.2', 'C40.20', 'C40.21', 'C40.22', 'C40.3', 'C40.30', 'C40.31', 'C40.32', 'C40.8', 'C40.80', 'C40.81', 'C40.82', 'C40.9', 'C40.90', 'C40.91', 'C40.92', 'C41', 'C41.0', 'C41.1', 'C41.2', 'C41.3', 'C41.4', 'C41.9', 'C43', 'C43.0', 'C43.1', 'C43.10', 'C43.11', 'C43.111', 'C43.112', 'C43.12', 'C43.121', 'C43.122', 'C43.2', 'C43.20', 'C43.21', 'C43.22', 'C43.3', 'C43.30', 'C43.31', 'C43.39', 'C43.4', 'C43.5', 'C43.51', 'C43.52', 'C43.59', 'C43.6', 'C43.60', 'C43.61', 'C43.62', 'C43.7', 'C43.70', 'C43.71', 'C43.72', 'C43.8', 'C43.9', 'C45', 'C45.0', 'C45.1', 'C45.1', 'C45.2', 'C45.7', 'C45.9', 'C46', 'C46.0', 'C46.1', 'C46.2', 'C46.3', 'C46.4', 'C46.5', 'C46.50', 'C46.51', 'C46.52', 'C46.7', 'C46.9', 'C47', 'C47.0', 'C47.1', 'C47.10', 'C47.11', 'C47.12', 'C47.2', 'C47.20', 'C47.21', 'C47.22', 'C47.3', 'C47.4', 'C47.5', 'C47.6', 'C47.8', 'C47.9', 'C48', 'C48.0', 'C48.1', 'C48.2', 'C48.8', 'C49', 'C49.0', 'C49.1', 'C49.10', 'C49.11', 'C49.12', 'C49.2', 'C49.20', 'C49.21', 'C49.22', 'C49.3', 'C49.4', 'C49.5', 'C49.6', 'C49.8', 'C49.9', 'C49.A', 'C49.A0', 'C49.A1', 'C49.A2', 'C49.A3', 'C49.A4', 'C49.A5', 'C49.A9', 'C50', 'C50.0', 'C50.01', 'C50.011', 'C50.012', 'C50.019', 'C50.02', 'C50.021', 'C50.022', 'C50.029', 'C50.1', 'C50.11', 'C50.111', 'C50.112', 'C50.119', 'C50.12', 'C50.121', 'C50.122', 'C50.129', 'C50.2', 'C50.21', 'C50.211', 'C50.212', 'C50.219', 'C50.22', 'C50.221', 'C50.222', 'C50.229', 'C50.3', 'C50.31', 'C50.311', 'C50.312', 'C50.319', 'C50.32', 'C50.321', 'C50.322', 'C50.329', 'C50.4', 'C50.41', 'C50.411', 'C50.412', 'C50.419', 'C50.42', 'C50.421', 'C50.422', 'C50.429', 'C50.5', 'C50.51', 'C50.511', 'C50.512', 'C50.519', 'C50.52', 'C50.521', 'C50.522', 'C50.529', 'C50.6', 'C50.61', 'C50.611', 'C50.612', 'C50.619', 'C50.62', 'C50.621', 'C50.622', 'C50.629', 'C50.8', 'C50.81', 'C50.811', 'C50.812', 'C50.819', 'C50.82', 'C50.821', 'C50.822', 'C50.829', 'C50.9', 'C50.91', 'C50.911', 'C50.912', 'C50.919', 'C50.92', 'C50.921', 'C50.922', 'C50.929', 'C51', 'C51.0', 'C51.1', 'C51.2', 'C51.8', 'C51.9', 'C52', 'C53', 'C53.0', 'C53.1', 'C53.8', 'C53.9', 'C54', 'C54.0', 'C54.1', 'C54.2', 'C54.3', 'C54.8', 'C54.9', 'C55', 'C56', 'C56.1', 'C56.2', 'C56.9', 'C57', 'C57.0', 'C57.00', 'C57.01', 'C57.02', 'C57.1', 'C57.10', 'C57.11', 'C57.12', 'C57.2', 'C57.20', 'C57.21', 'C57.22', 'C57.3', 'C57.4', 'C57.7', 'C57.8', 'C57.9', 'C58', 'C60', 'C60.0', 'C60.1', 'C60.2', 'C60.8', 'C60.9', 'C61', 'C62', 'C62.0', 'C62.00', 'C62.01', 'C62.02', 'C62.1', 'C62.10', 'C62.11', 'C62.12', 'C62.9', 'C62.90', 'C62.91', 'C62.92', 'C63', 'C63.0', 'C63.00', 'C63.01', 'C63.02', 'C63.1', 'C63.10', 'C63.11', 'C63.12', 'C63.2', 'C63.7', 'C63.8', 'C63.9', 'C64', 'C64.1', 'C64.2', 'C64.9', 'C65', 'C65.1', 'C65.2', 'C65.9', 'C66', 'C66.1', 'C66.2', 'C66.9', 'C67', 'C67.0', 'C67.1', 'C67.2', 'C67.3', 'C67.4', 'C67.5', 'C67.6', 'C67.7', 'C67.8', 'C67.9', 'C68', 'C68.0', 'C68.1', 'C68.2', 'C68.8', 'C68.9', 'C69', 'C69.0', 'C69.00', 'C69.01', 'C69.02', 'C69.1', 'C69.10', 'C69.11', 'C69.12', 'C69.2', 'C69.20', 'C69.21', 'C69.22', 'C69.3', 'C69.30', 'C69.31', 'C69.32', 'C69.4', 'C69.40', 'C69.41', 'C69.42', 'C69.5', 'C69.50', 'C69.51', 'C69.52', 'C69.6', 'C69.60', 'C69.61', 'C69.62', 'C69.8', 'C69.80', 'C69.81', 'C69.82', 'C69.9', 'C69.90', 'C69.91', 'C69.92', 'C70', 'C70.0', 'C70.1', 'C70.9', 'C71', 'C71.0', 'C71.1', 'C71.2', 'C71.3', 'C71.4', 'C71.5', 'C71.6', 'C71.7', 'C71.8', 'C71.9', 'C72', 'C72.0', 'C72.1', 'C72.2', 'C72.20', 'C72.21', 'C72.22', 'C72.3', 'C72.30', 'C72.31', 'C72.32', 'C72.4', 'C72.40', 'C72.41', 'C72.42', 'C72.5', 'C72.50', 'C72.59', 'C72.9', 'C73', 'C74', 'C74.0', 'C74.00', 'C74.01', 'C74.02', 'C74.1', 'C74.10', 'C74.11', 'C74.12', 'C74.9', 'C74.90', 'C74.91', 'C74.92', 'C75', 'C75.0', 'C75.1', 'C75.2', 'C75.3', 'C75.4', 'C75.5', 'C75.8', 'C75.9', 'C76', 'C76.0', 'C76.1', 'C76.2', 'C76.3', 'C76.4', 'C76.40', 'C76.41', 'C76.42', 'C76.5', 'C76.50', 'C76.51', 'C76.52', 'C76.8', 'C77', 'C77.0', 'C77.1', 'C77.2', 'C77.3', 'C77.4', 'C77.5', 'C77.8', 'C77.9', 'C78', 'C78.0', 'C78.00', 'C78.01', 'C78.02', 'C78.1', 'C78.2', 'C78.3', 'C78.30', 'C78.39', 'C78.4', 'C78.5', 'C78.6', 'C78.7', 'C78.8', 'C78.80', 'C78.89', 'C79', 'C79.0', 'C79.00', 'C79.01', 'C79.02', 'C79.1', 'C79.10', 'C79.11', 'C79.19', 'C79.2', 'C79.3', 'C79.31', 'C79.32', 'C79.4', 'C79.40', 'C79.49', 'C79.5', 'C79.51', 'C79.52', 'C79.6', 'C79.60', 'C79.61', 'C79.62', 'C79.7', 'C79.70', 'C79.71', 'C79.72', 'C79.8', 'C79.81', 'C79.82', 'C79.89', 'C79.9', 'C80', 'C80.0', 'C80.1', 'C80.2', 'C7A', 'C7A.0', 'C7A.00', 'C7A.01', 'C7A.010', 'C7A.011', 'C7A.012', 'C7A.019', 'C7A.02', 'C7A.020', 'C7A.021', 'C7A.022', 'C7A.023', 'C7A.024', 'C7A.025', 'C7A.026', 'C7A.029', 'C7A.09', 'C7A.090', 'C7A.091', 'C7A.092', 'C7A.093', 'C7A.094', 'C7A.095', 'C7A.096', 'C7A.098', 'C7A.1', 'C7A.8', 'C7B', 'C7B.0', 'C7B.00', 'C7B.01', 'C7B.02', 'C7B.03', 'C7B.04', 'C7B.09', 'C7B.1', 'C7B.8', 'C81', 'C81.0', 'C81.00', 'C81.01', 'C81.02', 'C81.03', 'C81.04', 'C81.05', 'C81.06', 'C81.07', 'C81.08', 'C81.09', 'C81.1', 'C81.10', 'C81.11', 'C81.12', 'C81.13', 'C81.14', 'C81.15', 'C81.16', 'C81.17', 'C81.18', 'C81.19', 'C81.2', 'C81.20', 'C81.21', 'C81.22', 'C81.23', 'C81.24', 'C81.25', 'C81.26', 'C81.27', 'C81.28', 'C81.29', 'C81.3', 'C81.30', 'C81.31', 'C81.32', 'C81.33', 'C81.34', 'C81.35', 'C81.36', 'C81.37', 'C81.38', 'C81.39', 'C38.4', 'C81.40', 'C81.41', 'C81.42', 'C81.43', 'C81.44', 'C81.45', 'C81.46', 'C81.47', 'C81.48', 'C81.49', 'C81.7', 'C81.70', 'C81.72', 'C81.73', 'C81.74', 'C8.75', 'C81.76', 'C81.77', 'C81.78', 'C81.79', 'C81.9', 'C81.90', 'C81.91', 'C81.92', 'C81.93', 'C81.94', 'C81.95', 'C81.96', 'C81.97', 'C81.98', 'C81.99', 'C82', 'C82.0 ', 'C82.00', 'C82.01', 'C82.02', 'C82.03', 'C82.04', 'C82.05', 'C82.06', 'C82.07', 'C82.08', 'C82.09', 'C82.1', 'C82.10', 'C82.11', 'C82.12', 'C82.13', 'C82.14', 'C82.15', 'C82.16', 'C82.17', 'C82.18', 'C82.19', 'C82.2', 'C82.20', 'C82.21', 'C82.22', 'C82.23', 'C82.24', 'C82.25', 'C82.26', 'C82.27', 'C82.28', 'C82.29', 'C82.3', 'C82.30', 'C82.31', 'C82.32', 'C82.33', 'C82.34', 'C82.35', 'C82.36', 'C82.37', 'C82.38', 'C82.39', 'C82.4', 'C82.40', 'C82.41', 'C82.42', 'C82.43', 'C82.44', 'C82.45', 'C82.46', 'C82.47', 'C82.48', 'C82.49', 'C82.5', 'C82.50', 'C82.51', 'C82.52', 'C82.53', 'C852.54', 'C82.55', 'C82.56', 'C82.57', 'C82.58', 'C82.59', 'C82.6', 'C82.60', 'C82.61', 'C82.62', 'C82.63', 'C82.64', 'C82.65', 'C82.66', 'C82.67', 'C82.68', 'C82.69', 'C82.8', 'C82.80', 'C82.81', 'C82.82', 'C82.83', 'C82.84', 'C82.85', 'C82.86', 'C82.87', 'C82.88', 'C82.89', 'C82.9', 'C82.90', 'C82.91', 'C82.92', 'C82.93', 'C82.94', 'C82.95', 'C82.96', 'C82.97', 'C82.98', 'C82.99', 'C83', 'C83.0', 'C83.00', 'C83.01', 'C83.02', 'C83.03', 'C83.04', 'C83.05', 'C83.06', 'C83.07', 'C83.08', 'C83.08', 'C83.09', 'C83.1', 'C83.10', 'C83.11', 'C83.12', 'C83.13', 'C83.14', 'C83.15', 'C83.16', 'C83.17', 'C83.18', 'C83.19', 'C83.3', 'C83.30', 'C83.31', 'C83.32', 'C83.33', 'C83.34', 'C83.35', 'C83.36', 'C83.37', 'C83.38', 'C83.39', 'C83.5', 'C83.50', 'C83.51', 'C83.52', 'C83.53', 'C83.54', 'C83.55', 'C83.56', 'C83.57', 'C83.58', 'C83.59', 'C83.7', 'C83.70', 'C83.71', 'C83.72', 'C83.73', 'C83.74', 'C83.75', 'C83.76', 'C83.77', 'C83.78', 'C83.79', 'C83.8', 'C83.80', 'C83.81', 'C38.82', 'C83.83', 'C83.84', 'C83.85', 'C83.86', 'C83.87', 'C83.88', 'C83.89', 'C83.9', 'C83.90', 'C83.91', 'C83.92', 'C83.93', 'C83.94', 'C83.95', 'C83.96', 'C83.97', 'C83.98', 'C83.99', 'C84', 'C84.0', 'C84.00', 'C84.01', 'C84.02', 'C84.03', 'C84.04', 'C84.05', 'C84.06', 'C84.07', 'C84.08', 'C84.09', 'C84.1', 'C84.10', 'C84.11', 'C84.12', 'C84.13', 'C84.14', 'C84.15', 'C84.16', 'C84.17', 'C84.18', 'C84.19', 'C84.4', 'C84.40', 'C84.41', 'C84.42', 'C84.43', 'C84.44', 'C84.45', 'C84.46', 'C84.47', 'C84.48', 'C84.49', 'C84.6', 'C84.60', 'C84.61', 'C84.62', 'C84.63', 'C84.64', 'C84.65', 'C84.66', 'C84.67', 'C84.68', 'C84.69', 'C84.7', 'C84.70', 'C84.71', 'C84.72', 'C84.73', 'C84.74', 'C84.75', 'C84.76', 'C84.77', 'C84.78', 'C84.79', 'C84.A', 'C84.A0', 'C84.A1', 'C84.A2', 'C84.A3', 'C84.A4', 'C84.A5', 'C84.A6', 'C84.A7', 'C84.A8', 'C84.A9', 'C84.Z', 'C84.Z0', 'C84.Z1', 'C84.Z2',
'C84.Z3', 'C84.Z4', 'C84.Z5', 'C84.Z6', 'C84.Z7', 'C84.Z8', 'C84.Z9', 'C84.9', 'C84.90', 'C84.91', 'C84.92', 'C84.93', 'C84.94', 'C84.95', 'C84.96', 'C84.97', 'C84.98', 'C84.99', 'C85', 'C85.1', 'C85.10', 'C85.11', 'C85.12', 'C85.13', 'C85.14', 'C85.15', 'C85.16', 'C85.17', 'C85.18', 'C85.19', 'C85.2', 'C85.20', 'C85.21', 'C85.22', 'C85.23', 'C85.24', 'C85.25', 'C85.26', 'C85.27', 'C85.28', 'C85.29', 'C85.8', 'C85.80', 'C85.81', 'C85.82', 'C85.83', 'C85.84', 'C85.85', 'C85.86', 'C85.87', 'C85.88', 'C85.89', 'C85.9', 'C85.90', 'C85.91', 'C85.92', 'C85.93', 'C85.94', 'C85.95', 'C85.96', 'C85.97', 'C85.98', 'C85.99', 'C86', 'C86.0', 'C86.1', 'C86.2', 'C86.3', 'C86.4', 'C86.5', 'C86.6', 'C88', 'C88.0', 'C88.2', 'C88.3', 'C88.4', 'C88.8', 'C88.9', 'C90', 'C90.0', 'C90.00', 'C90.01', 'C90.02', 'C90.1', 'C90.10', 'C90.11', 'C90.12', 'C90.2', 'C90.20', 'C90.21', 'C90.22', 'C90.3', 'C90.30', 'C90.31', 'C90.32', 'C91', 'C91.0', 'C91.00', 'C91.01', 'C91.02', 'C91.1', 'C91.10', 'C91.11', 'C91.12', 'C91.3', 'C91.30', 'C91.31', 'C91.32', 'C91.4', 'C91.40', 'C91.41', 'C91.42', 'C91.5', 'C91.50', 'C91.51', 'C91.52', 'C91.6', 'C91.60', 'C91.61', 'C91.62', 'C91.A', 'C91.A0', 'C91.A1', 'C91.A2', 'C91.Z', 'C91.Z0', 'C91.Z1', 'C91.Z2', 'C91.9', 'C91.90', 'C91.91', 'C91.92', 'C92', 'C92.0', 'C92.00', 'C92.01', 'C92.02', 'C92.1', 'C92.10', 'C92.11', 'C92.12', 'C92.2', 'C92.20', 'C92.21', 'C92.22', 'C92.3', 'C92.30', 'C92.31', 'C92.32', 'C92.4', 'C92.40', 'C92.41', 'C92.42', 'C92.5', 'C92.50', 'C92.51', 'C92.52', 'C92.6', 'C92.60', 'C92.61', 'C92.62', 'C92.A', 'C92.A0', 'C92.A1', 'C92.A2', 'C92.Z', 'C92.Z0', 'C92.Z1', 'C92.Z2', 'C92.9', 'C92.90', 'C92.91', 'C92.92', 'C93', 'C93.0', 'C93.00', 'C93.01', 'C93.02', 'C93.1', 'C93.10', 'C93.11', 'C93.12', 'C93.3', 'C93.30', 'C93.31', 'C93.32', 'C93.Z', 'C93.Z0', 'C93.Z1', 'C93.Z2', 'C93.9', 'C93.90', 'C93.91', 'C93.92', 'C94', 'C94.0', 'C94.00', 'C94.01', 'C94.02', 'C94.2', 'C94.20', 'C94.21', 'C94.22', 'C94.3', 'C94.30', 'C94.31', 'C94.32', 'C94.4', 'C94.40', 'C94.41', 'C94.42', 'C94.6', 'C94.8', 'C94.80', 'C94.81', 'C94.82', 'C95', 'C95.0', 'C95.00', 'C95.01', 'C95.02', 'C95.1', 'C95.10', 'C95.11', 'C95.12', 'C95.9', 'C95.90', 'C95.91', 'C95.92', 'C96', 'C96.0', 'C96.2', 'C96.20', 'C96.21', 'C96.22', 'C96.29', 'C96.4', 'C96.5', 'C96.6', 'C96.A', 'C96.Z', 'C96.9', 'D00', 'D00.0', 'D00.00', 'D00.01', 'D00.02', 'D00.03', 'D00.04', 'D00.05', 'D00.06', 'D00.07', 'D00.08', 'D00.1', 'D00.2', 'D01', 'D01.0', 'D01.1', 'D01.2', 'D01.3', 'D01.4', 'D01.40', 'D01.49', 'D01.5', 'D01.7', 'D01.9', 'D02', 'D02.0', 'D02.1', 'D02.2', 'D02.20', 'D02.21', 'D02.22', 'D02.3', 'D02.4', 'D03', 'D03.0', 'D03.1', 'D03.10', 'D03.11', 'D03.111', 'D03.112', 'D03.12', 'D03.121', 'D03.122', 'D03.2', 'D03.20', 'D03.21', 'D03.22', 'D03.3', 'D03.30', 'D03.39', 'D03.4', 'D03.5', 'D03.51', 'D03.52', 'D03.59', 'D03.6', 'D03.60', 'D03.61', 'D03.62', 'D03.7', 'D03.70', 'D03.71', 'D03.72', 'D03.8', 'D03.9', 'D04', 'D04.0', 'D04.1', 'D04.10', 'D04.11', 'D04.111', 'D04.112', 'D04.12', 'D04.121', 'D04.122', 'D04.2', 'D04.20', 'D04.21', 'D04.22', 'D04.3', 'D04.30', 'D04.39', 'D04.4', 'D04.5', 'D04.6', 'D04.60', 'D04.61', 'D04.62', 'D04.7', 'D04.70', 'D04.71', 'D04.72', 'D04.8', 'D04.9', 'D05', 'D05.0', 'D05.00', 'D05.01', 'D05.02', 'D05.1', 'D05.10', 'D05.11', 'D05.12', 'D05.8', 'D05.80', 'D05.81', 'D05.82', 'D05.9', 'D05.90', 'D05.91', 'D05.92', 'D06', 'D06.0', 'D06.1', 'D06.7', 'D06.9', 'D07', 'D07.0', 'D07.1', 'D07.2', 'D07.3', 'D07.30', 'D07.39', 'D07.4', 'D07.5', 'D07.6', 'D07.60', 'D07.61', 'D07.69', 'D09', 'D09.0', 'D09.1', 'D09.10', 'D09.19', 'D09.2', 'D09.20', 'D09.21', 'D09.22', 'D09.3', 'D09.8', 'D09.9')
then 1 else 0 end) as Cancer,

(Case when icd_code in ('A18.11', 'A52.75', 'B52.0', 'C64.1', 'C64.2', 'C64.9', 'C68.9', 'D30.00', 'D30.01', 'D30.02', 'D41.00', 'D41.01', 'D41.02', 'D41.10', 'D41.11', 'D41.12', 'D41.20', 'D41.21', 'D41.22', 'D59.3', 'E08.21', 'E08.22', 'E08.29', 'E08.65', 'E09.21', 'E09.22', 'E09.29', 'E10.21', 'E10.22', 'E10.29', 'E10.65', 'E11.21', 'E11.22', 'E11.29', 'E11.65', 'E13.21', 'E13.22', 'E13.29', 'E74.8', 'I12.0', 'I12.9', 'I13.0', 'I13.10', 'I13.11', 'I13.2', 'I70.1', 'I72.2', 'K76.7', 'M10.30', 'M10.311', 'M10.312', 'M10.319', 'M10.321', 'M10.322', 'M10.329', 'M10.331', 'M10.332', 'M10.339', 'M10.341', 'M10.342', 'M10.349', 'M10.351', 'M10.352', 'M10.359', 'M10.361', 'M10.362', 'M10.369', 'M10.371', 'M10.372', 'M10.379', 'M10.38', 'M10.39', 'M32.14', 'M32.15', 'M35.04', 'N00.0', 'N00.1', 'N00.2', 'N00.3', 'N00.4', 'N00.5', 'N00.6', 'N00.7', 'N00.8', 'N00.9', 'N00.A', 'N01.0', 'N01.1', 'N01.2', 'N01.3', 'N01.4', 'N01.5', 'N01.6', 'N01.7', 'N01.8', 'N01.9', 'N01.A', 'N02.0', 'N02.1', 'N02.2', 'N02.3', 'N02.4', 'N02.5', 'N02.6', 'N02.7', 'N02.8', 'N02.9', 'N02.A', 'N03.0', 'N03.1', 'N03.2', 'N03.3', 'N03.4', 'N03.5', 'N03.6', 'N03.7', 'N03.8', 'N03.9', 'N03.A', 'N04.0', 'N04.1', 'N04.2', 'N04.3', 'N04.4', 'N04.5', 'N04.6', 'N04.7', 'N04.8', 'N04.9', 'N04.A', 'N05.0', 'N05.1', 'N05.2', 'N05.3', 'N05.4', 'N05.5', 'N05.6', 'N05.7', 'N05.8', 'N05.9', 'N05.A', 'N06.0', 'N06.1', 'N06.2', 'N06.3', 'N06.4', 'N06.5', 'N06.6', 'N06.7', 'N06.8', 'N06.9', 'N06.A', 'N07.0', 'N07.1', 'N07.2', 'N07.3', 'N07.4', 'N07.5', 'N07.6', 'N07.7', 'N07.8', 'N07.9', 'N07.A', 'N08', 'N13.1', 'N13.2', 'N13.30', 'N13.39', 'N14.0', 'N14.1', 'N14.2', 'N14.3', 'N14.4', 'N15.0', 'N15.8', 'N15.9', 'N16', 'N17.0', 'N17.1', 'N17.2', 'N17.8', 'N17.9', 'N18.1', 'N18.2', 'N18.3', 'N18.30', 'N18.31', 'N18.32', 'N18.4', 'N18.5', 'N18.6', 'N18.9', 'N19', 'N25.0', 'N25.1', 'N25.81', 'N25.89', 'N25.9', 'N26.1', 'N26.9', 'Q61.02', 'Q61.11', 'Q61.19', 'Q61.2', 'Q61.3', 'Q61.4', 'Q61.5', 'Q61.8', 'Q62.0', 'Q62.2', 'Q62.10', 'Q62.11', 'Q62.12', 'Q62.31', 'Q62.32', 'Q62.39', 'R94.4')
then 1 else 0 end) as Chr_Kidney_Dis,

(Case when icd_code in ('J84.10', 'J84.112', 'J40', 'J41.0', 'J41.1', 'J41.8', 'J42', 'J43.0', 'J43.1', 'J43.2', 'J43.8', 'J43.9', 'J44', 'J44.0', 'J44.1', 'J44.9', /* COPD end*/ 'J47.0', 'J47.1', 'J47.9') then 1 else 0 end) as Chr_lung_dis,

(Case when icd_code in ('B18', 'B18.0', 'B18.1', 'B18.2', 'B18.8', 'B18.9', 'K70', 'K70.0', 'K70.1', 
                        'K70.3', 'K70.4', 'K70.9', 'K70.10', 'K70.11', 'K70.2', 'K70.3', 'K70.30', 
                        'K70.31', 'K70.40', 'K70.41', 'K70.9', 'K71', 'K71.0', 'K71.1', 'K71.2', 'K71.3', 
                        'K71.4', 'K71.5', 'K71.7', 'K71.8', 'K71.9', 'K71.10', 'K71.11', 'K71.50', 
                        'K71.51', 'K71.6', 'K72.00', 'K72', 'K72.0', 'K72.1', 'K72.01', 'K72.10', 'K72.11', 
                        'K72.90', 'K72.9', 'K72.90', 'K72.91', 'K73', 'K73.0', 'K73.1', 'K73.2', 'K73.8', 
                        'K73.9', 'K74.0', 'K74.00', 'K74', 'K74.01', 'K74.02', 'K74.1', 'K74.2', 'K74.3', 
                        'K74.4', 'K74.5', 'K74.6', 'K74.60', 'K74.69', 'K75.0', 'K75.1', 'K75', 'K75.0', 
                        'K75.2', 'K75.3', 'K75.4', 'K75.8', 'K75.81', 'K75.89', 'K75.9', 'K75.81', 'K75.89', 
                        'K75.9', 'K76.0', 'K76.1', 'K76', 'K76.0', 'K76.1', 'K76.2', 'K76.3','K76.4', 'K76.5', 
                        'K76.6', 'K76.7', 'K76.8', 'K76.81', 'K76.89', 'K76.9', 'K77', 'K80.30', 'K80.31', 
                        'K80.32', 'K80.33', 'K80.34', 'K80.35', 'K80.36', 'K80.37', 'K83.0', 'R16.0', 
                        'R16.2', 'Z48.23', 'Z94.4', 'Z22.51', 'Z22.52') then 1 else 0 end) 
                        as Liver_Dis_Hep,

(Case when icd_code in ('D81.810', 'D84.1', 'E00.0', 'E00.1', 'E00.2', 'E00.9', 'E03.0', 'E03.1', 'E25.0', 'E25.8', 'E25.9', 'E56.9', 'E70.0', 'E70.1', 'E70.20', 'E70.21', 'E70.29', 'E70.30', 'E70.310', 'E70.311', 'E70.318', 'E70.319', 'E70.320', 'E70.321', 'E70.328', 'E70.329', 'E70.330', 'E70.331', 'E70.338', 'E70.339', 'E70.39', 'E70.5', 'E70.8', 'E70.81', 'E70.89', 'E70.9', 'E71.0', 'E71.110', 'E71.111', 'E71.118', 'E71.19', 'E71.2', 'E71.310', 'E71.311', 'E71.312', 'E71.313', 'E71.314', 'E71.318', 'E71.32', 'E71.41', 'E72.10', 'E72.11', 'E72.12', 'E72.19', 'E72.20', 'E72.21', 'E72.22', 'E72.23', 'E72.29', 'E72.3', 'E72.4', 'E72.50', 'E72.51', 'E72.59', 'E72.8', 'E74.20', 'E74.21', 'E74.29', 'E74.810', 'E74.818', 'E74.819', 'E74.89', 'E84.0', 'E84.11', 'E84.19', 'E84.8', 'E84.9') 
 then 1 else 0 end) as Cystic_Fibrosis,

(Case when icd_code in ('E08.00', 'E08.01', 'E08.10', 'E08.11', 'E08.21', 'E08.22', 'E08.29', 'E08.311', 'E08.319', 'E08.321', 'E08.3211', 'E08.3212', 'E08.3213', 'E08.3219', 'E08.329', 'E08.3291', 'E08.3292', 'E08.3293', 'E08.3299', 'E08.331', 'E08.3311', 'E08.3312', 'E08.3313', 'E08.3319', 'E08.339', 'E08.3391', 'E08.3392', 'E08.3393', 'E08.3399', 'E08.341', 'E08.3411', 'E08.3412', 'E08.3413', 'E08.3419', 'E08.349', 'E08.3491', 'E08.3492', 'E08.3493', 'E08.3499', 'E08.351', 'E08.3511', 'E08.3512', 'E08.3513', 'E08.3519', 'E08.3521', 'E08.3522', 'E08.3523', 'E08.3529', 'E08.3531', 'E08.3532', 'E08.3533', 'E08.3539', 'E08.3541', 'E08.3542', 'E08.3543', 'E08.3549', 'E08.3551', 'E08.3552', 'E08.3553', 'E08.3559', 'E08.359', 'E08.3591', 'E08.3592', 'E08.3593', 'E08.3599', 'E08.36', 'E08.37X1', 'E08.37X2', 'E08.37X3', 'E08.37X9', 'E08.39', 'E08.40', 'E08.41', 'E08.42', 'E08.43', 'E08.44', 'E08.49', 'E08.51', 'E08.52', 'E08.59', 'E08.610', 'E08.618', 'E08.620', 'E08.621', 'E08.622', 'E08.628', 'E08.630', 'E08.638', 'E08.641', 'E08.649', 'E08.65', 'E08.69', 'E08.8', 'E08.9', 'E09.00', 'E09.01', 'E09.10', 'E09.11', 'E09.21', 'E09.22', 'E09.29', 'E09.311', 'E09.319', 'E09.321', 'E09.3211', 'E09.3212', 'E09.3213', 'E09.3219', 'E09.329', 'E09.3291', 'E09.3292', 'E09.3293', 'E09.3299', 'E09.331', 'E09.3311', 'E09.3312', 'E09.3313', 'E09.3319', 'E09.339', 'E09.3391', 'E09.3392', 'E09.3393', 'E09.3399', 'E09.341', 'E09.3411', 'E09.3412', 'E09.3413', 'E09.3419', 'E09.349', 'E09.3491', 'E09.3492', 'E09.3493', 'E09.3499', 'E09.351', 'E09.3511', 'E09.3512', 'E09.3513', 'E09.3519', 'E09.3521', 'E09.3522', 'E09.3523', 'E09.3529', 'E09.3531', 'E09.3532', 'E09.3533', 'E09.3539', 'E09.3541', 'E09.3542', 'E09.3543', 'E09.3549', 'E09.3551', 'E09.3552', 'E09.3553', 'E09.3559', 'E09.359', 'E09.3591', 'E09.3592', 'E09.3593', 'E09.3599', 'E09.36', 'E09.37X1', 'E09.37X2', 'E09.37X3', 'E09.37X9', 'E09.39', 'E09.40', 'E09.41', 'E09.42', 'E09.43', 'E09.44', 'E09.49', 'E09.51', 'E09.52', 'E09.59', 'E09.610', 'E09.618', 'E09.620', 'E09.621', 'E09.622', 'E09.628', 'E09.630', 'E09.638', 'E09.641', 'E09.649', 'E09.65', 'E09.69', 'E09.8', 'E09.9', 'E10.10', 'E10.11', 'E10.21', 'E10.22', 'E10.29', 'E10.311', 'E10.319', 'E10.321', 'E10.3211', 'E10.3212', 'E10.3213', 'E10.3219', 'E10.329', 'E10.3291', 'E10.3292', 'E10.3293', 'E10.3299', 'E10.331', 'E10.3311', 'E10.3312', 'E10.3313', 'E10.3319', 'E10.339', 'E10.3391', 'E10.3392', 'E10.3393', 'E10.3399', 'E10.341', 'E10.3411', 'E10.3412', 'E10.3413', 'E10.3419', 'E10.349', 'E10.3491', 'E10.3492', 'E10.3493', 'E10.3499', 'E10.351', 'E10.3511', 'E10.3512', 'E10.3513', 'E10.3519', 'E10.3521', 'E10.3522', 'E10.3523', 'E10.3529', 'E10.3531', 'E10.3532', 'E10.3533', 'E10.3539', 'E10.3541', 'E10.3542', 'E10.3543', 'E10.3549', 'E10.3551', 'E10.3552', 'E10.3553', 'E10.3559', 'E10.359', 'E10.3591', 'E10.3592', 'E10.3593', 'E10.3599', 'E10.36', 'E10.37X1', 'E10.37X2', 'E10.37X3', 'E10.37X9', 'E10.39', 'E10.40', 'E10.41', 'E10.42', 'E10.43', 'E10.44', 'E10.49', 'E10.51', 'E10.52', 'E10.59', 'E10.610', 'E10.618', 'E10.620', 'E10.621', 'E10.622', 'E10.628', 'E10.630', 'E10.638', 'E10.641', 'E10.649', 'E10.65', 'E10.69', 'E10.8', 'E10.9', 'E11.00', 'E11.01', 'E11.10', 'E11.11', 'E11.21', 'E11.22', 'E11.29', 'E11.311', 'E11.319', 'E11.321', 'E11.3211', 'E11.3212', 'E11.3213', 'E11.3219', 'E11.329', 'E11.3291', 'E11.3292', 'E11.3293', 'E11.3299', 'E11.331', 'E11.3311', 'E11.3312', 'E11.3313', 'E11.3319', 'E11.339', 'E11.3391', 'E11.3392', 'E11.3393', 'E11.3399', 'E11.341', 'E11.3411', 'E11.3412', 'E11.3413', 'E11.3419', 'E11.349', 'E11.3491', 'E11.3492', 'E11.3493', 'E11.3499', 'E11.351', 'E11.3511', 'E11.3512', 'E11.3513', 'E11.3519', 'E11.3521', 'E11.3522', 'E11.3523', 'E11.3529', 'E11.3531', 'E11.3532', 'E11.3533', 'E11.3539', 'E11.3541', 'E11.3542', 'E11.3543', 'E11.3549', 'E11.3551', 'E11.3552', 'E11.3553', 'E11.3559', 'E11.359', 'E11.3591', 'E11.3592', 'E11.3593', 'E11.3599', 'E11.36', 'E11.37X1', 'E11.37X2', 'E11.37X3', 'E11.37X9', 'E11.39', 'E11.40', 'E11.41', 'E11.42', 'E11.43', 'E11.44', 'E11.49', 'E11.51', 'E11.52', 'E11.59', 'E11.610', 'E11.618', 'E11.620', 'E11.621', 'E11.622', 'E11.628', 'E11.630', 'E11.638', 'E11.641', 'E11.649', 'E11.65', 'E11.69', 'E11.8', 'E11.9', 'E13.00', 'E13.01', 'E13.10', 'E13.11', 'E13.21', 'E13.22', 'E13.29', 'E13.311', 'E13.319', 'E13.321', 'E13.3211', 'E13.3212', 'E13.3213', 'E13.3219', 'E13.329', 'E13.3291', 'E13.3292', 'E13.3293', 'E13.3299', 'E13.331', 'E13.3311', 'E13.3312', 'E13.3313', 'E13.3319', 'E13.339', 'E13.3391', 'E13.3392', 'E13.3393', 'E13.3399', 'E13.341', 'E13.3411', 'E13.3412', 'E13.3413', 'E13.3419', 'E13.349', 'E13.3491', 'E13.3492', 'E13.3493', 'E13.3499', 'E13.351', 'E13.3511', 'E13.3512', 'E13.3513', 'E13.3519', 'E13.3521', 'E13.3522', 'E13.3523', 'E13.3529', 'E13.3531', 'E13.3532', 'E13.3533', 'E13.3539', 'E13.3541', 'E13.3542', 'E13.3543', 'E13.3549', 'E13.3551', 'E13.3552', 'E13.3553', 'E13.3559', 'E13.359', 'E13.3591', 'E13.3592', 'E13.3593', 'E13.3599', 'E13.36', 'E13.39', 'E13.40', 'E13.41', 'E13.42', 'E13.43', 'E13.44', 'E13.49', 'E13.51', 'E13.52', 'E13.59', 'E13.610', 'E13.618', 'E13.620', 'E13.621', 'E13.622', 'E13.628', 'E13.630', 'E13.638', 'E13.641', 'E13.649', 'E13.65', 'E13.69', 'E13.8', 'E13.9')
then 1 else 0 end) as Diabetes,

(Case when icd_code in ('F81.9', 'F82', 'F88', 'F89', --Other dev dis 
                        'F80.0', 'F80.1', 'F80.2', 'F80.4', 'F80.81', 
                        'F80.82', 'F80.89', 'F80.9', 'F81.0', 'F81.2', 
                        'F81.81', 'F81.89', 'F81.9', 'F82', 'H93.25', 'R48.0' -- LD
                        'E78.71', 'E78.72', 'F70', 'F71', 'F72', 'F73', 'F78', 'F79', -- Int Dis
                        'P04.3', 'Q86.0', 'Q87.1', 'Q87.11', 'Q87.19', 'Q87.2', 'Q87.3', 
                        'Q87.5', 'Q87.81', 'Q87.89', 'Q89.7', 'Q89.8', 'Q90.0', 'Q90.1', 
                        'Q90.2', 'Q90.9', 'Q91.0', 'Q91.1', 'Q91.2', 'Q91.3', 'Q91.4', 
                        'Q91.5', 'Q91.6', 'Q91.7', 'Q92.0', 'Q92.1', 'Q92.2', 'Q92.5', 
                        'Q92.61', 'Q92.62', 'Q92.7', 'Q92.8', 'Q92.9', 'Q93.0', 'Q93.1', 
                        'Q93.2', 'Q93.3', 'Q93.4', 'Q93.5', 'Q93.51', 'Q93.59', 'Q93.7', 
                        'Q93.81', 'Q93.88', 'Q93.89', 'Q93.9', 'Q95.2', 'Q95.3', 'Q99.2'
                        'G80.0', 'G80.1', 'G80.2', 'G80.3', 'G80.4', 'G80.8', 'G80.9' -- CerPalsy
                        'F63.0', 'F63.1', 'F63.2', 'F63.3', 'F63.81', 'F63.89', 'F63.9', --ADHD
                        'F90.0', 'F90.1', 'F90.2', 'F90.8', 'F90.9', 'F91.0', 'F91.1', 
                        'F91.2', 'F91.3', 'F91.8', 'F91.9'
                        'J40', 'J41.0', 'J41.1', 'J41.8', 'J42', 'J43.0', 
                        'J43.1', 'J43.2', 'J43.8', 'J43.9', 'J44.0', 'J44.1', 
                        'J44.9', 'J47.0', 'J47.1', 'J47.9', 
                        'Q90', 'Q90.0', 'Q90.1', 'Q90.2', 'Q90.9') --Downs Syndrome
 then 1 else 0 end) as Disabilities,

(Case When  icd_code in ('I21', 'I21.0', 'I21.01', 'I21.02', 'I21.09', 'I21.1', 'I21.11', 'I21.19', 'I21.2', 'I21.21', 'I21.29', 'I21.3', 'I21.4', 'I21.9', 'I21.A', 'I21.A1', 'I21.A9', 'I22', 'I22.0', 'I22.1', 'I22.2', 'I22.8', 'I22.9', 'I23', 'I23.0', 'I23.1', 'I23.2', 'I23.3', 'I23.4', 'I23.5', 'I23.6', 'I23.7', 'I23.8', 'I24', 'I24.0', 'I24.1', 'I24.8', 'I24.9', 'I25', 'I25.1', 'I25.10', 'I25.11', 'I25.110', 'I25.111', 'I25.1108', 'I25.119', 'I25.2', 'I25.3', 'I25.4', 'I25.41', 'I25.42', 'I25.5', 'I25.6', 'I25.7', 'I25.70', 'I25.700', 'I25.701', 'I25.708', 'I25.709', 'I25.71', 'I25.710', 'I25.711', 'I25.718', 'I25.719', 'I25.72', 'I25.720', 'I25.721', 'I25.728', 'I25.729', 'I25.729', 'I25.73', 'I25.730', 'I25.731', 'I25.738', 'I25.739', 'I25.75', 'I25.750', 'I25.751', 'I25.758', 'I25.759', 'I25.76', 'I25.760', 'I25.761', 'I25.768', 'I25.769', 'I25.79', 'I25.790', 'I25.791', 'I25.798', 'I25.799', 'I25.8', 'I25.81', 'I25.810', 'I25.811', 'I25.812', 'I25.82', 'I25.83', 'I25.84', 'I25.89', 'I25.9', 'I42', 'I42.0', 'I42.1', 'I42.2', 'I42.3', 'I42.4', 'I42.5', 'I42.6', 'I42.7', 'I42.8', 'I42.9', 'I43', 'I50', 'I50.1', 'I50.2', 'I50.20', 'I50.21', 'I50.22', 'I50.23', 'I50.3', 'I50.30', 'I50.31', 'I50.32', 'I50.33', 'I50.4', 'I50.40', 'I50.41', 'I50.42', 'I50.43', 'I50.8', 'I50.81', 'I50.810', 'I50.811', 'I50.812', 'I50.813', 'I50.814', 'I50.82', 'I50.83', 'I50.84', 'I50.89', 'I50.9')
then 1 else 0 end) as Heart_condition,

(Case when  icd_code in ('B20', 'B97.35', 'R75', 'Z21') 
 then 1 else 0 end) as HIV_AIDS,

(Case When  icd_code in ('F31.30', 'F31.31', 'F31.32', 'F31.4', 'F31.5', 'F31.60', 
                         'F31.61', 'F31.62', 'F31.63', 'F31.64', 'F31.75', 'F31.76', 
                         'F31.77', 'F31.78', 'F31.81', 'F32.0', 'F32.1', 'F32.2', 
                         'F32.3', 'F32.4', 'F32.5', 'F32.9', 'F33.0', 'F33.1', 'F33.2', 
                         'F33.3', 'F33.40', 'F33.41', 'F33.42', 'F33.8', 'F33.9', 
                         'F34.1', 'F43.21', 'F43.23', 'F32.0', 'F32.1', 'F32.2', 
                         'F32.3', 'F32.4', 'F32.5', 'F32.89', 'F32.9', 'F33.0', 'F33.1', 
                         'F33.2', 'F33.3', 'F33.40', 'F33.41', 'F33.42', 'F33.8', 
                         'F33.9', 'F34.1', 'F20.0', 'F20.1', 'F20.2', 'F20.3', 
                         'F20.5', 'F20.81', 'F20.89', 'F20.9', 'F25.0', 'F25.1', 'F25.8', 
                         'F25.9', 'F06.0', 'F06.2', 'F20.0', 'F20.1', 'F20.2', 
                         'F20.3', 'F20.5', 'F20.81', 'F20.89', 'F20.9', 'F21', 'F22', 'F23', 
                         'F24', 'F25.0', 'F25.1', 'F25.8', 'F25.9', 'F28', 'F29', 'F32.3', 
                         'F33.3', 'F44.89', 'F43.10', 'F43.11', 'F43.12') 
 then 1 else 0 end) as MentalHealth_Dis,

(Case when  icd_code in ('F01.50', 'F01.51', 'F02.80', 'F02.81', 'F03.90', 'F03.91', 'F04', 
                         'G13.8', 'F05', 'F06.1', 'F06.8', 'G30.0', 'G30.1', 'G30.8', 'G30.9', 
                         'G31.1', 'G31.2', 'G31.01', 'G31.09', 'G94', 'R41.81', 'R54') 
 then 1 else 0 end) as Dementia,

--(Case when icd_code in ('F01', 'F01.5', 'F01.50', 'F01.51', 'F02', 'F02.8', 'F02.80', 'F02.81', 'F03', 'F03.9', 'F03.90', 'F03.91', 'G30', 'G30.0', 'G30.1', 'G30.8', 'G30.9')
--then 1 else 0 end) as Neuro_Cond,

--(Case When  icd_code in ('E66.3', 'Z68.26', 'Z68.27', 'Z68.28', 'Z68.29') then 1 else 0 end) as Overweight,

(Case When icd_code in ('E66.01', 'E66.09', 'E66.1', 'E66.2', 'E66.8', 'E66.9', 'Z68.30', 
                        'Z68.31', 'Z68.32', 'Z68.33', 'Z68.34', 'Z68.35', 'Z68.36', 'Z68.37', 
                        'Z68.38', 'Z68.39', 'Z68.41', 'Z68.42', 'Z68.43', 'Z68.44', 'Z68.45') 
 then 1 else 0 end) as Obesity,

(Case when icd_code in ('B20', 'D80', 'D80.0', 'D80.1', 'D80.2', 'D80.3', 'D80.4', 'D80.5', 'D80.6', 'D80.7', 'D80.8', 'D80.9', 'D81', 'D81.0', 'D81.1', 'D81.2', 'D81.3', 'D81.30', 'D81.31', 'D81.32', 'D81.39', 'D81.4', 'D81.5', 'D81.6', 'D81.7', 'D81.8', 'D81.81', 'D81.810', 'D81.818', 'D81.819', 'D81.89', 'D81.9', 'D82', 'D82.0', 'D82.1', 'D82.2', 'D82.3', 'D82.4', 'D82.8', 'D82.9', 'D83', 'D83.0', 'D83.1', 'D83.2', 'D83.8', 'D83.9', 'D84', 'D84.0', 'D84.1', 'D84.8', 'D84.81', 'D84.82', 'D84.821', 'D84.822', 'D84.89', 'D84.9', 'D86', 'D86.0', 'D86.1', 'D86.2', 'D86.3', 'D86.8', 'D86.81', 'D86.82', 'D86.83', 'D86.84', 'D86.85', 'D86.86', 'D86.87', 'D86.89', 'D86.9', 'D89', 'D89.0', 'D89.1', 'D89.2', 'D89.3', 'D89.4', 'D89.40', 'D89.41', 'D89.42', 'D89.43', 'D89.49', 'D89.8', 'D89.81', 'D89.810', 'D89.811', 'D89.812', 'D89.813', 'D89.82', 'D89.83', 'D89.831', 'D89.832', 'D89.833', 'D89.834', 'D89.835', 'D89.839', 'D89.89', 'D89.9', 'Z92.25', 'Z94.81', 'Z94.84 ', 'Z79.52')
then 1 else 0 end) as  Primary_Immuno,

-- (Case when icd_code in ('Z94', 'Z94.0', 'Z94.1', 'Z94.2', 'Z94.3', 'Z94.4', 'Z94.5', 'Z94.6', 'Z94.7', 'Z94.8', 'Z94.81', 'Z94.82', 'Z94.83', 'Z94.84', 'Z94.89', 'Z94.9')
-- then 1 else 0 end) as Immun_Comp_SolidOrgan,

(Case when icd_code in ('Z33.1', 'Z33.3', 'Z34', 'Z34.0', 'Z34.00', 'Z34.01', 'Z34.02', 'Z34.03', 'Z34.8', 'Z34.80', 'Z34.81', 'Z34.82', 'Z34.83', 'Z34.9', 'Z34.90', 'Z34.91', 'Z34.92', 'Z34.93', 'O09', 'O09.0', 'O09.00', 'O09.01', 'O09.02', 'O09.03', 'O09.1', 'O09.10', 'O09.11', 'O09.12', 'O09.13', 'O09.A', 'O09.A0', 'O09.A1', 'O09.A2', 'O09.A3', 'O09.2', 'O09.21', 'O09.211', 'O09.212', 'O09.213', 'O09.219', 'O09.29', 'O09.291', 'O09.292', 'O09.293', 'O09.299', 'O09.3', 'O09.30', 'O09.31', 'O09.32', 'O09.33', 'O09.4', 'O09.41', 'O09.42', 'O09.43', 'O09.5', 'O09.51', 'O09.511', 'O09.512', 'O09.513', 'O09.519', 'O09.52', 'O09.521', 'O09.522', 'O09.523', 'O09.529', 'O09.6', 'O09.61', 'O09.611', 'O09.612', 'O09.613', 'O09.619', 'O09.62', 'O09.621', 'O09.622', 'O09.623', 'O09.629', 'O09.7', 'O09.70', 'O09.71', 'O09.72', 'O09.73', 'O09.8', 'O09.81', 'O09.811', 'O09.812', 'O09.813', 'O09.819', 'O09.82', 'O09.821', 'O09.822', 'O09.823', 'O09.829', 'O09.89', 'O09.891', 'O09.892', 'O09.893', 'O09.899', 'O09.9', 'O09.90', 'O09.91', 'O09.92', 'O09.93')
then 1 else 0 end) as Pregnancy,

(Case when icd_code in ('Z94', 'Z94.0', 'Z94.1', 'Z94.2', 'Z94.3', 'Z94.4', 'Z94.5', 'Z94.6', 'Z94.7', 'Z94.8', 
                        'Z94.81', 'Z94.82', 'Z94.83', 'Z94.84', 'Z94.89', 'Z94.9', 'T86x') then 1 else 0 end) 
                        as Transplantation,

(Case when icd_code in ('Z11.1', 'Z22.7', 'Z86.15', 'Z11.7')
then 1 else 0 end) as Tuberculosis

--(Case when icd_code in ('J45.20', 'J45.21', 'J45.22', 'J45.30', 'J45.31', 'J45.32', 'J45.40', 'J45.41', 'J45.42', 'J45.50', 'J45.51', 'J45.52', 'J45.901', 'J45.902', --------'J45.909', 'J45.990', 'J45.991', 'J45.998', 'J82.83') --then 1 else 0 end) as Asthma,

-- (Case when icd_code in ('H35.031', 'H35.032', 'H35.033', 'H35.039', 'I10', 'I11.0', 'I11.9', 'I12.0', 'I12.9', 'I13.0', 'I13.10', 'I13.11', 'I13.2', 'I15.0', 'I15.1', 'I15.2', 'I15.8', 'I15.9', 'I67.4', 'N26.2') 
-- then 1 else 0 end) as Hypertension,

-- (Case when icd_code in ('F11.10', 'F11.120', 'F11.121', 'F11.122', 'F11.129', 'F11.13', 'F11.14', 'F11.150', 'F11.151', 'F11.159', 'F11.181', 'F11.182', 'F11.188', 'F11.19', 'F11.20', 'F11.220', 'F11.221', 'F11.222', 'F11.229', 'F11.23', 'F11.24', 'F11.250', 'F11.251', 'F11.259', 'F11.281', 'F11.282', 'F11.288', 'F11.29', 'F11.90', 'F11.920', 'F11.921', 'F11.922', 'F11.929', 'F11.93', 'F11.94', 'F11.950', 'F11.951', 'F11.959', 'F11.981', 'F11.982', 'F11.988', 'F11.99', 'F12.10', 'F12.120', 'F12.121', 'F12.122', 'F12.129', 'F12.13', 'F12.150', 'F12.151', 'F12.159', 'F12.180', 'F12.188', 'F12.19', 'F12.20', 'F12.220', 'F12.221', 'F12.222', 'F12.229', 'F12.250', 'F12.251', 'F12.259', 'F12.280', 'F12.288', 'F12.29', 'F12.90', 'F12.920', 'F12.921', 'F12.922', 'F12.929', 'F12.950', 'F12.951', 'F12.959', 'F12.980', 'F12.988', 'F12.99', 'F13.10', 'F13.120', 'F13.121', 'F13.129', 'F13.130', 'F13.131', 'F13.132', 'F13.139', 'F13.14', 'F13.150', 'F13.151', 'F13.159', 'F13.180', 'F13.181', 'F13.182', 'F13.188', 'F13.19', 'F13.20', 'F13.220', 'F13.221', 'F13.229', 'F13.230', 'F13.231', 'F13.232', 'F13.239', 'F13.24', 'F13.250', 'F13.251', 'F13.259', 'F13.26', 'F13.27', 'F13.280', 'F13.281', 'F13.282', 'F13.288', 'F13.29', 'F13.90', 'F13.920', 'F13.921', 'F13.929', 'F13.930', 'F13.931', 'F13.932', 'F13.939', 'F13.94', 'F13.950', 'F13.951', 'F13.959', 'F13.96', 'F13.97', 'F13.980', 'F13.981', 'F13.982', 'F13.988', 'F13.99', 'F14.10', 'F14.120', 'F14.121', 'F14.122', 'F14.129', 'F14.13', 'F14.14', 'F14.150', 'F14.151', 'F14.159', 'F14.180', 'F14.181', 'F14.182', 'F14.188', 'F14.19', 'F14.20', 'F14.220', 'F14.221', 'F14.222', 'F14.229', 'F14.23', 'F14.24', 'F14.250', 'F14.251', 'F14.259', 'F14.280', 'F14.281', 'F14.282', 'F14.288', 'F14.29', 'F14.90', 'F14.920', 'F14.921', 'F14.922', 'F14.929', 'F14.93', 'F14.94', 'F14.950', 'F14.951', 'F14.959', 'F14.980', 'F14.981', 'F14.982', 'F14.988', 'F14.99', 'F15.10', 'F15.120', 'F15.121', 'F15.122', 'F15.129', 'F15.13', 'F15.14', 'F15.150', 'F15.151', 'F15.159', 'F15.180', 'F15.181', 'F15.182', 'F15.188', 'F15.19', 'F15.20', 'F15.220', 'F15.221', 'F15.222', 'F15.229', 'F15.23', 'F15.24', 'F15.250', 'F15.251', 'F15.259', 'F15.280', 'F15.281', 'F15.282', 'F15.288', 'F15.29', 'F15.90', 'F15.920', 'F15.921', 'F15.922', 'F15.929', 'F15.93', 'F15.94', 'F15.950', 'F15.951', 'F15.959', 'F15.980', 'F15.981', 'F15.982', 'F15.988', 'F15.99', 'F16.10', 'F16.120', 'F16.121', 'F16.122', 'F16.129', 'F16.14', 'F16.150', 'F16.151', 'F16.159', 'F16.180', 'F16.183', 'F16.188', 'F16.19', 'F16.20', 'F16.220', 'F16.221', 'F16.229', 'F16.24', 'F16.250', 'F16.251', 'F16.259', 'F16.280', 'F16.283', 'F16.288', 'F16.29', 'F16.90', 'F16.920', 'F16.921', 'F16.929', 'F16.94', 'F16.950', 'F16.951', 'F16.959', 'F16.980', 'F16.983', 'F16.988', 'F16.99', 'F17.203', 'F17.208', 'F17.209', 'F17.213', 'F17.218', 'F17.219', 'F17.223', 'F17.228', 'F17.229', 'F17.293', 'F17.298', 'F17.299', 'F18.10', 'F18.120', 'F18.121', 'F18.129', 'F18.14', 'F18.150', 'F18.151', 'F18.159', 'F18.17', 'F18.180', 'F18.188', 'F18.19', 'F18.20', 'F18.220', 'F18.221', 'F18.229', 'F18.24', 'F18.250', 'F18.251', 'F18.259', 'F18.27', 'F18.280', 'F18.288', 'F18.29', 'F18.90', 'F18.920', 'F18.921', 'F18.929', 'F18.94', 'F18.950', 'F18.951', 'F18.959', 'F18.97', 'F18.980', 'F18.988', 'F18.99', 'F19.10', 'F19.120', 'F19.121', 'F19.122', 'F19.129', 'F19.130', 'F19.131', 'F19.132', 'F19.139', 'F19.14', 'F19.150', 'F19.151', 'F19.159', 'F19.16', 'F19.17', 'F19.180', 'F19.181', 'F19.182', 'F19.188', 'F19.19', 'F19.20', 'F19.220', 'F19.221', 'F19.222', 'F19.229', 'F19.230', 'F19.231', 'F19.232', 'F19.239', 'F19.24', 'F19.250', 'F19.251', 'F19.259', 'F19.26', 'F19.27', 'F19.280', 'F19.281', 'F19.282', 'F19.288', 'F19.29', 'F19.90', 'F19.920', 'F19.921', 'F19.922', 'F19.929', 'F19.930', 'F19.931', 'F19.932', 'F19.939', 'F19.94', 'F19.950', 'F19.951', 'F19.959', 'F19.96', 'F19.97', 'F19.980', 'F19.981', 'F19.982', 'F19.988', 'F19.99', 'F55.0', 'F55.1', 'F55.2', 'F55.3', 'F55.4', 'F55.8', 'O35.5XX0', 'O35.5XX1', 'O35.5XX2', 'O35.5XX3', 'O35.5XX4', 'O35.5XX5', 'O35.5XX9', 'T40.691A', 'T40.692A', 'T40.693A', 'T40.694A', 'O99.320', 'O99.321', 'O99.322', 'O99.323', 'O99.324', 'O99.325', 'P04.41', 'P04.49', 'P96.1', 'P96.2', 'T40.0X1A', 'T40.0X2A', 'T40.0X3A', 'T40.0X4A', 'T40.0X5A', 'T40.0X5S', 'T40.1X1A', 'T40.1X2A', 'T40.1X3A', 'T40.1X4A', 'T40.2X1A', 'T40.2X2A', 'T40.2X3A', 'T40.2X4A', 'T40.3X1A', 'T40.3X2A', 'T40.3X3A', 'T40.3X4A', 'T40.3X5A', 'T40.3X5S', 'T40.4X1A', 'T40.4X2A', 'T40.4X3A', 'T40.4X4A', 'T40.411A', 'T40.412A', 'T40.413A', 'T40.414A', 'T40.415A', 'T40.421A', 'T40.422A', 'T40.423A', 'T40.424A', 'T40.425A', 'T40.491A', 'T40.492A', 'T40.493A', 'T40.494A', 'T40.495A', 'T40.7X1A', 'T40.8X1A', 'T40.601A', 'T40.602A', 'T40.603A', 'T40.604A', 'T40.691A', 'T40.692A', 'T40.693A', 'T40.694A', 'T40.901A', 'T40.991A', 'Z71.41', 'Z71.42', 'Z71.51', 'Z71.52', 'Z71.6')
-- then 1 else 0 end) as Drug_Use,

-- (Case when icd_code in ('B18', 'B18.0', 'B18.1', 'B18.2', 'B18.8', 'B18.9', 'K70', 'K70.0', 'K70.1', 
--                         'K70.3', 'K70.4', 'K70.9', 'K70.10', 'K70.11', 'K70.2', 'K70.3', 'K70.30', 
--                         'K70.31', 'K70.40', 'K70.41', 'K70.9', 'K71', 'K71.0', 'K71.1', 'K71.2', 'K71.3', 
--                         'K71.4', 'K71.5', 'K71.7', 'K71.8', 'K71.9', 'K71.10', 'K71.11', 'K71.50', 
--                         'K71.51', 'K71.6', 'K72.00', 'K72', 'K72.0', 'K72.1', 'K72.01', 'K72.10', 'K72.11', 
--                         'K72.90', 'K72.9', 'K72.90', 'K72.91', 'K73', 'K73.0', 'K73.1', 'K73.2', 'K73.8', 
--                         'K73.9', 'K74.0', 'K74.00', 'K74', 'K74.01', 'K74.02', 'K74.1', 'K74.2', 'K74.3', 
--                         'K74.4', 'K74.5', 'K74.6', 'K74.60', 'K74.69', 'K75.0', 'K75.1', 'K75', 'K75.0', 
--                         'K75.2', 'K75.3', 'K75.4', 'K75.8', 'K75.81', 'K75.89', 'K75.9', 'K75.81', 'K75.89', 
--                         'K75.9', 'K76.0', 'K76.1', 'K76', 'K76.0', 'K76.1', 'K76.2', 'K76.3','K76.4', 'K76.5', 
--                         'K76.6', 'K76.7', 'K76.8', 'K76.81', 'K76.89', 'K76.9', 'K77', 'K80.30', 'K80.31', 
--                         'K80.32', 'K80.33', 'K80.34', 'K80.35', 'K80.36', 'K80.37', 'K83.0', 'R16.0', 
--                         'R16.2', 'Z48.23', 'Z94.4', 'Z22.51', 'Z22.52') then 1 else 0 end) 
--                         as Liver_Dis_Hep,

-- (Case when icd_code in ('D57.00', 'D57.01', 'D57.02', 'D57.03', 'D57.09', 'D57.1', 'D57.20', 
--                         'D57.211', 'D57.212', 'D57.213', 'D57.218', 'D57.219', 'D57.40', 'D57.411', 
--                         'D57.412', 'D57.413', 'D57.418', 'D57.419', 'D57.42', 'D57.431', 'D57.432', 
--                         'D57.433', 'D57.438', 'D57.439', 'D57.44', 'D57.451', 'D57.452', 'D57.453', 
--                         'D57.458', 'D57.459', 'D57.80', 'D57.811', 'D57.812', 'D57.813', 'D57.818', 
--                         'D57.819') then 1 else 0 end) 
--                         as Sickle_cell,

-- (Case when icd_code in ('F17.200', 'F17.201', 'F17.203', 'F17.208', 'F17.209', 'F17.210', 'F17.211', 
--                         'F17.213', 'F17.218', 'F17.219', 'F17.220', 'F17.221', 'F17.223', 'F17.228', 
--                         'F17.229', 'F17.290', 'F17.291', 'F17.293', 'F17.298', 'F17.299', 'O99.330', 
--                         'O99.331', 'O99.332', 'O99.333', 'O99.334', 'O99.335', 'T65.211A', 'T65.212A', 
--                         'T65.213A', 'T65.214A', 'T65.221A', 'T65.222A', 'T65.223A', 'T65.224A', 
--                         'T65.291A', 'T65.292A', 'T65.293A', 'T65.294A', 'Z72.0') then 1 else 0 end) 
--                         as Tobacco_use,


FROM paticd_diag

""")