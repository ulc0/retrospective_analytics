<!doctype html><html lang="en"><head><title data-rh="true">Importing Hugging Face models into Spark NLP | by Juan Martinez | spark-nlp | Medium</title><meta data-rh="true" charset="utf-8"/><meta data-rh="true" name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1,maximum-scale=1"/><meta data-rh="true" name="theme-color" content="#000000"/><meta data-rh="true" name="twitter:app:name:iphone" content="Medium"/><meta data-rh="true" name="twitter:app:id:iphone" content="828256236"/><meta data-rh="true" property="al:ios:app_name" content="Medium"/><meta data-rh="true" property="al:ios:app_store_id" content="828256236"/><meta data-rh="true" property="al:android:package" content="com.medium.reader"/><meta data-rh="true" property="fb:app_id" content="542599432471018"/><meta data-rh="true" property="og:site_name" content="Medium"/><meta data-rh="true" property="og:type" content="article"/><meta data-rh="true" property="article:published_time" content="2021-11-19T10:44:41.568Z"/><meta data-rh="true" name="title" content="Importing Hugging Face models into Spark NLP | by Juan Martinez | spark-nlp | Medium"/><meta data-rh="true" property="og:title" content="Importing HuggingFace models into SparkNLP"/><meta data-rh="true" property="al:android:url" content="medium://p/8c63bdea671d"/><meta data-rh="true" property="al:ios:url" content="medium://p/8c63bdea671d"/><meta data-rh="true" property="al:android:app_name" content="Medium"/><meta data-rh="true" name="description" content="In this article we are going to show two examples of how to import Hugging Face embeddings models into Spark NLP, and another example showcasing a bulk importing of 7 BertForSequenceClassification…"/><meta data-rh="true" property="og:description" content="In this article we are going to show two examples of how to import Hugging Face embeddings models into Spark NLP, and another example for…"/><meta data-rh="true" property="og:url" content="https://medium.com/spark-nlp/importing-huggingface-models-into-sparknlp-8c63bdea671d"/><meta data-rh="true" property="al:web:url" content="https://medium.com/spark-nlp/importing-huggingface-models-into-sparknlp-8c63bdea671d"/><meta data-rh="true" property="og:image" content="https://miro.medium.com/v2/resize:fit:1159/1*oCr5acFXd5-DNl5c988rLA.png"/><meta data-rh="true" property="article:author" content="https://medium.com/@jjmcarrascosa"/><meta data-rh="true" name="author" content="Juan Martinez"/><meta data-rh="true" name="robots" content="index,noarchive,follow,max-image-preview:large"/><meta data-rh="true" name="referrer" content="unsafe-url"/><meta data-rh="true" property="twitter:title" content="Importing HuggingFace models into SparkNLP"/><meta data-rh="true" name="twitter:site" content="@johnsnowlabs"/><meta data-rh="true" name="twitter:app:url:iphone" content="medium://p/8c63bdea671d"/><meta data-rh="true" property="twitter:description" content="In this article we are going to show two examples of how to import Hugging Face embeddings models into Spark NLP, and another example for…"/><meta data-rh="true" name="twitter:image:src" content="https://miro.medium.com/v2/resize:fit:1159/1*oCr5acFXd5-DNl5c988rLA.png"/><meta data-rh="true" name="twitter:card" content="summary_large_image"/><meta data-rh="true" name="twitter:label1" content="Reading time"/><meta data-rh="true" name="twitter:data1" content="7 min read"/><link data-rh="true" rel="icon" href="https://miro.medium.com/v2/5d8de952517e8160e40ef9841c781cdc14a5db313057fa3c3de41c6f5b494b19"/><link data-rh="true" rel="search" type="application/opensearchdescription+xml" title="Medium" href="/osd.xml"/><link data-rh="true" rel="apple-touch-icon" sizes="152x152" href="https://miro.medium.com/v2/resize:fill:304:304/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="120x120" href="https://miro.medium.com/v2/resize:fill:240:240/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="76x76" href="https://miro.medium.com/v2/resize:fill:152:152/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="60x60" href="https://miro.medium.com/v2/resize:fill:120:120/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="mask-icon" href="https://miro.medium.com/v2/resize:fill:1000:1000/7*GAOKVe--MXbEJmV9230oOQ.png" color="#171717"/><link data-rh="true" rel="preconnect" href="https://glyph.medium.com" crossOrigin=""/><link data-rh="true" id="glyph_preload_link" rel="preload" as="style" type="text/css" href="https://glyph.medium.com/css/unbound.css"/><link data-rh="true" id="glyph_link" rel="stylesheet" type="text/css" href="https://glyph.medium.com/css/unbound.css"/><link data-rh="true" rel="author" href="https://medium.com/@jjmcarrascosa"/><link data-rh="true" rel="canonical" href="https://www.johnsnowlabs.com/importing-huggingface-models-into-spark-nlp/"/><link data-rh="true" rel="alternate" href="android-app://com.medium.reader/https/medium.com/p/8c63bdea671d"/><script data-rh="true" type="application/ld+json">{"@context":"http:\u002F\u002Fschema.org","@type":"NewsArticle","image":["https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fresize:fit:1200\u002F1*oCr5acFXd5-DNl5c988rLA.png"],"url":"https:\u002F\u002Fmedium.com\u002Fspark-nlp\u002Fimporting-huggingface-models-into-sparknlp-8c63bdea671d","dateCreated":"2021-11-08T14:41:07.292Z","datePublished":"2021-11-08T14:41:07.292Z","dateModified":"2023-04-24T19:30:59.036Z","headline":"Importing Hugging Face models into Spark NLP - spark-nlp - Medium","name":"Importing Hugging Face models into Spark NLP - spark-nlp - Medium","description":"In this article we are going to show two examples of how to import Hugging Face embeddings models into Spark NLP, and another example showcasing a bulk importing of 7 BertForSequenceClassification…","identifier":"8c63bdea671d","author":{"@type":"Person","name":"Juan Martinez","url":"https:\u002F\u002Fmedium.com\u002F@jjmcarrascosa"},"creator":["Juan Martinez"],"publisher":{"@type":"Organization","name":"spark-nlp","url":"https:\u002F\u002Fmedium.com\u002Fspark-nlp","logo":{"@type":"ImageObject","width":213,"height":60,"url":"https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fresize:fit:426\u002F1*yt4eNSte8veSTOh0spY9EQ.png"}},"mainEntityOfPage":"https:\u002F\u002Fmedium.com\u002Fspark-nlp\u002Fimporting-huggingface-models-into-sparknlp-8c63bdea671d"}</script><style type="text/css" data-fela-rehydration="522" data-fela-type="STATIC">html{box-sizing:border-box;-webkit-text-size-adjust:100%}*, *:before, *:after{box-sizing:inherit}body{margin:0;padding:0;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;color:rgba(0,0,0,0.8);position:relative;min-height:100vh}h1, h2, h3, h4, h5, h6, dl, dd, ol, ul, menu, figure, blockquote, p, pre, form{margin:0}menu, ol, ul{padding:0;list-style:none;list-style-image:none}main{display:block}a{color:inherit;text-decoration:none}a, button, input{-webkit-tap-highlight-color:transparent}img, svg{vertical-align:middle}button{background:transparent;overflow:visible}button, input, optgroup, select, textarea{margin:0}:root{--reach-tabs:1;--reach-menu-button:1}#speechify-root{font-family:Sohne, sans-serif}div[data-popper-reference-hidden="true"]{visibility:hidden;pointer-events:none}.grecaptcha-badge{visibility:hidden}
/*XCode style (c) Angel Garcia <angelgarcia.mail@gmail.com>*/.hljs {background: #fff;color: black;
}/* Gray DOCTYPE selectors like WebKit */
.xml .hljs-meta {color: #c0c0c0;
}.hljs-comment,
.hljs-quote {color: #007400;
}.hljs-tag,
.hljs-attribute,
.hljs-keyword,
.hljs-selector-tag,
.hljs-literal,
.hljs-name {color: #aa0d91;
}.hljs-variable,
.hljs-template-variable {color: #3F6E74;
}.hljs-code,
.hljs-string,
.hljs-meta .hljs-string {color: #c41a16;
}.hljs-regexp,
.hljs-link {color: #0E0EFF;
}.hljs-title,
.hljs-symbol,
.hljs-bullet,
.hljs-number {color: #1c00cf;
}.hljs-section,
.hljs-meta {color: #643820;
}.hljs-title.class_,
.hljs-class .hljs-title,
.hljs-type,
.hljs-built_in,
.hljs-params {color: #5c2699;
}.hljs-attr {color: #836C28;
}.hljs-subst {color: #000;
}.hljs-formula {background-color: #eee;font-style: italic;
}.hljs-addition {background-color: #baeeba;
}.hljs-deletion {background-color: #ffc8bd;
}.hljs-selector-id,
.hljs-selector-class {color: #9b703f;
}.hljs-doctag,
.hljs-strong {font-weight: bold;
}.hljs-emphasis {font-style: italic;
}
</style><style type="text/css" data-fela-rehydration="522" data-fela-type="KEYFRAME">@-webkit-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@-moz-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}</style><style type="text/css" data-fela-rehydration="522" data-fela-type="RULE">.a{font-family:medium-content-sans-serif-font, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif}.b{font-weight:400}.c{background-color:rgba(255, 255, 255, 1)}.l{display:block}.m{position:sticky}.n{top:0}.o{z-index:500}.p{padding:0 24px}.q{align-items:center}.r{border-bottom:solid 1px #F2F2F2}.y{height:41px}.z{line-height:20px}.ab{display:flex}.ac{height:57px}.ae{flex:1 0 auto}.af{color:inherit}.ag{fill:inherit}.ah{font-size:inherit}.ai{border:inherit}.aj{font-family:inherit}.ak{letter-spacing:inherit}.al{font-weight:inherit}.am{padding:0}.an{margin:0}.ao{cursor:pointer}.ap:disabled{cursor:not-allowed}.aq:disabled{color:#6B6B6B}.ar:disabled{fill:#6B6B6B}.au{width:auto}.av path{fill:#242424}.aw{height:25px}.ax{margin-left:16px}.ay{border:none}.az{border-radius:20px}.ba{width:240px}.bb{background:#F9F9F9}.bc path{fill:#6B6B6B}.be{outline:none}.bf{font-family:sohne, "Helvetica Neue", Helvetica, Arial, sans-serif}.bg{font-size:14px}.bh{width:100%}.bi{padding:10px 20px 10px 0}.bj{background-color:transparent}.bk{color:#242424}.bl::placeholder{color:#6B6B6B}.bm{display:inline-block}.bn{margin-left:12px}.bo{margin-right:12px}.bp{border-radius:4px}.bq{margin-left:24px}.br{height:24px}.bx{background-color:#F9F9F9}.by{border-radius:50%}.bz{height:32px}.ca{width:32px}.cb{justify-content:center}.ch{max-width:680px}.ci{min-width:0}.cj{animation:k1 1.2s ease-in-out infinite}.ck{height:100vh}.cl{margin-bottom:16px}.cm{margin-top:48px}.cn{align-items:flex-start}.co{flex-direction:column}.cp{justify-content:space-between}.cq{margin-bottom:24px}.cw{width:80%}.cx{background-color:#F2F2F2}.dd{height:44px}.de{width:44px}.df{margin:auto 0}.dg{margin-bottom:4px}.dh{height:16px}.di{width:120px}.dj{width:80px}.dp{margin-bottom:8px}.dq{width:96%}.dr{width:98%}.ds{width:81%}.dt{margin-left:8px}.du{color:#6B6B6B}.dv{font-size:13px}.dw{height:100%}.ep{color:#FFFFFF}.eq{fill:#FFFFFF}.er{background:rgba(60, 141, 207, 1)}.es{border-color:rgba(60, 141, 207, 1)}.ew:disabled{cursor:inherit !important}.ex:disabled{opacity:0.3}.ey:disabled:hover{background:rgba(60, 141, 207, 1)}.ez:disabled:hover{border-color:rgba(60, 141, 207, 1)}.fa{border-radius:99em}.fb{border-width:1px}.fc{border-style:solid}.fd{box-sizing:border-box}.fe{text-decoration:none}.ff{text-align:center}.fi{margin-right:32px}.fj{position:relative}.fk{fill:#6B6B6B}.fn{background:transparent}.fo svg{margin-left:4px}.fp svg{fill:#6B6B6B}.fr{box-shadow:inset 0 0 0 1px rgba(0, 0, 0, 0.05)}.fs{position:absolute}.fz{margin:0 24px}.gd{background:rgba(255, 255, 255, 1)}.ge{border:1px solid #F2F2F2}.gf{box-shadow:0 1px 4px #F2F2F2}.gg{max-height:100vh}.gh{overflow-y:auto}.gi{left:0}.gj{top:calc(100vh + 100px)}.gk{bottom:calc(100vh + 100px)}.gl{width:10px}.gm{pointer-events:none}.gn{word-break:break-word}.go{word-wrap:break-word}.gp:after{display:block}.gq:after{content:""}.gr:after{clear:both}.gs{line-height:1.23}.gt{letter-spacing:0}.gu{font-style:normal}.gv{font-weight:700}.ia{align-items:baseline}.ib{width:48px}.ic{height:48px}.id{border:2px solid rgba(255, 255, 255, 1)}.ie{z-index:0}.if{box-shadow:none}.ig{border:1px solid rgba(0, 0, 0, 0.05)}.ih{margin-left:-12px}.ii{width:28px}.ij{height:28px}.ik{z-index:1}.il{width:24px}.im{margin-bottom:2px}.in{flex-wrap:nowrap}.io{font-size:16px}.ip{line-height:24px}.ir{margin:0 8px}.is{display:inline}.it{color:rgba(60, 141, 207, 1)}.iu{fill:rgba(60, 141, 207, 1)}.ix{flex:0 0 auto}.ja{flex-wrap:wrap}.jd{white-space:pre-wrap}.je{margin-right:4px}.jf{overflow:hidden}.jg{max-height:20px}.jh{text-overflow:ellipsis}.ji{display:-webkit-box}.jj{-webkit-line-clamp:1}.jk{-webkit-box-orient:vertical}.jl{word-break:break-all}.jn{padding-left:8px}.jo{padding-right:8px}.kp> *{flex-shrink:0}.kq{overflow-x:scroll}.kr::-webkit-scrollbar{display:none}.ks{scrollbar-width:none}.kt{-ms-overflow-style:none}.ku{width:74px}.kv{flex-direction:row}.kw{z-index:2}.kz{-webkit-user-select:none}.la{border:0}.lb{fill:rgba(117, 117, 117, 1)}.le{outline:0}.lf{user-select:none}.lg> svg{pointer-events:none}.lp{cursor:progress}.lq{opacity:1}.lr{padding:4px 0}.lu{margin-top:0px}.lv{width:16px}.lx{display:inline-flex}.md{max-width:100%}.me{padding:8px 2px}.mf svg{color:#6B6B6B}.mw{line-height:1.58}.mx{letter-spacing:-0.004em}.my{font-family:source-serif-pro, Georgia, Cambria, "Times New Roman", Times, serif}.nt{margin-bottom:-0.46em}.nu{margin-left:auto}.nv{margin-right:auto}.nw{max-width:717px}.oc{clear:both}.oe{cursor:zoom-in}.of{z-index:auto}.oh{height:auto}.oi{margin-top:32px}.oj{margin-bottom:14px}.ok{padding-top:24px}.ol{padding-bottom:10px}.om{background-color:#000000}.on{height:3px}.oo{width:3px}.op{margin-right:20px}.oq{line-height:1.12}.or{letter-spacing:-0.022em}.os{font-weight:600}.pn{margin-bottom:-0.28em}.pt{list-style-type:decimal}.pu{margin-left:30px}.pv{padding-left:0px}.qb{overflow-x:auto}.qc{font-family:source-code-pro, Menlo, Monaco, "Courier New", Courier, monospace}.qd{padding:20px}.qe{border-radius:0}.qf{background:#F2F2F2}.qg{line-height:1.18}.qh{margin-top:-0.09em}.qi{margin-bottom:-0.09em}.qj{min-width:fit-content}.qk{margin-top:0.91em}.ql{text-decoration:underline}.qm{max-width:1159px}.qn{max-width:797px}.qo{font-style:italic}.qp{max-width:884px}.qq{margin-bottom:26px}.qr{margin-top:6px}.qs{margin-top:8px}.qt{margin-right:8px}.qu{padding:8px 16px}.qv{border-radius:100px}.qw{transition:background 300ms ease}.qy{white-space:nowrap}.qz{border-top:none}.rf{height:52px}.rg{max-height:52px}.rh{box-sizing:content-box}.ri{position:static}.rk{max-width:155px}.rv{align-items:flex-end}.rw{width:76px}.rx{height:76px}.ry{border:2px solid #F9F9F9}.rz{height:72px}.sa{width:72px}.sb{margin-left:-16px}.sc{width:36px}.sd{height:36px}.se{stroke:#F2F2F2}.sf{color:#F2F2F2}.sg{fill:#F2F2F2}.sh{border-color:#F2F2F2}.sn{font-weight:500}.so{font-size:24px}.sp{line-height:30px}.sq{letter-spacing:-0.016em}.sr{margin-top:16px}.ss{height:0px}.st{border-bottom:solid 1px #E5E5E5}.sz{margin-top:72px}.ta{padding:24px 0}.tb{margin-bottom:0px}.tc{margin-right:16px}.as:hover:not(:disabled){color:rgba(25, 25, 25, 1)}.at:hover:not(:disabled){fill:rgba(25, 25, 25, 1)}.et:hover{background:rgba(59, 121, 173, 1)}.eu:hover{border-color:rgba(59, 121, 173, 1)}.ev:hover{cursor:pointer}.fl:hover{color:#242424}.fm:hover{fill:#242424}.fq:hover svg{fill:#242424}.ft:hover{background-color:rgba(0, 0, 0, 0.1)}.iq:hover{text-decoration:underline}.iv:hover:not(:disabled){color:rgba(59, 121, 173, 1)}.iw:hover:not(:disabled){fill:rgba(59, 121, 173, 1)}.ld:hover{fill:rgba(8, 8, 8, 1)}.ls:hover{fill:#000000}.lt:hover p{color:#000000}.lw:hover{color:#000000}.mg:hover svg{color:#000000}.qx:hover{background-color:#F2F2F2}.si:hover{background:#F2F2F2}.sj:hover{border-color:#F2F2F2}.sk:hover{cursor:wait}.sl:hover{color:#F2F2F2}.sm:hover{fill:#F2F2F2}.bd:focus-within path{fill:#242424}.lc:focus{fill:rgba(8, 8, 8, 1)}.mh:focus svg{color:#000000}.og:focus{transform:scale(1.01)}.lh:active{border-style:none}</style><style type="text/css" data-fela-rehydration="522" data-fela-type="RULE" media="all and (min-width: 1080px)">.d{display:none}.bw{width:64px}.cg{margin:0 64px}.cv{height:48px}.dc{margin-bottom:52px}.do{margin-bottom:48px}.ef{font-size:14px}.eg{line-height:20px}.em{font-size:13px}.eo{padding:5px 12px}.fh{display:flex}.fy{margin-bottom:68px}.gc{max-width:680px}.hq{font-size:42px}.hr{margin-top:1.19em}.hs{margin-bottom:32px}.ht{line-height:52px}.hu{letter-spacing:-0.011em}.hz{align-items:center}.kb{border-top:solid 1px #F2F2F2}.kc{border-bottom:solid 1px #F2F2F2}.kd{margin:32px 0 0}.ke{padding:3px 8px}.kn> *{margin-right:24px}.ko> :last-child{margin-right:0}.lo{margin-top:0px}.mc{margin:0}.np{font-size:20px}.nq{margin-top:2.14em}.nr{line-height:32px}.ns{letter-spacing:-0.003em}.ob{margin-top:56px}.pj{font-size:24px}.pk{margin-top:1.25em}.pl{line-height:30px}.pm{letter-spacing:-0.016em}.ps{margin-top:0.94em}.qa{margin-top:1.14em}.re{margin-bottom:88px}.rp{display:inline-block}.ru{padding-top:72px}.sy{margin-top:40px}</style><style type="text/css" data-fela-rehydration="522" data-fela-type="RULE" media="all and (max-width: 1079.98px)">.e{display:none}.ln{margin-top:0px}.ro{display:inline-block}</style><style type="text/css" data-fela-rehydration="522" data-fela-type="RULE" media="all and (max-width: 903.98px)">.f{display:none}.lm{margin-top:0px}.rn{display:inline-block}</style><style type="text/css" data-fela-rehydration="522" data-fela-type="RULE" media="all and (max-width: 727.98px)">.g{display:none}.lk{margin-top:0px}.ll{margin-right:0px}.rm{display:inline-block}</style><style type="text/css" data-fela-rehydration="522" data-fela-type="RULE" media="all and (max-width: 551.98px)">.h{display:none}.s{display:flex}.t{justify-content:space-between}.bs{width:24px}.cc{margin:0 24px}.cr{height:40px}.cy{margin-bottom:44px}.dk{margin-bottom:32px}.dx{font-size:13px}.dy{line-height:20px}.eh{padding:0px 8px 1px}.fu{margin-bottom:4px}.gw{font-size:32px}.gx{margin-top:1.01em}.gy{margin-bottom:24px}.gz{line-height:38px}.ha{letter-spacing:-0.014em}.hv{align-items:flex-start}.iy{flex-direction:column}.jb{margin-bottom:2px}.jp{margin:24px -24px 0}.jq{padding:0}.kf> *{margin-right:8px}.kg> :last-child{margin-right:24px}.kx{margin-left:0px}.li{margin-top:0px}.lj{margin-right:0px}.ly{margin:0}.mi{border:1px solid #F2F2F2}.mj{border-radius:99em}.mk{padding:0px 16px 0px 12px}.ml{height:38px}.mm{align-items:center}.mo svg{margin-right:8px}.mz{font-size:18px}.na{margin-top:1.56em}.nb{line-height:28px}.nc{letter-spacing:-0.003em}.nx{margin-top:40px}.ot{font-size:20px}.ou{margin-top:0.93em}.ov{line-height:24px}.ow{letter-spacing:0}.po{margin-top:0.67em}.pw{margin-top:1.34em}.ra{margin-bottom:80px}.rl{display:inline-block}.rq{padding-top:48px}.su{margin-top:32px}.mn:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="522" data-fela-type="RULE" media="all and (min-width: 904px) and (max-width: 1079.98px)">.i{display:none}.bv{width:64px}.cf{margin:0 64px}.cu{height:48px}.db{margin-bottom:52px}.dn{margin-bottom:48px}.ed{font-size:14px}.ee{line-height:20px}.ek{font-size:13px}.el{padding:5px 12px}.fg{display:flex}.fx{margin-bottom:68px}.gb{max-width:680px}.hl{font-size:42px}.hm{margin-top:1.19em}.hn{margin-bottom:32px}.ho{line-height:52px}.hp{letter-spacing:-0.011em}.hy{align-items:center}.jx{border-top:solid 1px #F2F2F2}.jy{border-bottom:solid 1px #F2F2F2}.jz{margin:32px 0 0}.ka{padding:3px 8px}.kl> *{margin-right:24px}.km> :last-child{margin-right:0}.mb{margin:0}.nl{font-size:20px}.nm{margin-top:2.14em}.nn{line-height:32px}.no{letter-spacing:-0.003em}.oa{margin-top:56px}.pf{font-size:24px}.pg{margin-top:1.25em}.ph{line-height:30px}.pi{letter-spacing:-0.016em}.pr{margin-top:0.94em}.pz{margin-top:1.14em}.rd{margin-bottom:88px}.rt{padding-top:72px}.sx{margin-top:40px}</style><style type="text/css" data-fela-rehydration="522" data-fela-type="RULE" media="all and (min-width: 728px) and (max-width: 903.98px)">.j{display:none}.w{display:flex}.x{justify-content:space-between}.bu{width:64px}.ce{margin:0 48px}.ct{height:48px}.da{margin-bottom:52px}.dm{margin-bottom:48px}.eb{font-size:13px}.ec{line-height:20px}.ej{padding:0px 8px 1px}.fw{margin-bottom:68px}.ga{max-width:680px}.hg{font-size:42px}.hh{margin-top:1.19em}.hi{margin-bottom:32px}.hj{line-height:52px}.hk{letter-spacing:-0.011em}.hx{align-items:center}.jt{border-top:solid 1px #F2F2F2}.ju{border-bottom:solid 1px #F2F2F2}.jv{margin:32px 0 0}.jw{padding:3px 8px}.kj> *{margin-right:24px}.kk> :last-child{margin-right:0}.ma{margin:0}.nh{font-size:20px}.ni{margin-top:2.14em}.nj{line-height:32px}.nk{letter-spacing:-0.003em}.nz{margin-top:56px}.pb{font-size:24px}.pc{margin-top:1.25em}.pd{line-height:30px}.pe{letter-spacing:-0.016em}.pq{margin-top:0.94em}.py{margin-top:1.14em}.rc{margin-bottom:88px}.rs{padding-top:72px}.sw{margin-top:40px}</style><style type="text/css" data-fela-rehydration="522" data-fela-type="RULE" media="all and (min-width: 552px) and (max-width: 727.98px)">.k{display:none}.u{display:flex}.v{justify-content:space-between}.bt{width:24px}.cd{margin:0 24px}.cs{height:40px}.cz{margin-bottom:44px}.dl{margin-bottom:32px}.dz{font-size:13px}.ea{line-height:20px}.ei{padding:0px 8px 1px}.fv{margin-bottom:4px}.hb{font-size:32px}.hc{margin-top:1.01em}.hd{margin-bottom:24px}.he{line-height:38px}.hf{letter-spacing:-0.014em}.hw{align-items:flex-start}.iz{flex-direction:column}.jc{margin-bottom:2px}.jr{margin:24px 0 0}.js{padding:0}.kh> *{margin-right:8px}.ki> :last-child{margin-right:8px}.ky{margin-left:0px}.lz{margin:0}.mp{border:1px solid #F2F2F2}.mq{border-radius:99em}.mr{padding:0px 16px 0px 12px}.ms{height:38px}.mt{align-items:center}.mv svg{margin-right:8px}.nd{font-size:18px}.ne{margin-top:1.56em}.nf{line-height:28px}.ng{letter-spacing:-0.003em}.ny{margin-top:40px}.ox{font-size:20px}.oy{margin-top:0.93em}.oz{line-height:24px}.pa{letter-spacing:0}.pp{margin-top:0.67em}.px{margin-top:1.34em}.rb{margin-bottom:80px}.rr{padding-top:48px}.sv{margin-top:32px}.mu:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="522" data-fela-type="RULE" media="print">.rj{display:none}</style><style type="text/css" data-fela-rehydration="522" data-fela-type="RULE" media="(orientation: landscape) and (max-width: 903.98px)">.jm{max-height:none}</style><style type="text/css" data-fela-rehydration="522" data-fela-type="RULE" media="(prefers-reduced-motion: no-preference)">.od{transition:transform 300ms cubic-bezier(0.2, 0, 0.2, 1)}</style></head><body><div id="root"><div class="a b c"><div class="d e f g h i j k"></div><script>document.domain = document.domain;</script><div class="l c"><div class="l m n o c"><div class="p q r s t u v w x i d y z"><a class="du ag dv bf ak b am an ao ap aq ar as at s u w i d q dw z" href="https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F8c63bdea671d&amp;%7Efeature=LoOpenInAppButton&amp;%7Echannel=ShowPostUnderCollection&amp;source=---two_column_layout_nav----------------------------------" rel="noopener follow">Open in app<svg xmlns="http://www.w3.org/2000/svg" width="10" height="10" fill="none" viewBox="0 0 10 10" class="dt"><path fill="currentColor" d="M.985 8.485a.375.375 0 1 0 .53.53zM8.75 1.25h.375A.375.375 0 0 0 8.75.875zM8.375 6.5a.375.375 0 1 0 .75 0zM3.5.875a.375.375 0 1 0 0 .75zm-1.985 8.14 7.5-7.5-.53-.53-7.5 7.5zm6.86-7.765V6.5h.75V1.25zM3.5 1.625h5.25v-.75H3.5z"></path></svg></a><div class="ab q"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><button class="bf b dx dy eh dz ea ei eb ec ej ek ee el em eg eo ep eq er es et eu ev ew ex ey ez fa fb fc fd bm fe ff" data-testid="headerSignUpButton">Sign up</button></span></p><div class="ax l"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSignInButton" rel="noopener follow" href="/m/signin?operation=login&amp;redirect=https%3A%2F%2Fmedium.com%2Fspark-nlp%2Fimporting-huggingface-models-into-sparknlp-8c63bdea671d&amp;source=post_page---two_column_layout_nav-----------------------global_nav-----------">Sign in</a></span></p></div></div></div><div class="p q r ab ac"><div class="ab q ae"><a class="af ag ah ai aj ak al am an ao ap aq ar as at ab" aria-label="Homepage" data-testid="headerMediumLogo" rel="noopener follow" href="/?source=---two_column_layout_nav----------------------------------"><svg xmlns="http://www.w3.org/2000/svg" width="719" height="160" fill="none" viewBox="0 0 719 160" class="au av aw"><path fill="#242424" d="m174.104 9.734.215-.047V8.02H130.39L89.6 103.89 48.81 8.021H1.472v1.666l.212.047c8.018 1.81 12.09 4.509 12.09 14.242V137.93c0 9.734-4.087 12.433-12.106 14.243l-.212.047v1.671h32.118v-1.665l-.213-.048c-8.018-1.809-12.089-4.509-12.089-14.242V30.586l52.399 123.305h2.972l53.925-126.743V140.75c-.687 7.688-4.721 10.062-11.982 11.701l-.215.05v1.652h55.948v-1.652l-.215-.05c-7.269-1.639-11.4-4.013-12.087-11.701l-.037-116.774h.037c0-9.733 4.071-12.432 12.087-14.242m25.555 75.488c.915-20.474 8.268-35.252 20.606-35.507 3.806.063 6.998 1.312 9.479 3.714 5.272 5.118 7.751 15.812 7.368 31.793zm-.553 5.77h65.573v-.275c-.186-15.656-4.721-27.834-13.466-36.196-7.559-7.227-18.751-11.203-30.507-11.203h-.263c-6.101 0-13.584 1.48-18.909 4.16-6.061 2.807-11.407 7.003-15.855 12.511-7.161 8.874-11.499 20.866-12.554 34.343q-.05.606-.092 1.212a50 50 0 0 0-.065 1.151 85.807 85.807 0 0 0-.094 5.689c.71 30.524 17.198 54.917 46.483 54.917 25.705 0 40.675-18.791 44.407-44.013l-1.886-.664c-6.557 13.556-18.334 21.771-31.738 20.769-18.297-1.369-32.314-19.922-31.042-42.395m139.722 41.359c-2.151 5.101-6.639 7.908-12.653 7.908s-11.513-4.129-15.418-11.63c-4.197-8.053-6.405-19.436-6.405-32.92 0-28.067 8.729-46.22 22.24-46.22 5.657 0 10.111 2.807 12.236 7.704zm43.499 20.008c-8.019-1.897-12.089-4.722-12.089-14.951V1.309l-48.716 14.353v1.757l.299-.024c6.72-.543 11.278.386 13.925 2.83 2.072 1.915 3.082 4.853 3.082 8.987v18.66c-4.803-3.067-10.516-4.56-17.448-4.56-14.059 0-26.909 5.92-36.176 16.672-9.66 11.205-14.767 26.518-14.767 44.278-.003 31.72 15.612 53.039 38.851 53.039 13.595 0 24.533-7.449 29.54-20.013v16.865h43.711v-1.746zM424.1 19.819c0-9.904-7.468-17.374-17.375-17.374-9.859 0-17.573 7.632-17.573 17.374s7.721 17.374 17.573 17.374c9.907 0 17.375-7.47 17.375-17.374m11.499 132.546c-8.019-1.897-12.089-4.722-12.089-14.951h-.035V43.635l-43.714 12.551v1.705l.263.024c9.458.842 12.047 4.1 12.047 15.152v81.086h43.751v-1.746zm112.013 0c-8.018-1.897-12.089-4.722-12.089-14.951V43.635l-41.621 12.137v1.71l.246.026c7.733.813 9.967 4.257 9.967 15.36v59.279c-2.578 5.102-7.415 8.131-13.274 8.336-9.503 0-14.736-6.419-14.736-18.073V43.638l-43.714 12.55v1.703l.262.024c9.459.84 12.05 4.097 12.05 15.152v50.17a56.3 56.3 0 0 0 .91 10.444l.787 3.423c3.701 13.262 13.398 20.197 28.59 20.197 12.868 0 24.147-7.966 29.115-20.43v17.311h43.714v-1.747zm169.818 1.788v-1.749l-.213-.05c-8.7-2.006-12.089-5.789-12.089-13.49v-63.79c0-19.89-11.171-31.761-29.883-31.761-13.64 0-25.141 7.882-29.569 20.16-3.517-13.01-13.639-20.16-28.606-20.16-13.146 0-23.449 6.938-27.869 18.657V43.643L545.487 55.68v1.715l.263.024c9.345.829 12.047 4.181 12.047 14.95v81.784h40.787v-1.746l-.215-.053c-6.941-1.631-9.181-4.606-9.181-12.239V66.998c1.836-4.289 5.537-9.37 12.853-9.37 9.086 0 13.692 6.296 13.692 18.697v77.828h40.797v-1.746l-.215-.053c-6.94-1.631-9.18-4.606-9.18-12.239V75.066a42 42 0 0 0-.578-7.26c1.947-4.661 5.86-10.177 13.475-10.177 9.214 0 13.691 6.114 13.691 18.696v77.828z"></path></svg></a><div class="ax h"><div class="ab ay az ba bb q bc bd"><div class="bm" aria-hidden="false" aria-describedby="searchResults" aria-labelledby="searchResults"></div><div class="bn bo ab"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M4.092 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0m6.95-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .79-.79l-3.73-3.73A8.05 8.05 0 0 0 11.042 3z" clip-rule="evenodd"></path></svg></div><input role="combobox" aria-controls="searchResults" aria-expanded="false" aria-label="search" data-testid="headerSearchInput" tabindex="0" class="ay be bf bg z bh bi bj bk bl" placeholder="Search" value=""/></div></div></div><div class="h k w fg fh"><div class="fi ab"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerWriteButton" rel="noopener follow" href="/m/signin?operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fnew-story&amp;source=---two_column_layout_nav-----------------------new_post_topnav-----------"><div class="bf b bg z du fj fk ab q fl fm"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-label="Write"><path fill="currentColor" d="M14 4a.5.5 0 0 0 0-1zm7 6a.5.5 0 0 0-1 0zm-7-7H4v1h10zM3 4v16h1V4zm1 17h16v-1H4zm17-1V10h-1v10zm-1 1a1 1 0 0 0 1-1h-1zM3 20a1 1 0 0 0 1 1v-1zM4 3a1 1 0 0 0-1 1h1z"></path><path stroke="currentColor" d="m17.5 4.5-8.458 8.458a.25.25 0 0 0-.06.098l-.824 2.47a.25.25 0 0 0 .316.316l2.47-.823a.25.25 0 0 0 .098-.06L19.5 6.5m-2-2 2.323-2.323a.25.25 0 0 1 .354 0l1.646 1.646a.25.25 0 0 1 0 .354L19.5 6.5m-2-2 2 2"></path></svg><div class="dt l">Write</div></div></a></span></div></div><div class="k j i d"><div class="fi ab"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSearchButton" rel="noopener follow" href="/search?source=---two_column_layout_nav----------------------------------"><div class="bf b bg z du fj fk ab q fl fm"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-label="Search"><path fill="currentColor" fill-rule="evenodd" d="M4.092 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0m6.95-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .79-.79l-3.73-3.73A8.05 8.05 0 0 0 11.042 3z" clip-rule="evenodd"></path></svg></div></a></div></div><div class="fi h k j"><div class="ab q"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><button class="bf b dx dy eh dz ea ei eb ec ej ek ee el em eg eo ep eq er es et eu ev ew ex ey ez fa fb fc fd bm fe ff" data-testid="headerSignUpButton">Sign up</button></span></p><div class="ax l"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSignInButton" rel="noopener follow" href="/m/signin?operation=login&amp;redirect=https%3A%2F%2Fmedium.com%2Fspark-nlp%2Fimporting-huggingface-models-into-sparknlp-8c63bdea671d&amp;source=post_page---two_column_layout_nav-----------------------global_nav-----------">Sign in</a></span></p></div></div></div><div class="l" aria-hidden="false"><button class="ay fn am ab q ao fo fp fq" aria-label="user options menu" data-testid="headerUserIcon"><div class="l fj"><img alt="" class="l fd by bz ca cx" src="https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png" width="32" height="32" loading="lazy" role="presentation"/><div class="fr by l bz ca fs n ay ft"></div></div></button></div></div></div><div class="l"><div class="fu fv fw fx fy l"><div class="ab cb"><div class="ci bh fz ga gb gc"></div></div><article><div class="l"><div class="l"><span class="l"></span><section><div><div class="fs gi gj gk gl gm"></div><div class="gn go gp gq gr"><div class="ab cb"><div class="ci bh fz ga gb gc"><div><h1 id="40ca" class="pw-post-title gs gt gu bf gv gw gx gy gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho hp hq hr hs ht hu bk" data-testid="storyTitle">Importing Hugging Face models into Spark NLP</h1><div><div class="speechify-ignore ab cp"><div class="speechify-ignore bh l"><div class="hv hw hx hy hz ab"><div><div class="ab ia"><a rel="noopener follow" href="/@jjmcarrascosa?source=post_page-----8c63bdea671d--------------------------------"><div><div class="bm" aria-hidden="false"><div class="l ib ic by id ie"><div class="l fj"><img alt="Juan Martinez" class="l fd by dd de cx" src="https://miro.medium.com/v2/resize:fill:88:88/1*8hQ3UPHaKMqrUwADnkt7GA.jpeg" width="44" height="44" loading="lazy" data-testid="authorPhoto"/><div class="if by l dd de fs n ig ft"></div></div></div></div></div></a><a href="https://medium.com/spark-nlp?source=post_page-----8c63bdea671d--------------------------------" rel="noopener follow"><div class="ih ab fj"><div><div class="bm" aria-hidden="false"><div class="l ii ij by id ik"><div class="l fj"><img alt="spark-nlp" class="l fd by br il cx" src="https://miro.medium.com/v2/resize:fill:48:48/1*NM-W9Li1MU8zNvfTT2Opkw.jpeg" width="24" height="24" loading="lazy" data-testid="publicationPhoto"/><div class="if by l br il fs n ig ft"></div></div></div></div></div></div></a></div></div><div class="bn bh l"><div class="ab"><div style="flex:1"><span class="bf b bg z bk"><div class="im ab q"><div class="ab q in"><div class="ab q"><div><div class="bm" aria-hidden="false"><p class="bf b io ip bk"><a class="af ag ah ai aj ak al am an ao ap aq ar iq" data-testid="authorName" rel="noopener follow" href="/@jjmcarrascosa?source=post_page-----8c63bdea671d--------------------------------">Juan Martinez</a></p></div></div></div><span class="ir is" aria-hidden="true"><span class="bf b bg z du">·</span></span><p class="bf b io ip du"><span><a class="it iu ah ai aj ak al am an ao ap aq ar ex iv iw" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe11aa5052863&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fspark-nlp%2Fimporting-huggingface-models-into-sparknlp-8c63bdea671d&amp;user=Juan+Martinez&amp;userId=e11aa5052863&amp;source=post_page-e11aa5052863----8c63bdea671d---------------------post_header-----------">Follow</a></span></p></div></div></span></div></div><div class="l ix"><span class="bf b bg z du"><div class="ab cn iy iz ja"><div class="jb jc ab"><div class="bf b bg z du ab jd"><span class="je l ix">Published in</span><div><div class="l" aria-hidden="false"><a class="af ag ah ai aj ak al am an ao ap aq ar iq ab q" data-testid="publicationName" href="https://medium.com/spark-nlp?source=post_page-----8c63bdea671d--------------------------------" rel="noopener follow"><p class="bf b bg z jf jg jh ji jj jk jl jm bk">spark-nlp</p></a></div></div></div><div class="h k"><span class="ir is" aria-hidden="true"><span class="bf b bg z du">·</span></span></div></div><span class="bf b bg z du"><div class="ab ae"><span data-testid="storyReadTime">7 min read</span><div class="jn jo l" aria-hidden="true"><span class="l" aria-hidden="true"><span class="bf b bg z du">·</span></span></div><span data-testid="storyPublishDate">Nov 8, 2021</span></div></span></div></span></div></div></div><div class="ab cp jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke"><div class="h k w fg fh q"><div class="ku l"><div class="ab q kv kw"><div class="pw-multi-vote-icon fj je kx ky kz"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerClapButton" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fspark-nlp%2F8c63bdea671d&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fspark-nlp%2Fimporting-huggingface-models-into-sparknlp-8c63bdea671d&amp;user=Juan+Martinez&amp;userId=e11aa5052863&amp;source=-----8c63bdea671d---------------------clap_footer-----------"><div><div class="bm" aria-hidden="false"><div class="la ao lb lc ld le am lf lg lh kz"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l li lj lk ll lm ln lo"><p class="bf b dv z du"><span class="lp">--</span></p></div></div></div><div><div class="bm" aria-hidden="false"><button class="ao la lq lr ab q fk ls lt" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="lu"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"></path></svg></button></div></div></div><div class="ab q kf kg kh ki kj kk kl km kn ko kp kq kr ks kt"><div class="lv k j i d"></div><div class="h k"><div><div class="bm" aria-hidden="false"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerBookmarkButton" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8c63bdea671d&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fspark-nlp%2Fimporting-huggingface-models-into-sparknlp-8c63bdea671d&amp;source=-----8c63bdea671d---------------------bookmark_footer-----------"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="du lw" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></a></span></div></div></div><div class="fd lx cn"><div class="l ae"><div class="ab cb"><div class="ly lz ma mb mc md ci bh"><div class="ab"><div class="bm bh" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="Listen" data-testid="audioPlayButton" class="af fk ah ai aj ak al me an ao ap ex mf mg lt mh mi mj mk ml s mm mn mo mp mq mr ms u mt mu mv"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M3 12a9 9 0 1 1 18 0 9 9 0 0 1-18 0m9-10C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2m3.376 10.416-4.599 3.066a.5.5 0 0 1-.777-.416V8.934a.5.5 0 0 1 .777-.416l4.599 3.066a.5.5 0 0 1 0 .832" clip-rule="evenodd"></path></svg><div class="j i d"><p class="bf b bg z du">Listen</p></div></button></div></div></div></div></div></div></div></div><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="headerSocialShareButton" class="af fk ah ai aj ak al me an ao ap ex mf mg lt mh mi mj mk ml s mm mn mo mp mq mr ms u mt mu mv"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"></path></svg><div class="j i d"><p class="bf b bg z du">Share</p></div></button></div></div></div></div></div></div></div></div></div><p id="b7d5" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">In this article we are going to show two examples of how to import Hugging Face embeddings models into Spark NLP, and another example showcasing a bulk importing of 7 BertForSequenceClassification models.</p><p id="47fd" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">In addition to that, a link to the several different notebooks for importing different transformers architectures and task types is also included.</p><figure class="nx ny nz oa ob oc nu nv paragraph-image"><div role="button" tabindex="0" class="od oe fj of bh og"><div class="nu nv nw"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*QXxM-kx3t90crs0q0WjzuA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*QXxM-kx3t90crs0q0WjzuA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*QXxM-kx3t90crs0q0WjzuA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*QXxM-kx3t90crs0q0WjzuA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*QXxM-kx3t90crs0q0WjzuA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*QXxM-kx3t90crs0q0WjzuA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QXxM-kx3t90crs0q0WjzuA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*QXxM-kx3t90crs0q0WjzuA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*QXxM-kx3t90crs0q0WjzuA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*QXxM-kx3t90crs0q0WjzuA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*QXxM-kx3t90crs0q0WjzuA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*QXxM-kx3t90crs0q0WjzuA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*QXxM-kx3t90crs0q0WjzuA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*QXxM-kx3t90crs0q0WjzuA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh md oh c" width="700" height="148" loading="eager" role="presentation"/></picture></div></div></figure></div></div></div><div class="ab cb oi oj ok ol" role="separator"><span class="om by bm on oo op"></span><span class="om by bm on oo op"></span><span class="om by bm on oo"></span></div><div class="gn go gp gq gr"><div class="ab cb"><div class="ci bh fz ga gb gc"><h1 id="7836" class="oq or gu bf os ot ou ov ow ox oy oz pa pb pc pd pe pf pg ph pi pj pk pl pm pn bk">1. Importing a RobertaEmbeddings model</h1><p id="6d21" class="pw-post-body-paragraph mw mx gu my b mz po nb nc nd pp nf ng nh pq nj nk nl pr nn no np ps nr ns nt gn bk">Importing a Embeddings model from Hugging Face is very simple. You only need 4 basic steps:</p><ol class=""><li id="21d6" class="mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt pt pu pv bk">Importing Hugging Face and Spark NLP libraries and starting a session;</li><li id="f71e" class="mw mx gu my b mz pw nb nc nd px nf ng nh py nj nk nl pz nn no np qa nr ns nt pt pu pv bk">Using a AutoTokenizer and AutoModelForMaskedLM to download the tokenizer and the model from Hugging Face hub;</li><li id="d9f6" class="mw mx gu my b mz pw nb nc nd px nf ng nh py nj nk nl pz nn no np qa nr ns nt pt pu pv bk">Saving the model in TensorFlow format;</li><li id="1b0a" class="mw mx gu my b mz pw nb nc nd px nf ng nh py nj nk nl pz nn no np qa nr ns nt pt pu pv bk">Load the model into Spark NLP using the proper architecture.</li></ol><p id="35be" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Let’s see step by step the process.</p></div></div></div><div class="ab cb oi oj ok ol" role="separator"><span class="om by bm on oo op"></span><span class="om by bm on oo op"></span><span class="om by bm on oo"></span></div><div class="gn go gp gq gr"><div class="ab cb"><div class="ci bh fz ga gb gc"><h1 id="2b70" class="oq or gu bf os ot ou ov ow ox oy oz pa pb pc pd pe pf pg ph pi pj pk pl pm pn bk">1.1. Importing the libraries and starting a session</h1><p id="6cb2" class="pw-post-body-paragraph mw mx gu my b mz po nb nc nd pp nf ng nh pq nj nk nl pr nn no np ps nr ns nt gn bk">First, we are going to need the transformers library (from Hugging Face), more specifically we are going to use <strong class="my gv">AutoTokenizer </strong>and <strong class="my gv">AutoModelForMaskedLM </strong>for downloading the model, and then <strong class="my gv">TFRobertaModel </strong>from loading it from disk one downloaded. We are going to need <strong class="my gv">tensorflow </strong>as well.</p><p id="23af" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">In case you don’t have them installed in your environment, run first:</p><pre class="nx ny nz oa ob qb qc qd qe ay qf bk"><span id="c1c3" class="qg or gu qc b io qh qi l jd qj">!pip install -q transformers==4.6.1 tensorflow==2.4.1</span></pre><p id="430e" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Afterwards, import the libraries:</p><pre class="nx ny nz oa ob qb qc qd qe ay qf bk"><span id="ef95" class="qg or gu qc b io qh qi l jd qj">import transformers<br/>from transformers import TFRobertaModel<br/>from transformers import AutoTokenizer, AutoModelForMaskedLM</span><span id="cdb7" class="qg or gu qc b io qk qi l jd qj">import tensorflow</span></pre><p id="5f0e" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Let’s add also some generic libraries for file management:</p><pre class="nx ny nz oa ob qb qc qd qe ay qf bk"><span id="4925" class="qg or gu qc b io qh qi l jd qj">import json<br/>import os<br/>import shutil</span></pre><p id="ce47" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">And last, but not lest, let’s add <strong class="my gv">sparknlp</strong> and <strong class="my gv">pyspark</strong> libraries. In case you don’t have Spark NLP installed, please refer to <a class="af ql" href="https://nlp.johnsnowlabs.com/docs/en/install" rel="noopener ugc nofollow" target="_blank">https://nlp.johnsnowlabs.com/docs/en/install</a> to see installation instructions. For Google Colab, it’s as easy as running the following line:</p><pre class="nx ny nz oa ob qb qc qd qe ay qf bk"><span id="968d" class="qg or gu qc b io qh qi l jd qj">! wget http://setup.johnsnowlabs.com/colab.sh -O - | bash</span></pre><p id="7e88" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Then, both PySpark and Spark NLP will be installed, so you can import the libraries…</p><pre class="nx ny nz oa ob qb qc qd qe ay qf bk"><span id="c138" class="qg or gu qc b io qh qi l jd qj">import sparknlp<br/>from sparknlp.base import *<br/>from sparknlp.annotator import *<br/>from sparknlp.annotator import *</span><span id="b6ac" class="qg or gu qc b io qk qi l jd qj">from pyspark.ml import Pipeline<br/>from pyspark.sql import SparkSession</span></pre><p id="57d7" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">… and start a session…</p><pre class="nx ny nz oa ob qb qc qd qe ay qf bk"><span id="5911" class="qg or gu qc b io qh qi l jd qj">import sparknlp<br/>spark = sparknlp.start()</span></pre></div></div></div><div class="ab cb oi oj ok ol" role="separator"><span class="om by bm on oo op"></span><span class="om by bm on oo op"></span><span class="om by bm on oo"></span></div><div class="gn go gp gq gr"><div class="ab cb"><div class="ci bh fz ga gb gc"><h1 id="ba00" class="oq or gu bf os ot ou ov ow ox oy oz pa pb pc pd pe pf pg ph pi pj pk pl pm pn bk">1.2. Using a AutoTokenizer and AutoModelForMaskedLM</h1><p id="b4ed" class="pw-post-body-paragraph mw mx gu my b mz po nb nc nd pp nf ng nh pq nj nk nl pr nn no np ps nr ns nt gn bk">HuggingFace API serves two generic classes to load models without needing to set which transformer architecture or tokenizer they are: <strong class="my gv">AutoTokenizer</strong> and, for the case of embeddings, <strong class="my gv">AutoModelForMaskedLM</strong>.</p><p id="d77e" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Let’s suppose we want to import <strong class="my gv">roberta-base-biomedical-es</strong>, a Clinical Spanish Roberta Embeddings model. I’ve found it in Hugging Face hub, available at <a class="af ql" href="https://huggingface.co/models" rel="noopener ugc nofollow" target="_blank">https://huggingface.co/models</a>.</p><p id="bef7" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Let’s import both tokenizer and model using the classes described above:</p><pre class="nx ny nz oa ob qb qc qd qe ay qf bk"><span id="2b0e" class="qg or gu qc b io qh qi l jd qj">tokenizer = AutoTokenizer.from_pretrained(&quot;PlanTL-GOB-ES/roberta-base-biomedical-es&quot;)</span><span id="ec5a" class="qg or gu qc b io qk qi l jd qj">model = AutoModelForMaskedLM.from_pretrained(&quot;PlanTL-GOB-ES/roberta-base-biomedical-es&quot;)</span></pre></div></div></div><div class="ab cb oi oj ok ol" role="separator"><span class="om by bm on oo op"></span><span class="om by bm on oo op"></span><span class="om by bm on oo"></span></div><div class="gn go gp gq gr"><div class="ab cb"><div class="ci bh fz ga gb gc"><h1 id="b09f" class="oq or gu bf os ot ou ov ow ox oy oz pa pb pc pd pe pf pg ph pi pj pk pl pm pn bk">1.3. Saving the model in TensorFlow format</h1><p id="519e" class="pw-post-body-paragraph mw mx gu my b mz po nb nc nd pp nf ng nh pq nj nk nl pr nn no np ps nr ns nt gn bk">Models in HuggingFace can be, among others, in PyTorch or TensorFlow format.</p><pre class="nx ny nz oa ob qb qc qd qe ay qf bk"><span id="95d4" class="qg or gu qc b io qh qi l jd qj">MODEL_NAME_TF=&#x27;my_model_tf&#x27; # Change me</span><span id="d89e" class="qg or gu qc b io qk qi l jd qj">tokenizer.save_pretrained(f&#x27;./MODEL_NAME_TF}_tokenizer/&#x27;)<br/>model.save_pretrained(f&#x27;./{MODEL_NAME_TF}&#x27;, saved_model=True, save_format=&#x27;tf&#x27;)</span></pre><p id="d2f2" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">In this case, <strong class="my gv">save_format=’tf’</strong> was set because the model was originally in <strong class="my gv">PyTorch </strong>format. That would not be necessary if the model is originally in TensorFlow/Keras.</p><p id="4563" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">At this point, you can check the model can be loaded by HuggingFace TensorFlow specific classes by doing this:</p><pre class="nx ny nz oa ob qb qc qd qe ay qf bk"><span id="f068" class="qg or gu qc b io qh qi l jd qj">loaded_model = TFRobertaModel.from_pretrained(f&#x27;./{MODEL_NAME_TF}&#x27;)</span></pre><p id="1594" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">After saving the model, you also need to add the <strong class="my gv">vocab.txt </strong>file to the assets directory of the saved model. You can achieve that by doing:</p><pre class="nx ny nz oa ob qb qc qd qe ay qf bk"><span id="b271" class="qg or gu qc b io qh qi l jd qj">vocab_pth = f&quot;./{MODEL_NAME_TF}_tokenizer/vocab.txt&quot;<br/>saved_model_pth = f&#x27;./{MODEL_NAME_TF}/saved_model/1/assets/&#x27;</span><span id="9850" class="qg or gu qc b io qk qi l jd qj">!cp $vocab_pth $saved_model_pth</span></pre><p id="4116" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Sometimes, instead of a <strong class="my gv">vocab.txt</strong> file, a <strong class="my gv">vocab.json</strong> may be found. If that is the case, execute the following code before you copy the file with the <strong class="my gv">cp </strong>command above:</p><pre class="nx ny nz oa ob qb qc qd qe ay qf bk"><span id="5938" class="qg or gu qc b io qh qi l jd qj">with open(f&#x27;./{MODEL_NAME_TF}_tokenizer/vocab.json&#x27;, &#x27;r&#x27;) as f:<br/>    data = json.load(f)</span><span id="c0c0" class="qg or gu qc b io qk qi l jd qj">with open(f&#x27;./{MODEL_NAME_TF}_tokenizer/vocab.txt&#x27;, &#x27;w&#x27;) as f:<br/>    for d in data.keys():<br/>        f.write(d)<br/>        f.write(&#x27;\n&#x27;)</span></pre><p id="05ec" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Last, but not least, copy also the merges.txt file the same way:</p><pre class="nx ny nz oa ob qb qc qd qe ay qf bk"><span id="c96c" class="qg or gu qc b io qh qi l jd qj">merges_pth = f&quot;./{MODEL_NAME_TF}_tokenizer/merges.txt&quot;<br/>saved_model_pth = f&#x27;./{MODEL_NAME_TF}/saved_model/1/assets/&#x27;</span><span id="ec46" class="qg or gu qc b io qk qi l jd qj">!cp $merges_pth $saved_model_pth</span></pre></div></div></div><div class="ab cb oi oj ok ol" role="separator"><span class="om by bm on oo op"></span><span class="om by bm on oo op"></span><span class="om by bm on oo"></span></div><div class="gn go gp gq gr"><div class="ab cb"><div class="ci bh fz ga gb gc"><h1 id="b1a3" class="oq or gu bf os ot ou ov ow ox oy oz pa pb pc pd pe pf pg ph pi pj pk pl pm pn bk">1.4. Load the model into Spark NLP using the proper architecture.</h1><p id="4049" class="pw-post-body-paragraph mw mx gu my b mz po nb nc nd pp nf ng nh pq nj nk nl pr nn no np ps nr ns nt gn bk">With the model ready, let’s just import it into Spark NLP using the <strong class="my gv">RoBertaEmbeddings </strong>class.</p><pre class="nx ny nz oa ob qb qc qd qe ay qf bk"><span id="9097" class="qg or gu qc b io qh qi l jd qj">embeddings = RoBertaEmbeddings.loadSavedModel(f&#x27;./{MODEL_NAME_TF}/saved_model/1&#x27;,spark).setInputCols([&quot;document&quot;,&#x27;token&#x27;]).setOutputCol(&quot;embeddings&quot;)</span></pre><p id="f33e" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Now, let’s save to disk the Spark NLP version of the model:</p><pre class="nx ny nz oa ob qb qc qd qe ay qf bk"><span id="496b" class="qg or gu qc b io qh qi l jd qj">embeddings.write().overwrite().save(f&quot;./{MODEL_NAME_TF}_spark_nlp&quot;)</span></pre><p id="b1f4" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">And we are ready to zip it…</p><pre class="nx ny nz oa ob qb qc qd qe ay qf bk"><span id="b50a" class="qg or gu qc b io qh qi l jd qj">shutil.make_archive(f&quot;roberta-base-biomedical-es&quot;, &#x27;zip&#x27;, f&quot;./{MODEL_NAME_TF}_spark_nlp&quot;)</span></pre><p id="4e5c" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">…and to upload it to the Spark NLP Models Hub. To do this, just visit <a class="af ql" href="https://nlp.johnsnowlabs.com/models" rel="noopener ugc nofollow" target="_blank">https://nlp.johnsnowlabs.com/models</a> and click on “Upload Your Model” button.</p><figure class="nx ny nz oa ob oc nu nv paragraph-image"><div role="button" tabindex="0" class="od oe fj of bh og"><div class="nu nv qm"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*oCr5acFXd5-DNl5c988rLA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*oCr5acFXd5-DNl5c988rLA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*oCr5acFXd5-DNl5c988rLA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*oCr5acFXd5-DNl5c988rLA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*oCr5acFXd5-DNl5c988rLA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*oCr5acFXd5-DNl5c988rLA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oCr5acFXd5-DNl5c988rLA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*oCr5acFXd5-DNl5c988rLA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*oCr5acFXd5-DNl5c988rLA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*oCr5acFXd5-DNl5c988rLA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*oCr5acFXd5-DNl5c988rLA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*oCr5acFXd5-DNl5c988rLA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*oCr5acFXd5-DNl5c988rLA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*oCr5acFXd5-DNl5c988rLA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh md oh c" width="700" height="324" loading="lazy" role="presentation"/></picture></div></div></figure></div></div></div><div class="ab cb oi oj ok ol" role="separator"><span class="om by bm on oo op"></span><span class="om by bm on oo op"></span><span class="om by bm on oo"></span></div><div class="gn go gp gq gr"><div class="ab cb"><div class="ci bh fz ga gb gc"><h1 id="7c92" class="oq or gu bf os ot ou ov ow ox oy oz pa pb pc pd pe pf pg ph pi pj pk pl pm pn bk">2. Bulk import of different BertForSequenceClassification models into Spark NLP</h1><p id="e37e" class="pw-post-body-paragraph mw mx gu my b mz po nb nc nd pp nf ng nh pq nj nk nl pr nn no np ps nr ns nt gn bk">Let’s suppose I have taken a look at Hugging Face Models Hub (<a class="af ql" href="https://huggingface.co/models" rel="noopener ugc nofollow" target="_blank">https://huggingface.co/models</a>), and I have detected 7 models I want to import into Spark NLP, for BertForSequenceClassification:</p><pre class="nx ny nz oa ob qb qc qd qe ay qf bk"><span id="de76" class="qg or gu qc b io qh qi l jd qj">models = [&#x27;philschmid/BERT-Banking77&#x27;]<br/>models.append(&#x27;Hate-speech-CNERG/bert-base-uncased-hatexplain&#x27;)<br/>models.append(&#x27;mrm8488/bert-mini-finetuned-age_news-classification&#x27;)<br/>models.append(&#x27;juliensimon/autonlp-song-lyrics-18753417&#x27;)<br/>models.append(&#x27;astarostap/autonlp-antisemitism-2-21194454&#x27;)<br/>models.append(&#x27;aychang/bert-base-cased-trec-coarse&#x27;)<br/>models.append(&#x27;mrm8488/bert-tiny-finetuned-sms-spam-detection&#x27;)</span></pre><p id="aabf" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Since the steps are more or less the same as described in first example, I’m going to automatize in a loop all the steps from downloading, to importing into SparkNLP and inferring, to illustrate an end-to-end import.</p><p id="9f82" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">There is one extra step we need to carry out when importing Classifiers from Hugging Face: we need a <strong class="my gv">labels.txt</strong>, a file that has 1 line per label included in the classifier.</p><p id="e907" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">That file can be created using the <strong class="my gv">config.json </strong>file, with a field called <strong class="my gv">id2label</strong>, provided in most of Hugging Face models. However, we may find models without that field, what leads to using just numeric values for the labels, what is not very user friendly.</p><p id="6c23" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">To support both importing from config.json and creating our own labels, let’s declare an array:</p><pre class="nx ny nz oa ob qb qc qd qe ay qf bk"><span id="2b29" class="qg or gu qc b io qh qi l jd qj">predefined_labels = [None, None, None, None, (&#x27;False&#x27;,&#x27;True&#x27;), None, (&#x27;False&#x27;,&#x27;True&#x27;)]</span></pre><p id="546b" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Each item in the array corresponds to the model in models array. If the value is <strong class="my gv">None</strong>, then we will import the tags from the model. If there is a tuple of <strong class="my gv">string labels</strong>, then the labels will be taken from the tuple. For example, for first model (<strong class="my gv">philschmid/BERT-Banking77</strong>) will get the labels from the model, but last model (<strong class="my gv">mrm8488/bert-tiny-finetuned-sms-spam-detection</strong>) don’t have them, so we are setting them to “False” and “True”.</p></div></div></div><div class="ab cb oi oj ok ol" role="separator"><span class="om by bm on oo op"></span><span class="om by bm on oo op"></span><span class="om by bm on oo"></span></div><div class="gn go gp gq gr"><div class="ab cb"><div class="ci bh fz ga gb gc"><p id="401a" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Now, let’s predefine a pipeline that will be used to check every iteration the results of the model. All of these models will manage Sentences, not documents, so we will have a DocumentAssembler(), a SentenceDetectorDL() and a Tokenizer().</p><pre class="nx ny nz oa ob qb qc qd qe ay qf bk"><span id="159e" class="qg or gu qc b io qh qi l jd qj">documentAssembler = DocumentAssembler()\<br/>    .setInputCol(&quot;text&quot;)\<br/>    .setOutputCol(&quot;document&quot;)</span><span id="596f" class="qg or gu qc b io qk qi l jd qj">sentenceDetector = SentenceDetectorDLModel.pretrained() \<br/>    .setInputCols([&quot;document&quot;]) \<br/>    .setOutputCol(&quot;sentence&quot;)</span><span id="19eb" class="qg or gu qc b io qk qi l jd qj">spark_tokenizer = Tokenizer()\<br/>    .setInputCols(&quot;sentence&quot;)\<br/>    .setOutputCol(&quot;token&quot;)</span></pre><p id="2dc2" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">And now, let’s start the bulk import!</p><pre class="nx ny nz oa ob qb qc qd qe ay qf bk"><span id="81e3" class="qg or gu qc b io qh qi l jd qj">from shutil import copyfile<br/>import collections<br/>import shutil<br/>    <br/>for i, model in enumerate(models):<br/>    print(f&quot;- Downloading {model}&quot;)<br/>    tokenizer = AutoTokenizer.from_pretrained(model)<br/>    modelpt = AutoModelForSequenceClassification.from_pretrained(model)<br/>    <br/>    tokenizer_path = f&#x27;./models/{model}_tokenizer&#x27; <br/>    model_tf_path = f&#x27;./models/{model}_tf&#x27;<br/>    model_sparknlp_path = f&#x27;./models/{model}_sparknlp&#x27;<br/>    model_zip_path = f&#x27;./models/{model}&#x27;<br/>    <br/>    print(f&quot;- Saving {model} in local&quot;)<br/>    tokenizer.save_pretrained(tokenizer_path)<br/>    modelpt.save_pretrained(model_tf_path, saved_model=True, save_format=&#x27;tf&#x27;)            <br/>      <br/>    print(f&quot;- Adding vocab.txt&quot;)<br/>    vocab_pth = f&quot;{tokenizer_path}/vocab.txt&quot;<br/>    saved_model_pth = f&#x27;{model_tf_path}/saved_model/1/assets/vocab.txt&#x27;<br/>    copyfile(vocab_pth, saved_model_pth)    <br/>        <br/>    print(f&quot;- Creating and adding labels.txt&quot;)<br/>    labels = None<br/>    labels_path = f&#x27;{model_pt_path}/labels.txt&#x27;<br/>    with open(f&#x27;{model_pt_path}/config.json&#x27;, &#x27;r&#x27;) as f:<br/>        config = json.load(f)<br/>        if predefined_labels[i] is not None:<br/>            labels = list(predefined_labels[i])<br/>        else:<br/>            labels = config[&#x27;id2label&#x27;]<br/>            od = collections.OrderedDict(sorted(labels.items()))<br/>            labels = list(od.values())<br/>        if labels is None:<br/>            print(&quot;-- ERROR: predefined_labels are None and no &#x27;id2label&#x27; found in config.json. Skipping&quot;)<br/>            continue<br/>        with open(labels_path, &#x27;w&#x27;) as fw:<br/>            for i, l in enumerate(labels):<br/>                if i != 0:<br/>                    fw.write(&#x27;\n&#x27;)<br/>                fw.write(l)<br/>            print(f&quot;- Labels: {labels}&quot;)</span><span id="7a39" class="qg or gu qc b io qk qi l jd qj">labels_model_path = f&#x27;{model_tf_path}/saved_model/1/assets/labels.txt&#x27;<br/>    copyfile(labels_path, labels_model_path)<br/>    <br/>    print(&quot;- Importing into SparkNLP&quot;)<br/>    seq = BertForSequenceClassification.loadSavedModel(<br/>        f&#x27;{model_tf_path}/saved_model/1&#x27;,<br/>        spark)\<br/>    .setInputCols([&quot;token&quot;, &quot;sentence&quot;])\<br/>    .setOutputCol(&quot;label&quot;)\<br/>    .setCaseSensitive(True)<br/>    <br/>    print(&quot;- Saving the sparknlp model in disk&quot;)<br/>    seq.write().overwrite().save(model_sparknlp_path)<br/>    <br/>    print(&quot;- Zipping it to prepare it for Modelshub upload&quot;)<br/>    shutil.make_archive(model_zip_path, &#x27;zip&#x27;, model_sparknlp_path)</span><span id="ef61" class="qg or gu qc b io qk qi l jd qj">print(&quot;- Testing model in SparkNLP&quot;)<br/>    pipeline = Pipeline(stages = [<br/>        documentAssembler,<br/>        sentenceDetector,<br/>        spark_tokenizer,<br/>        seq])<br/>    <br/>    empty = spark.createDataFrame([[&#x27;&#x27;]]).toDF(&quot;text&quot;)<br/>    p_model = pipeline.fit(empty)<br/>    test_sentences = [&quot;&quot;&quot;What feature in your car did you not realize you had until someone else told you about it?<br/>Years ago, my Dad bought me a cute little VW Beetle. The first day I had it, me and my BFF were sitting in my car looking at everything.<br/>When we opened the center console, we had quite the scare. Inside was a hollowed out, plastic phallic looking object with tiny spikes on it.<br/>My friend and I literally screamed in horror. It was clear to us that somehow someone left their “toy” in my new car! We were shook, as they say.<br/>This was my car, I had to do something. So, I used a pen to pick up the nasty looking thing and threw it out.<br/>We freaked out about how gross it was and then we forgot about it… until my Dad called me.<br/>My Dad said: How’s the new car? Have you seen the flower holder in the center console?<br/>To summarize, we thought a flower vase was an XXX item…<br/>In our defense, this is a picture of a VW Beetle flower holder.  Camera - You are awarded a SiPix Digital Camera! call 09061221066 fromm landline.&quot;&quot;&quot;]<br/>    res = p_model.transform(spark.createDataFrame(pd.DataFrame({&#x27;text&#x27;: test_sentences})))</span><span id="ed64" class="qg or gu qc b io qk qi l jd qj">result_df = res.select(F.explode(F.arrays_zip(&quot;sentence.result&quot;,&quot;label.result&quot;)).alias(&quot;cols&quot;))\<br/>        .select(F.expr(&quot;cols[&#x27;0&#x27;]&quot;).alias(&quot;sentence&quot;),<br/>                F.expr(&quot;cols[&#x27;1&#x27;]&quot;).alias(&quot;label&quot;))</span><span id="ba89" class="qg or gu qc b io qk qi l jd qj">result_df.show(50, truncate=100)</span></pre><p id="8254" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Let’s see how our <strong class="my gv">mrm8488/bert-mini-finetuned-age_news-classification</strong> model classifies the topics of our sentences. using the predefined labels set by the author in Hugging Face:</p><figure class="nx ny nz oa ob oc nu nv paragraph-image"><div role="button" tabindex="0" class="od oe fj of bh og"><div class="nu nv qn"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*8idebnjUSWoDr3vjNhxf2g.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*8idebnjUSWoDr3vjNhxf2g.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*8idebnjUSWoDr3vjNhxf2g.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*8idebnjUSWoDr3vjNhxf2g.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*8idebnjUSWoDr3vjNhxf2g.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*8idebnjUSWoDr3vjNhxf2g.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8idebnjUSWoDr3vjNhxf2g.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*8idebnjUSWoDr3vjNhxf2g.png 640w, https://miro.medium.com/v2/resize:fit:720/1*8idebnjUSWoDr3vjNhxf2g.png 720w, https://miro.medium.com/v2/resize:fit:750/1*8idebnjUSWoDr3vjNhxf2g.png 750w, https://miro.medium.com/v2/resize:fit:786/1*8idebnjUSWoDr3vjNhxf2g.png 786w, https://miro.medium.com/v2/resize:fit:828/1*8idebnjUSWoDr3vjNhxf2g.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*8idebnjUSWoDr3vjNhxf2g.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*8idebnjUSWoDr3vjNhxf2g.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh md oh c" width="700" height="282" loading="lazy" role="presentation"/></picture></div></div></figure><p id="a442" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Now let’s take a look at the spam vs not spam model. The test was taken from a blog post, so it’s not spam. But we added a last spam sentence (<em class="qo">Camera — You are awardeda SiPix…</em>), to check if our spam model is able to detect it. These are the results of the iteration for the import of that model:</p><figure class="nx ny nz oa ob oc nu nv paragraph-image"><div role="button" tabindex="0" class="od oe fj of bh og"><div class="nu nv qp"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*Skz_rnd8yhw3aus8ugdWjw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*Skz_rnd8yhw3aus8ugdWjw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*Skz_rnd8yhw3aus8ugdWjw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*Skz_rnd8yhw3aus8ugdWjw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*Skz_rnd8yhw3aus8ugdWjw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*Skz_rnd8yhw3aus8ugdWjw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Skz_rnd8yhw3aus8ugdWjw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*Skz_rnd8yhw3aus8ugdWjw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*Skz_rnd8yhw3aus8ugdWjw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*Skz_rnd8yhw3aus8ugdWjw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*Skz_rnd8yhw3aus8ugdWjw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*Skz_rnd8yhw3aus8ugdWjw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*Skz_rnd8yhw3aus8ugdWjw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*Skz_rnd8yhw3aus8ugdWjw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh md oh c" width="700" height="283" loading="lazy" role="presentation"/></picture></div></div></figure><p id="dbd4" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">As we can see, the was correctly detected by our model, setting it to label <strong class="my gv">True</strong></p></div></div></div><div class="ab cb oi oj ok ol" role="separator"><span class="om by bm on oo op"></span><span class="om by bm on oo op"></span><span class="om by bm on oo"></span></div><div class="gn go gp gq gr"><div class="ab cb"><div class="ci bh fz ga gb gc"><h1 id="4d9e" class="oq or gu bf os ot ou ov ow ox oy oz pa pb pc pd pe pf pg ph pi pj pk pl pm pn bk">Links to reference notebooks</h1><p id="a044" class="pw-post-body-paragraph mw mx gu my b mz po nb nc nd pp nf ng nh pq nj nk nl pr nn no np ps nr ns nt gn bk">The Spark NLP team has prepared a github documentation page with information about the supported transformers in Spark NLP and one reference notebook for each of them. You can find it here: <a class="af ql" href="https://github.com/JohnSnowLabs/spark-nlp/discussions/5669" rel="noopener ugc nofollow" target="_blank">https://github.com/JohnSnowLabs/spark-nlp/discussions/5669</a></p></div></div></div><div class="ab cb oi oj ok ol" role="separator"><span class="om by bm on oo op"></span><span class="om by bm on oo op"></span><span class="om by bm on oo"></span></div><div class="gn go gp gq gr"><div class="ab cb"><div class="ci bh fz ga gb gc"><h1 id="bfcc" class="oq or gu bf os ot ou ov ow ox oy oz pa pb pc pd pe pf pg ph pi pj pk pl pm pn bk">Empower the Spark NLP community</h1><p id="fecf" class="pw-post-body-paragraph mw mx gu my b mz po nb nc nd pp nf ng nh pq nj nk nl pr nn no np ps nr ns nt gn bk">Feel free to upload your imported models into the Spark NLP Models Hub as showed above, so that everyone can leverage your work. Make an impact in the Open Source community!</p></div></div></div></div></section></div></div></article></div><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="qq qr ab ja"><div class="qs ab"><a class="qt ay am ao" rel="noopener follow" href="/tag/spark-nlp?source=post_page-----8c63bdea671d---------------spark_nlp-----------------"><div class="qu fj cx qv ge qw qx bf b bg z bk qy">Spark Nlp</div></a></div><div class="qs ab"><a class="qt ay am ao" rel="noopener follow" href="/tag/hugging-face?source=post_page-----8c63bdea671d---------------hugging_face-----------------"><div class="qu fj cx qv ge qw qx bf b bg z bk qy">Hugging Face</div></a></div><div class="qs ab"><a class="qt ay am ao" rel="noopener follow" href="/tag/nlp?source=post_page-----8c63bdea671d---------------nlp-----------------"><div class="qu fj cx qv ge qw qx bf b bg z bk qy">NLP</div></a></div><div class="qs ab"><a class="qt ay am ao" rel="noopener follow" href="/tag/deep-learning?source=post_page-----8c63bdea671d---------------deep_learning-----------------"><div class="qu fj cx qv ge qw qx bf b bg z bk qy">Deep Learning</div></a></div></div></div></div><div class="l"></div><footer class="qz ra rb rc rd re rf rg rh ab q ri ik c"><div class="l ae"><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="ab cp rj"><div class="ab q kv"><div class="rk l"><span class="l rl rm rn e d"><div class="ab q kv kw"><div class="pw-multi-vote-icon fj je kx ky kz"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerClapButton" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fspark-nlp%2F8c63bdea671d&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fspark-nlp%2Fimporting-huggingface-models-into-sparknlp-8c63bdea671d&amp;user=Juan+Martinez&amp;userId=e11aa5052863&amp;source=-----8c63bdea671d---------------------clap_footer-----------"><div><div class="bm" aria-hidden="false"><div class="la ao lb lc ld le am lf lg lh kz"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l li lj lk ll lm ln lo"><p class="bf b dv z du"><span class="lp">--</span></p></div></div></span><span class="l h g f ro rp"><div class="ab q kv kw"><div class="pw-multi-vote-icon fj je kx ky kz"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerClapButton" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fspark-nlp%2F8c63bdea671d&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fspark-nlp%2Fimporting-huggingface-models-into-sparknlp-8c63bdea671d&amp;user=Juan+Martinez&amp;userId=e11aa5052863&amp;source=-----8c63bdea671d---------------------clap_footer-----------"><div><div class="bm" aria-hidden="false"><div class="la ao lb lc ld le am lf lg lh kz"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l li lj lk ll lm ln lo"><p class="bf b dv z du"><span class="lp">--</span></p></div></div></span></div><div class="bq ab"><div><div class="bm" aria-hidden="false"><button class="ao la lq lr ab q fk ls lt" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="lu"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"></path></svg></button></div></div></div></div><div class="ab q"><div class="op l ix"><div><div class="bm" aria-hidden="false"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerBookmarkButton" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8c63bdea671d&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fspark-nlp%2Fimporting-huggingface-models-into-sparknlp-8c63bdea671d&amp;source=--------------------------bookmark_footer-----------"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="du lw" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></a></span></div></div></div><div class="op l ix"><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="footerSocialShareButton" class="af fk ah ai aj ak al me an ao ap ex mf mg lt mh"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"></path></svg></button></div></div></div></div></div></div></div></div></div></footer><div class="rq rr rs rt ru l bx"><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="cl ab rv cp"><div class="ab ia"><a rel="noopener follow" href="/@jjmcarrascosa?source=post_page-----8c63bdea671d--------------------------------"><div class="l rw rx by ry ie"><div class="l fj"><img alt="Juan Martinez" class="l fd by rz sa cx" src="https://miro.medium.com/v2/resize:fill:144:144/1*8hQ3UPHaKMqrUwADnkt7GA.jpeg" width="72" height="72" loading="lazy"/><div class="if by l rz sa fs n ig ft"></div></div></div></a><a href="https://medium.com/spark-nlp?source=post_page-----8c63bdea671d--------------------------------" rel="noopener follow"><div class="sb ab fj"><div><div class="bm" aria-hidden="false"><div class="l sc sd by ry ik"><div class="l fj"><img alt="spark-nlp" class="l fd by bz ca cx" src="https://miro.medium.com/v2/resize:fill:64:64/1*NM-W9Li1MU8zNvfTT2Opkw.jpeg" width="32" height="32" loading="lazy"/><div class="if by l bz ca fs n ig ft"></div></div></div></div></div></div></a></div><div class="j i d"><div class="ab"><span><button class="bf b bg z ep qu eq er es et eu ev ew ex ey ez fa au fb fc fd bm fe ff">Follow</button></span><div class="dt l"><div><div><div class="bm" aria-hidden="false"><div class="l"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F5126caea940&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fspark-nlp%2Fimporting-huggingface-models-into-sparknlp-8c63bdea671d&amp;newsletterV3=e11aa5052863&amp;newsletterV3Id=5126caea940&amp;user=Juan+Martinez&amp;userId=e11aa5052863&amp;source=-----8c63bdea671d---------------------subscribe_user-----------"><button class="bf b bg z sf am sg qf sh si sj sk sl sm ew ex ey ez fa fb fc fd bm fe ff" aria-label="Subscribe"><svg xmlns="http://www.w3.org/2000/svg" width="38" height="38" fill="none" viewBox="0 0 38 38" class="se sd sc"><rect width="0.5" height="6.5" x="26.25" y="9.25" rx="0.25"></rect><rect width="0.5" height="6.5" x="29.75" y="12.25" rx="0.25" transform="rotate(90 29.75 12.25)"></rect><path d="M19.5 12.5h-7a1 1 0 0 0-1 1v11a1 1 0 0 0 1 1h13a1 1 0 0 0 1-1v-5"></path><path d="M11.5 14.5 19 20l4-3"></path></svg></button></a></span></div></div></div></div></div></div></div></div><div class="ab cn cp"><div class="l"><div class="ab q"><a class="af ag ah ai aj ak al am an ao ap aq ar as at ab q" rel="noopener follow" href="/@jjmcarrascosa?source=post_page-----8c63bdea671d--------------------------------"><h2 class="pw-author-name bf sn so sp sq bk"><span class="gn jo">Written by <!-- -->Juan Martinez</span></h2></a></div><div class="qs ab"><div class="l ix"><span class="pw-follower-count bf b bg z bk"><a class="af ag ah ai aj ak al am an ao ap aq ar iq" rel="noopener follow" href="/@jjmcarrascosa/followers?source=post_page-----8c63bdea671d--------------------------------">601 Followers</a></span></div><div class="bf b bg z jf jg jh ab jj jk jl jm du jd"><span class="ir l" aria-hidden="true"><span class="bf b bg z du">·</span></span><span class="l ix">Writer for </span><div><div class="l" aria-hidden="false"><a class="af ag ah ai aj ak al am an ao ap aq ar iq ab q" href="https://medium.com/spark-nlp?source=post_page-----8c63bdea671d--------------------------------" rel="noopener follow"><p class="bf b bg z jf jg jh ji jj jk jl jm bk">spark-nlp</p></a></div></div></div></div><div class="sr l"><p class="bf b bg z bk"><span class="gn">AI and Video Games</span></p></div></div><div class="h k"><div class="ab"><span><button class="bf b bg z ep qu eq er es et eu ev ew ex ey ez fa au fb fc fd bm fe ff">Follow</button></span><div class="dt l"><div><div><div class="bm" aria-hidden="false"><div class="l"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F5126caea940&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fspark-nlp%2Fimporting-huggingface-models-into-sparknlp-8c63bdea671d&amp;newsletterV3=e11aa5052863&amp;newsletterV3Id=5126caea940&amp;user=Juan+Martinez&amp;userId=e11aa5052863&amp;source=-----8c63bdea671d---------------------subscribe_user-----------"><button class="bf b bg z sf am sg qf sh si sj sk sl sm ew ex ey ez fa fb fc fd bm fe ff" aria-label="Subscribe"><svg xmlns="http://www.w3.org/2000/svg" width="38" height="38" fill="none" viewBox="0 0 38 38" class="se sd sc"><rect width="0.5" height="6.5" x="26.25" y="9.25" rx="0.25"></rect><rect width="0.5" height="6.5" x="29.75" y="12.25" rx="0.25" transform="rotate(90 29.75 12.25)"></rect><path d="M19.5 12.5h-7a1 1 0 0 0-1 1v11a1 1 0 0 0 1 1h13a1 1 0 0 0 1-1v-5"></path><path d="M11.5 14.5 19 20l4-3"></path></svg></button></a></span></div></div></div></div></div></div></div></div><div class="ss bh st su sv sw sx sy"></div></div></div><div class="h k j"><div class="ss bh st sz"></div><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="ta ab kv ja"><div class="tb tc l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://help.medium.com/hc/en-us?source=post_page-----8c63bdea671d--------------------------------" rel="noopener follow"><p class="bf b dv z du">Help</p></a></div><div class="tb tc l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.statuspage.io/?source=post_page-----8c63bdea671d--------------------------------" rel="noopener follow"><p class="bf b dv z du">Status</p></a></div><div class="tb tc l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/about?autoplay=1&amp;source=post_page-----8c63bdea671d--------------------------------"><p class="bf b dv z du">About</p></a></div><div class="tb tc l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----8c63bdea671d--------------------------------"><p class="bf b dv z du">Careers</p></a></div><div class="tb tc l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="pressinquiries@medium.com?source=post_page-----8c63bdea671d--------------------------------" rel="noopener follow"><p class="bf b dv z du">Press</p></a></div><div class="tb tc l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://blog.medium.com/?source=post_page-----8c63bdea671d--------------------------------" rel="noopener follow"><p class="bf b dv z du">Blog</p></a></div><div class="tb tc l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----8c63bdea671d--------------------------------" rel="noopener follow"><p class="bf b dv z du">Privacy</p></a></div><div class="tb tc l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----8c63bdea671d--------------------------------" rel="noopener follow"><p class="bf b dv z du">Terms</p></a></div><div class="tb tc l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://speechify.com/medium?source=post_page-----8c63bdea671d--------------------------------" rel="noopener follow"><p class="bf b dv z du">Text to speech</p></a></div><div class="tb l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/business?source=post_page-----8c63bdea671d--------------------------------"><p class="bf b dv z du">Teams</p></a></div></div></div></div></div></div></div></div></div></div><script>window.__BUILD_ID__="main-20240820-153501-edc79d7a93"</script><script>window.__GRAPHQL_URI__ = "https://medium.com/_/graphql"</script><script>window.__PRELOADED_STATE__ = {"algolia":{"queries":{}},"cache":{"experimentGroupSet":true,"reason":"","group":"enabled","tags":["group-edgeCachePosts","post-8c63bdea671d","user-e11aa5052863","collection-81310c8f4868"],"serverVariantState":"44136fa355b3678a1146ad16f7e8649e94fb4fc21fe77e8310c060f61caaff8a","middlewareEnabled":true,"cacheStatus":"DYNAMIC","shouldUseCache":true,"vary":[],"lohpSummerUpsellEnabled":false,"lohpSummerDiscountTakeoverEnabled":false,"logoUpdatePhase3Enabled":false,"shouldIndexPostQueryEnabled":false},"client":{"hydrated":false,"isUs":false,"isNativeMedium":false,"isSafariMobile":false,"isSafari":false,"isFirefox":false,"routingEntity":{"type":"DEFAULT","explicit":false},"viewerIsBot":false},"debug":{"requestId":"b4bb4e82-2fca-44bd-800d-ad02da12de0a","hybridDevServices":[],"originalSpanCarrier":{}},"multiVote":{"clapsPerPost":{}},"navigation":{"branch":{"show":null,"hasRendered":null,"blockedByCTA":false},"hideGoogleOneTap":false,"hasRenderedAlternateUserBanner":null,"currentLocation":"https:\u002F\u002Fmedium.com\u002Fspark-nlp\u002Fimporting-huggingface-models-into-sparknlp-8c63bdea671d","host":"medium.com","hostname":"medium.com","referrer":"","hasSetReferrer":false,"susiModal":{"step":null,"operation":"register"},"postRead":false,"partnerProgram":{"selectedCountryCode":null},"queryString":"","currentHash":""},"config":{"nodeEnv":"production","version":"main-20240820-153501-edc79d7a93","target":"production","productName":"Medium","publicUrl":"https:\u002F\u002Fcdn-client.medium.com\u002Flite","authDomain":"medium.com","authGoogleClientId":"216296035834-k1k6qe060s2tp2a2jam4ljdcms00sttg.apps.googleusercontent.com","favicon":"production","glyphUrl":"https:\u002F\u002Fglyph.medium.com","branchKey":"key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm","algolia":{"appId":"MQ57UUUQZ2","apiKeySearch":"394474ced050e3911ae2249ecc774921","indexPrefix":"medium_","host":"-dsn.algolia.net"},"recaptchaKey":"6Lfc37IUAAAAAKGGtC6rLS13R1Hrw_BqADfS1LRk","recaptcha3Key":"6Lf8R9wUAAAAABMI_85Wb8melS7Zj6ziuf99Yot5","recaptchaEnterpriseKeyId":"6Le-uGgpAAAAAPprRaokM8AKthQ9KNGdoxaGUvVp","datadog":{"applicationId":"6702d87d-a7e0-42fe-bbcb-95b469547ea0","clientToken":"pub853ea8d17ad6821d9f8f11861d23dfed","rumToken":"pubf9cc52896502b9413b68ba36fc0c7162","context":{"deployment":{"target":"production","tag":"main-20240820-153501-edc79d7a93","commit":"edc79d7a930eb1b37e590d63fbcea72ded5266e9"}},"datacenter":"us"},"googleAnalyticsCode":"G-7JY7T788PK","googlePay":{"apiVersion":"2","apiVersionMinor":"0","merchantId":"BCR2DN6TV7EMTGBM","merchantName":"Medium","instanceMerchantId":"13685562959212738550"},"applePay":{"version":3},"signInWallCustomDomainCollectionIds":["3a8144eabfe3","336d898217ee","61061eb0c96b","138adf9c44c","819cc2aaeee0"],"mediumMastodonDomainName":"me.dm","mediumOwnedAndOperatedCollectionIds":["8a9336e5bb4","b7e45b22fec3","193b68bd4fba","8d6b8a439e32","54c98c43354d","3f6ecf56618","d944778ce714","92d2092dc598","ae2a65f35510","1285ba81cada","544c7006046e","fc8964313712","40187e704f1c","88d9857e584e","7b6769f2748b","bcc38c8f6edf","cef6983b292","cb8577c9149e","444d13b52878","713d7dbc99b0","ef8e90590e66","191186aaafa0","55760f21cdc5","9dc80918cc93","bdc4052bbdba","8ccfed20cbb2"],"tierOneDomains":["medium.com","thebolditalic.com","arcdigital.media","towardsdatascience.com","uxdesign.cc","codeburst.io","psiloveyou.xyz","writingcooperative.com","entrepreneurshandbook.co","prototypr.io","betterhumans.coach.me","theascent.pub"],"topicsToFollow":["d61cf867d93f","8a146bc21b28","1eca0103fff3","4d562ee63426","aef1078a3ef5","e15e46793f8d","6158eb913466","55f1c20aba7a","3d18b94f6858","4861fee224fd","63c6f1f93ee","1d98b3a9a871","decb52b64abf","ae5d4995e225","830cded25262"],"topicToTagMappings":{"accessibility":"accessibility","addiction":"addiction","android-development":"android-development","art":"art","artificial-intelligence":"artificial-intelligence","astrology":"astrology","basic-income":"basic-income","beauty":"beauty","biotech":"biotech","blockchain":"blockchain","books":"books","business":"business","cannabis":"cannabis","cities":"cities","climate-change":"climate-change","comics":"comics","coronavirus":"coronavirus","creativity":"creativity","cryptocurrency":"cryptocurrency","culture":"culture","cybersecurity":"cybersecurity","data-science":"data-science","design":"design","digital-life":"digital-life","disability":"disability","economy":"economy","education":"education","equality":"equality","family":"family","feminism":"feminism","fiction":"fiction","film":"film","fitness":"fitness","food":"food","freelancing":"freelancing","future":"future","gadgets":"gadgets","gaming":"gaming","gun-control":"gun-control","health":"health","history":"history","humor":"humor","immigration":"immigration","ios-development":"ios-development","javascript":"javascript","justice":"justice","language":"language","leadership":"leadership","lgbtqia":"lgbtqia","lifestyle":"lifestyle","machine-learning":"machine-learning","makers":"makers","marketing":"marketing","math":"math","media":"media","mental-health":"mental-health","mindfulness":"mindfulness","money":"money","music":"music","neuroscience":"neuroscience","nonfiction":"nonfiction","outdoors":"outdoors","parenting":"parenting","pets":"pets","philosophy":"philosophy","photography":"photography","podcasts":"podcast","poetry":"poetry","politics":"politics","privacy":"privacy","product-management":"product-management","productivity":"productivity","programming":"programming","psychedelics":"psychedelics","psychology":"psychology","race":"race","relationships":"relationships","religion":"religion","remote-work":"remote-work","san-francisco":"san-francisco","science":"science","self":"self","self-driving-cars":"self-driving-cars","sexuality":"sexuality","social-media":"social-media","society":"society","software-engineering":"software-engineering","space":"space","spirituality":"spirituality","sports":"sports","startups":"startup","style":"style","technology":"technology","transportation":"transportation","travel":"travel","true-crime":"true-crime","tv":"tv","ux":"ux","venture-capital":"venture-capital","visual-design":"visual-design","work":"work","world":"world","writing":"writing"},"defaultImages":{"avatar":{"imageId":"1*dmbNkD5D-u45r44go_cf0g.png","height":150,"width":150},"orgLogo":{"imageId":"7*V1_7XP4snlmqrc_0Njontw.png","height":110,"width":500},"postLogo":{"imageId":"bd978bb536350a710e8efb012513429cabdc4c28700604261aeda246d0f980b7","height":810,"width":1440},"postPreviewImage":{"imageId":"1*hn4v1tCaJy7cWMyb0bpNpQ.png","height":386,"width":579}},"collectionStructuredData":{"8d6b8a439e32":{"name":"Elemental","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F980\u002F1*9ygdqoKprhwuTVKUM0DLPA@2x.png","width":980,"height":159}}},"3f6ecf56618":{"name":"Forge","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F596\u002F1*uULpIlImcO5TDuBZ6lm7Lg@2x.png","width":596,"height":183}}},"ae2a65f35510":{"name":"GEN","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F264\u002F1*RdVZMdvfV3YiZTw6mX7yWA.png","width":264,"height":140}}},"88d9857e584e":{"name":"LEVEL","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*JqYMhNX6KNNb2UlqGqO2WQ.png","width":540,"height":108}}},"7b6769f2748b":{"name":"Marker","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F383\u002F1*haCUs0wF6TgOOvfoY-jEoQ@2x.png","width":383,"height":92}}},"444d13b52878":{"name":"OneZero","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*cw32fIqCbRWzwJaoQw6BUg.png","width":540,"height":123}}},"8ccfed20cbb2":{"name":"Zora","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*tZUQqRcCCZDXjjiZ4bDvgQ.png","width":540,"height":106}}}},"embeddedPostIds":{"coronavirus":"cd3010f9d81f"},"sharedCdcMessaging":{"COVID_APPLICABLE_TAG_SLUGS":[],"COVID_APPLICABLE_TOPIC_NAMES":[],"COVID_APPLICABLE_TOPIC_NAMES_FOR_TOPIC_PAGE":[],"COVID_MESSAGES":{"tierA":{"text":"For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":66,"end":73,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"tierB":{"text":"Anyone can publish on Medium per our Policies, but we don’t fact-check every story. For more info about the coronavirus, see cdc.gov.","markups":[{"start":37,"end":45,"href":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Fcategories\u002F201931128-Policies-Safety"},{"start":125,"end":132,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"paywall":{"text":"This article has been made free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":56,"end":70,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":138,"end":145,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"unbound":{"text":"This article is free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":45,"end":59,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":127,"end":134,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]}},"COVID_BANNER_POST_ID_OVERRIDE_WHITELIST":["3b31a67bff4a"]},"sharedVoteMessaging":{"TAGS":["politics","election-2020","government","us-politics","election","2020-presidential-race","trump","donald-trump","democrats","republicans","congress","republican-party","democratic-party","biden","joe-biden","maga"],"TOPICS":["politics","election"],"MESSAGE":{"text":"Find out more about the U.S. election results here.","markups":[{"start":46,"end":50,"href":"https:\u002F\u002Fcookpolitical.com\u002F2020-national-popular-vote-tracker"}]},"EXCLUDE_POSTS":["397ef29e3ca5"]},"embedPostRules":[],"recircOptions":{"v1":{"limit":3},"v2":{"limit":8}},"braintreeClientKey":"production_zjkj96jm_m56f8fqpf7ngnrd4","braintree":{"enabled":true,"merchantId":"m56f8fqpf7ngnrd4","merchantAccountId":{"usd":"AMediumCorporation_instant","eur":"amediumcorporation_EUR","cad":"amediumcorporation_CAD"},"publicKey":"ds2nn34bg2z7j5gd","braintreeEnvironment":"production","dashboardUrl":"https:\u002F\u002Fwww.braintreegateway.com\u002Fmerchants","gracePeriodDurationInDays":14,"mediumMembershipPlanId":{"monthly":"ce105f8c57a3","monthlyV2":"e8a5e126-792b-4ee6-8fba-d574c1b02fc5","monthlyWithTrial":"d5ee3dbe3db8","monthlyPremium":"fa741a9b47a2","yearly":"a40ad4a43185","yearlyV2":"3815d7d6-b8ca-4224-9b8c-182f9047866e","yearlyStaff":"d74fb811198a","yearlyWithTrial":"b3bc7350e5c7","yearlyPremium":"e21bd2c12166","monthlyOneYearFree":"e6c0637a-2bad-4171-ab4f-3c268633d83c","monthly25PercentOffFirstYear":"235ecc62-0cdb-49ae-9378-726cd21c504b","monthly20PercentOffFirstYear":"ba518864-9c13-4a99-91ca-411bf0cac756","monthly15PercentOffFirstYear":"594c029b-9f89-43d5-88f8-8173af4e070e","monthly10PercentOffFirstYear":"c6c7bc9a-40f2-4b51-8126-e28511d5bdb0","monthlyForStudents":"629ebe51-da7d-41fd-8293-34cd2f2030a8","yearlyOneYearFree":"78ba7be9-0d9f-4ece-aa3e-b54b826f2bf1","yearly25PercentOffFirstYear":"2dbb010d-bb8f-4eeb-ad5c-a08509f42d34","yearly20PercentOffFirstYear":"47565488-435b-47f8-bf93-40d5fbe0ebc8","yearly15PercentOffFirstYear":"8259809b-0881-47d9-acf7-6c001c7f720f","yearly10PercentOffFirstYear":"9dd694fb-96e1-472c-8d9e-3c868d5c1506","yearlyForStudents":"e29345ef-ab1c-4234-95c5-70e50fe6bc23","monthlyCad":"p52orjkaceei","yearlyCad":"h4q9g2up9ktt"},"braintreeDiscountId":{"oneMonthFree":"MONTHS_FREE_01","threeMonthsFree":"MONTHS_FREE_03","sixMonthsFree":"MONTHS_FREE_06","fiftyPercentOffOneYear":"FIFTY_PERCENT_OFF_ONE_YEAR"},"3DSecureVersion":"2","defaultCurrency":"usd","providerPlanIdCurrency":{"4ycw":"usd","rz3b":"usd","3kqm":"usd","jzw6":"usd","c2q2":"usd","nnsw":"usd","q8qw":"usd","d9y6":"usd","fx7w":"cad","nwf2":"cad"}},"paypalClientId":"AXj1G4fotC2GE8KzWX9mSxCH1wmPE3nJglf4Z2ig_amnhvlMVX87otaq58niAg9iuLktVNF_1WCMnN7v","paypal":{"host":"https:\u002F\u002Fapi.paypal.com:443","clientMode":"production","serverMode":"live","webhookId":"4G466076A0294510S","monthlyPlan":{"planId":"P-9WR0658853113943TMU5FDQA","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlan":{"planId":"P-7N8963881P8875835MU5JOPQ","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oneYearGift":{"name":"Medium Membership (1 Year, Digital Gift Code)","description":"Unlimited access to the best and brightest stories on Medium. Gift codes can be redeemed at medium.com\u002Fredeem.","price":"50.00","currency":"USD","sku":"membership-gift-1-yr"},"oldMonthlyPlan":{"planId":"P-96U02458LM656772MJZUVH2Y","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlan":{"planId":"P-59P80963JF186412JJZU3SMI","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"monthlyPlanWithTrial":{"planId":"P-66C21969LR178604GJPVKUKY","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlanWithTrial":{"planId":"P-6XW32684EX226940VKCT2MFA","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oldMonthlyPlanNoSetupFee":{"planId":"P-4N046520HR188054PCJC7LJI","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlanNoSetupFee":{"planId":"P-7A4913502Y5181304CJEJMXQ","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"sdkUrl":"https:\u002F\u002Fwww.paypal.com\u002Fsdk\u002Fjs"},"stripePublishableKey":"pk_live_7FReX44VnNIInZwrIIx6ghjl","log":{"json":true,"level":"info"},"imageUploadMaxSizeMb":25,"staffPicks":{"title":"Staff Picks","catalogId":"c7bc6e1ee00f"}},"session":{"xsrf":""}}</script><script>window.__APOLLO_STATE__ = {"ROOT_QUERY":{"__typename":"Query","viewer":null,"collectionByDomainOrSlug({\"domainOrSlug\":\"spark-nlp\"})":{"__ref":"Collection:81310c8f4868"},"postResult({\"id\":\"8c63bdea671d\"})":{"__ref":"Post:8c63bdea671d"}},"ImageMetadata:":{"__typename":"ImageMetadata","id":""},"Collection:81310c8f4868":{"__typename":"Collection","id":"81310c8f4868","favicon":{"__ref":"ImageMetadata:"},"customStyleSheet":{"__ref":"CustomStyleSheet:8948cfcdc8bd"},"colorPalette":{"__typename":"ColorPalette","highlightSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FFFFFFFF","colorPoints":[{"__typename":"ColorPoint","color":"#FFFFFFFF","point":0},{"__typename":"ColorPoint","color":"#FFE8F3E8","point":0.1},{"__typename":"ColorPoint","color":"#FFE8F3E8","point":0.2},{"__typename":"ColorPoint","color":"#FFD1E7D1","point":0.6},{"__typename":"ColorPoint","color":"#FFA3D0A2","point":1}]},"defaultBackgroundSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FFFFFFFF","colorPoints":[{"__typename":"ColorPoint","color":"#FF1A8917","point":0},{"__typename":"ColorPoint","color":"#FF11800E","point":0.1},{"__typename":"ColorPoint","color":"#FF0F730C","point":0.2},{"__typename":"ColorPoint","color":"#FF095407","point":1}]},"tintBackgroundSpectrum":null},"googleAnalyticsId":null,"editors":[{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:fe4b780b61e1"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:97741bccbc0e"}}],"name":"spark-nlp","avatar":{"__ref":"ImageMetadata:1*NM-W9Li1MU8zNvfTT2Opkw.jpeg"},"domain":null,"slug":"spark-nlp","description":"Natural Language Understanding Library for Apache Spark.","subscriberCount":668,"viewerEdge":{"__ref":"CollectionViewerEdge:collectionId:81310c8f4868-viewerId:lo_08ed06595df6"},"twitterUsername":"johnsnowlabs","facebookPageId":null,"logo":{"__ref":"ImageMetadata:1*yt4eNSte8veSTOh0spY9EQ.png"}},"CustomStyleSheet:8948cfcdc8bd":{"__typename":"CustomStyleSheet","id":"8948cfcdc8bd","global":{"__typename":"GlobalStyles","colorPalette":{"__typename":"StyleSheetColorPalette","primary":{"__typename":"ColorValue","colorPalette":{"__typename":"ColorPalette","highlightSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FFFFFFFF","colorPoints":[{"__typename":"ColorPoint","color":"#FFE6F5FF","point":0},{"__typename":"ColorPoint","color":"#FFE1F4FF","point":0.1},{"__typename":"ColorPoint","color":"#FFDCF3FF","point":0.2},{"__typename":"ColorPoint","color":"#FFD7F1FF","point":0.3},{"__typename":"ColorPoint","color":"#FFD2F0FF","point":0.4},{"__typename":"ColorPoint","color":"#FFCDEFFF","point":0.5},{"__typename":"ColorPoint","color":"#FFC7EEFF","point":0.6},{"__typename":"ColorPoint","color":"#FFC2ECFF","point":0.7},{"__typename":"ColorPoint","color":"#FFBCEBFF","point":0.8},{"__typename":"ColorPoint","color":"#FFB6EAFF","point":0.9},{"__typename":"ColorPoint","color":"#FFB0E8FF","point":1}]},"defaultBackgroundSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FFFFFFFF","colorPoints":[{"__typename":"ColorPoint","color":"#FF3C8DCF","point":0},{"__typename":"ColorPoint","color":"#FF3C83BE","point":0.1},{"__typename":"ColorPoint","color":"#FF3B79AD","point":0.2},{"__typename":"ColorPoint","color":"#FF396F9C","point":0.3},{"__typename":"ColorPoint","color":"#FF37648B","point":0.4},{"__typename":"ColorPoint","color":"#FF33597A","point":0.5},{"__typename":"ColorPoint","color":"#FF2E4E6A","point":0.6},{"__typename":"ColorPoint","color":"#FF294259","point":0.7},{"__typename":"ColorPoint","color":"#FF223648","point":0.8},{"__typename":"ColorPoint","color":"#FF1B2937","point":0.9},{"__typename":"ColorPoint","color":"#FF111B25","point":1}]},"tintBackgroundSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FF1e77b7","colorPoints":[{"__typename":"ColorPoint","color":"#FF1E77B7","point":0},{"__typename":"ColorPoint","color":"#FF4087C1","point":0.1},{"__typename":"ColorPoint","color":"#FF5A96CB","point":0.2},{"__typename":"ColorPoint","color":"#FF71A5D5","point":0.3},{"__typename":"ColorPoint","color":"#FF86B3DE","point":0.4},{"__typename":"ColorPoint","color":"#FF9AC1E7","point":0.5},{"__typename":"ColorPoint","color":"#FFADCEEF","point":0.6},{"__typename":"ColorPoint","color":"#FFC0DBF7","point":0.7},{"__typename":"ColorPoint","color":"#FFD2E8FF","point":0.8},{"__typename":"ColorPoint","color":"#FFE4F5FF","point":0.9},{"__typename":"ColorPoint","color":"#FFF5FFFF","point":1}]}}},"background":null},"fonts":{"__typename":"StyleSheetFonts","font1":{"__typename":"StyleSheetFont","name":"SANS_SERIF_1"},"font2":{"__typename":"StyleSheetFont","name":"SANS_SERIF_1"},"font3":{"__typename":"StyleSheetFont","name":"SERIF_2"}}},"header":{"__typename":"HeaderStyles","backgroundImage":null}},"User:fe4b780b61e1":{"__typename":"User","id":"fe4b780b61e1"},"User:97741bccbc0e":{"__typename":"User","id":"97741bccbc0e"},"ImageMetadata:1*NM-W9Li1MU8zNvfTT2Opkw.jpeg":{"__typename":"ImageMetadata","id":"1*NM-W9Li1MU8zNvfTT2Opkw.jpeg"},"LinkedAccounts:e11aa5052863":{"__typename":"LinkedAccounts","mastodon":null,"id":"e11aa5052863"},"UserViewerEdge:userId:e11aa5052863-viewerId:lo_08ed06595df6":{"__typename":"UserViewerEdge","id":"userId:e11aa5052863-viewerId:lo_08ed06595df6","isFollowing":false,"isUser":false,"isMuting":false},"NewsletterV3:5126caea940":{"__typename":"NewsletterV3","id":"5126caea940","type":"NEWSLETTER_TYPE_AUTHOR","slug":"e11aa5052863","name":"e11aa5052863","collection":null,"user":{"__ref":"User:e11aa5052863"}},"User:e11aa5052863":{"__typename":"User","id":"e11aa5052863","name":"Juan Martinez","username":"jjmcarrascosa","newsletterV3":{"__ref":"NewsletterV3:5126caea940"},"linkedAccounts":{"__ref":"LinkedAccounts:e11aa5052863"},"isSuspended":false,"imageId":"1*8hQ3UPHaKMqrUwADnkt7GA.jpeg","mediumMemberAt":0,"verifications":{"__typename":"VerifiedInfo","isBookAuthor":false},"socialStats":{"__typename":"SocialStats","followerCount":601},"customDomainState":null,"hasSubdomain":false,"bio":"AI and Video Games","isPartnerProgramEnrolled":false,"viewerEdge":{"__ref":"UserViewerEdge:userId:e11aa5052863-viewerId:lo_08ed06595df6"},"viewerIsUser":false,"postSubscribeMembershipUpsellShownAt":0,"allowNotes":true,"twitterScreenName":"","membership":null},"Topic:1eca0103fff3":{"__typename":"Topic","slug":"machine-learning","id":"1eca0103fff3","name":"Machine Learning"},"Paragraph:8fab244d90bc_0":{"__typename":"Paragraph","id":"8fab244d90bc_0","name":"40ca","type":"H3","href":null,"layout":null,"metadata":null,"text":"Importing Hugging Face models into Spark NLP","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8fab244d90bc_1":{"__typename":"Paragraph","id":"8fab244d90bc_1","name":"b7d5","type":"P","href":null,"layout":null,"metadata":null,"text":"In this article we are going to show two examples of how to import Hugging Face embeddings models into Spark NLP, and another example showcasing a bulk importing of 7 BertForSequenceClassification models.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8fab244d90bc_2":{"__typename":"Paragraph","id":"8fab244d90bc_2","name":"47fd","type":"P","href":null,"layout":null,"metadata":null,"text":"In addition to that, a link to the several different notebooks for importing different transformers architectures and task types is also included.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*QXxM-kx3t90crs0q0WjzuA.png":{"__typename":"ImageMetadata","id":"1*QXxM-kx3t90crs0q0WjzuA.png","originalHeight":151,"originalWidth":717,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:8fab244d90bc_3":{"__typename":"Paragraph","id":"8fab244d90bc_3","name":"8db2","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*QXxM-kx3t90crs0q0WjzuA.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8fab244d90bc_4":{"__typename":"Paragraph","id":"8fab244d90bc_4","name":"7836","type":"H3","href":null,"layout":null,"metadata":null,"text":"1. Importing a RobertaEmbeddings model","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8fab244d90bc_5":{"__typename":"Paragraph","id":"8fab244d90bc_5","name":"6d21","type":"P","href":null,"layout":null,"metadata":null,"text":"Importing a Embeddings model from Hugging Face is very simple. You only need 4 basic steps:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8fab244d90bc_6":{"__typename":"Paragraph","id":"8fab244d90bc_6","name":"21d6","type":"OLI","href":null,"layout":null,"metadata":null,"text":"Importing Hugging Face and Spark NLP libraries and starting a session;","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8fab244d90bc_7":{"__typename":"Paragraph","id":"8fab244d90bc_7","name":"f71e","type":"OLI","href":null,"layout":null,"metadata":null,"text":"Using a AutoTokenizer and AutoModelForMaskedLM to download the tokenizer and the model from Hugging Face hub;","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8fab244d90bc_8":{"__typename":"Paragraph","id":"8fab244d90bc_8","name":"d9f6","type":"OLI","href":null,"layout":null,"metadata":null,"text":"Saving the model in TensorFlow format;","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8fab244d90bc_9":{"__typename":"Paragraph","id":"8fab244d90bc_9","name":"1b0a","type":"OLI","href":null,"layout":null,"metadata":null,"text":"Load the model into Spark NLP using the proper architecture.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8fab244d90bc_10":{"__typename":"Paragraph","id":"8fab244d90bc_10","name":"35be","type":"P","href":null,"layout":null,"metadata":null,"text":"Let’s see step by step the process.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8fab244d90bc_11":{"__typename":"Paragraph","id":"8fab244d90bc_11","name":"2b70","type":"H3","href":null,"layout":null,"metadata":null,"text":"1.1. Importing the libraries and starting a session","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8fab244d90bc_12":{"__typename":"Paragraph","id":"8fab244d90bc_12","name":"6cb2","type":"P","href":null,"layout":null,"metadata":null,"text":"First, we are going to need the transformers library (from Hugging Face), more specifically we are going to use AutoTokenizer and AutoModelForMaskedLM for downloading the model, and then TFRobertaModel from loading it from disk one downloaded. We are going to need tensorflow as well.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":112,"end":126,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":130,"end":151,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":187,"end":202,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":265,"end":276,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8fab244d90bc_13":{"__typename":"Paragraph","id":"8fab244d90bc_13","name":"23af","type":"P","href":null,"layout":null,"metadata":null,"text":"In case you don’t have them installed in your environment, run first:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8fab244d90bc_14":{"__typename":"Paragraph","id":"8fab244d90bc_14","name":"c1c3","type":"PRE","href":null,"layout":null,"metadata":null,"text":"!pip install -q transformers==4.6.1 tensorflow==2.4.1","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8fab244d90bc_15":{"__typename":"Paragraph","id":"8fab244d90bc_15","name":"430e","type":"P","href":null,"layout":null,"metadata":null,"text":"Afterwards, import the libraries:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8fab244d90bc_16":{"__typename":"Paragraph","id":"8fab244d90bc_16","name":"ef95","type":"PRE","href":null,"layout":null,"metadata":null,"text":"import transformers\nfrom transformers import TFRobertaModel\nfrom transformers import AutoTokenizer, AutoModelForMaskedLM","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8fab244d90bc_17":{"__typename":"Paragraph","id":"8fab244d90bc_17","name":"cdb7","type":"PRE","href":null,"layout":null,"metadata":null,"text":"import tensorflow","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8fab244d90bc_18":{"__typename":"Paragraph","id":"8fab244d90bc_18","name":"5f0e","type":"P","href":null,"layout":null,"metadata":null,"text":"Let’s add also some generic libraries for file management:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8fab244d90bc_19":{"__typename":"Paragraph","id":"8fab244d90bc_19","name":"4925","type":"PRE","href":null,"layout":null,"metadata":null,"text":"import json\nimport os\nimport shutil","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8fab244d90bc_20":{"__typename":"Paragraph","id":"8fab244d90bc_20","name":"ce47","type":"P","href":null,"layout":null,"metadata":null,"text":"And last, but not lest, let’s add sparknlp and pyspark libraries. In case you don’t have Spark NLP installed, please refer to https:\u002F\u002Fnlp.johnsnowlabs.com\u002Fdocs\u002Fen\u002Finstall to see installation instructions. For Google Colab, it’s as easy as running the following line:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":126,"end":170,"href":"https:\u002F\u002Fnlp.johnsnowlabs.com\u002Fdocs\u002Fen\u002Finstall","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":34,"end":42,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":47,"end":54,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8fab244d90bc_21":{"__typename":"Paragraph","id":"8fab244d90bc_21","name":"968d","type":"PRE","href":null,"layout":null,"metadata":null,"text":"! wget http:\u002F\u002Fsetup.johnsnowlabs.com\u002Fcolab.sh -O - | bash","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8fab244d90bc_22":{"__typename":"Paragraph","id":"8fab244d90bc_22","name":"7e88","type":"P","href":null,"layout":null,"metadata":null,"text":"Then, both PySpark and Spark NLP will be installed, so you can import the libraries…","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8fab244d90bc_23":{"__typename":"Paragraph","id":"8fab244d90bc_23","name":"c138","type":"PRE","href":null,"layout":null,"metadata":null,"text":"import sparknlp\nfrom sparknlp.base import *\nfrom sparknlp.annotator import *\nfrom sparknlp.annotator import *","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8fab244d90bc_24":{"__typename":"Paragraph","id":"8fab244d90bc_24","name":"b6ac","type":"PRE","href":null,"layout":null,"metadata":null,"text":"from pyspark.ml import Pipeline\nfrom pyspark.sql import SparkSession","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8fab244d90bc_25":{"__typename":"Paragraph","id":"8fab244d90bc_25","name":"57d7","type":"P","href":null,"layout":null,"metadata":null,"text":"… and start a session…","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8fab244d90bc_26":{"__typename":"Paragraph","id":"8fab244d90bc_26","name":"5911","type":"PRE","href":null,"layout":null,"metadata":null,"text":"import sparknlp\nspark = sparknlp.start()","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8fab244d90bc_27":{"__typename":"Paragraph","id":"8fab244d90bc_27","name":"ba00","type":"H3","href":null,"layout":null,"metadata":null,"text":"1.2. Using a AutoTokenizer and AutoModelForMaskedLM","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8fab244d90bc_28":{"__typename":"Paragraph","id":"8fab244d90bc_28","name":"b4ed","type":"P","href":null,"layout":null,"metadata":null,"text":"HuggingFace API serves two generic classes to load models without needing to set which transformer architecture or tokenizer they are: AutoTokenizer and, for the case of embeddings, AutoModelForMaskedLM.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":135,"end":148,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":182,"end":202,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8fab244d90bc_29":{"__typename":"Paragraph","id":"8fab244d90bc_29","name":"d77e","type":"P","href":null,"layout":null,"metadata":null,"text":"Let’s suppose we want to import roberta-base-biomedical-es, a Clinical Spanish Roberta Embeddings model. I’ve found it in Hugging Face hub, available at https:\u002F\u002Fhuggingface.co\u002Fmodels.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":153,"end":182,"href":"https:\u002F\u002Fhuggingface.co\u002Fmodels","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":32,"end":58,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8fab244d90bc_30":{"__typename":"Paragraph","id":"8fab244d90bc_30","name":"bef7","type":"P","href":null,"layout":null,"metadata":null,"text":"Let’s import both tokenizer and model using the classes described above:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8fab244d90bc_31":{"__typename":"Paragraph","id":"8fab244d90bc_31","name":"2b0e","type":"PRE","href":null,"layout":null,"metadata":null,"text":"tokenizer = AutoTokenizer.from_pretrained(\"PlanTL-GOB-ES\u002Froberta-base-biomedical-es\")","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8fab244d90bc_32":{"__typename":"Paragraph","id":"8fab244d90bc_32","name":"ec5a","type":"PRE","href":null,"layout":null,"metadata":null,"text":"model = AutoModelForMaskedLM.from_pretrained(\"PlanTL-GOB-ES\u002Froberta-base-biomedical-es\")","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8fab244d90bc_33":{"__typename":"Paragraph","id":"8fab244d90bc_33","name":"b09f","type":"H3","href":null,"layout":null,"metadata":null,"text":"1.3. Saving the model in TensorFlow format","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8fab244d90bc_34":{"__typename":"Paragraph","id":"8fab244d90bc_34","name":"519e","type":"P","href":null,"layout":null,"metadata":null,"text":"Models in HuggingFace can be, among others, in PyTorch or TensorFlow format.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8fab244d90bc_35":{"__typename":"Paragraph","id":"8fab244d90bc_35","name":"95d4","type":"PRE","href":null,"layout":null,"metadata":null,"text":"MODEL_NAME_TF='my_model_tf' # Change me","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8fab244d90bc_36":{"__typename":"Paragraph","id":"8fab244d90bc_36","name":"d89e","type":"PRE","href":null,"layout":null,"metadata":null,"text":"tokenizer.save_pretrained(f'.\u002FMODEL_NAME_TF}_tokenizer\u002F')\nmodel.save_pretrained(f'.\u002F{MODEL_NAME_TF}', saved_model=True, save_format='tf')","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8fab244d90bc_37":{"__typename":"Paragraph","id":"8fab244d90bc_37","name":"d2f2","type":"P","href":null,"layout":null,"metadata":null,"text":"In this case, save_format=’tf’ was set because the model was originally in PyTorch format. That would not be necessary if the model is originally in TensorFlow\u002FKeras.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":14,"end":30,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":75,"end":83,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8fab244d90bc_38":{"__typename":"Paragraph","id":"8fab244d90bc_38","name":"4563","type":"P","href":null,"layout":null,"metadata":null,"text":"At this point, you can check the model can be loaded by HuggingFace TensorFlow specific classes by doing this:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8fab244d90bc_39":{"__typename":"Paragraph","id":"8fab244d90bc_39","name":"f068","type":"PRE","href":null,"layout":null,"metadata":null,"text":"loaded_model = TFRobertaModel.from_pretrained(f'.\u002F{MODEL_NAME_TF}')","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8fab244d90bc_40":{"__typename":"Paragraph","id":"8fab244d90bc_40","name":"1594","type":"P","href":null,"layout":null,"metadata":null,"text":"After saving the model, you also need to add the vocab.txt file to the assets directory of the saved model. You can achieve that by doing:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":49,"end":59,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8fab244d90bc_41":{"__typename":"Paragraph","id":"8fab244d90bc_41","name":"b271","type":"PRE","href":null,"layout":null,"metadata":null,"text":"vocab_pth = f\".\u002F{MODEL_NAME_TF}_tokenizer\u002Fvocab.txt\"\nsaved_model_pth = f'.\u002F{MODEL_NAME_TF}\u002Fsaved_model\u002F1\u002Fassets\u002F'","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8fab244d90bc_42":{"__typename":"Paragraph","id":"8fab244d90bc_42","name":"9850","type":"PRE","href":null,"layout":null,"metadata":null,"text":"!cp $vocab_pth $saved_model_pth","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8fab244d90bc_43":{"__typename":"Paragraph","id":"8fab244d90bc_43","name":"4116","type":"P","href":null,"layout":null,"metadata":null,"text":"Sometimes, instead of a vocab.txt file, a vocab.json may be found. If that is the case, execute the following code before you copy the file with the cp command above:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":24,"end":33,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":42,"end":52,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":149,"end":152,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8fab244d90bc_44":{"__typename":"Paragraph","id":"8fab244d90bc_44","name":"5938","type":"PRE","href":null,"layout":null,"metadata":null,"text":"with open(f'.\u002F{MODEL_NAME_TF}_tokenizer\u002Fvocab.json', 'r') as f:\n    data = json.load(f)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8fab244d90bc_45":{"__typename":"Paragraph","id":"8fab244d90bc_45","name":"c0c0","type":"PRE","href":null,"layout":null,"metadata":null,"text":"with open(f'.\u002F{MODEL_NAME_TF}_tokenizer\u002Fvocab.txt', 'w') as f:\n    for d in data.keys():\n        f.write(d)\n        f.write('\\n')","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8fab244d90bc_46":{"__typename":"Paragraph","id":"8fab244d90bc_46","name":"05ec","type":"P","href":null,"layout":null,"metadata":null,"text":"Last, but not least, copy also the merges.txt file the same way:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8fab244d90bc_47":{"__typename":"Paragraph","id":"8fab244d90bc_47","name":"c96c","type":"PRE","href":null,"layout":null,"metadata":null,"text":"merges_pth = f\".\u002F{MODEL_NAME_TF}_tokenizer\u002Fmerges.txt\"\nsaved_model_pth = f'.\u002F{MODEL_NAME_TF}\u002Fsaved_model\u002F1\u002Fassets\u002F'","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8fab244d90bc_48":{"__typename":"Paragraph","id":"8fab244d90bc_48","name":"ec46","type":"PRE","href":null,"layout":null,"metadata":null,"text":"!cp $merges_pth $saved_model_pth","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8fab244d90bc_49":{"__typename":"Paragraph","id":"8fab244d90bc_49","name":"b1a3","type":"H3","href":null,"layout":null,"metadata":null,"text":"1.4. Load the model into Spark NLP using the proper architecture.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8fab244d90bc_50":{"__typename":"Paragraph","id":"8fab244d90bc_50","name":"4049","type":"P","href":null,"layout":null,"metadata":null,"text":"With the model ready, let’s just import it into Spark NLP using the RoBertaEmbeddings class.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":68,"end":86,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8fab244d90bc_51":{"__typename":"Paragraph","id":"8fab244d90bc_51","name":"9097","type":"PRE","href":null,"layout":null,"metadata":null,"text":"embeddings = RoBertaEmbeddings.loadSavedModel(f'.\u002F{MODEL_NAME_TF}\u002Fsaved_model\u002F1',spark).setInputCols([\"document\",'token']).setOutputCol(\"embeddings\")","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8fab244d90bc_52":{"__typename":"Paragraph","id":"8fab244d90bc_52","name":"f33e","type":"P","href":null,"layout":null,"metadata":null,"text":"Now, let’s save to disk the Spark NLP version of the model:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8fab244d90bc_53":{"__typename":"Paragraph","id":"8fab244d90bc_53","name":"496b","type":"PRE","href":null,"layout":null,"metadata":null,"text":"embeddings.write().overwrite().save(f\".\u002F{MODEL_NAME_TF}_spark_nlp\")","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8fab244d90bc_54":{"__typename":"Paragraph","id":"8fab244d90bc_54","name":"b1f4","type":"P","href":null,"layout":null,"metadata":null,"text":"And we are ready to zip it…","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8fab244d90bc_55":{"__typename":"Paragraph","id":"8fab244d90bc_55","name":"b50a","type":"PRE","href":null,"layout":null,"metadata":null,"text":"shutil.make_archive(f\"roberta-base-biomedical-es\", 'zip', f\".\u002F{MODEL_NAME_TF}_spark_nlp\")","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8fab244d90bc_56":{"__typename":"Paragraph","id":"8fab244d90bc_56","name":"4e5c","type":"P","href":null,"layout":null,"metadata":null,"text":"…and to upload it to the Spark NLP Models Hub. To do this, just visit https:\u002F\u002Fnlp.johnsnowlabs.com\u002Fmodels and click on “Upload Your Model” button.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":70,"end":105,"href":"https:\u002F\u002Fnlp.johnsnowlabs.com\u002Fmodels","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*oCr5acFXd5-DNl5c988rLA.png":{"__typename":"ImageMetadata","id":"1*oCr5acFXd5-DNl5c988rLA.png","originalHeight":535,"originalWidth":1159,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:8fab244d90bc_57":{"__typename":"Paragraph","id":"8fab244d90bc_57","name":"a65c","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*oCr5acFXd5-DNl5c988rLA.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8fab244d90bc_58":{"__typename":"Paragraph","id":"8fab244d90bc_58","name":"7c92","type":"H3","href":null,"layout":null,"metadata":null,"text":"2. Bulk import of different BertForSequenceClassification models into Spark NLP","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8fab244d90bc_59":{"__typename":"Paragraph","id":"8fab244d90bc_59","name":"e37e","type":"P","href":null,"layout":null,"metadata":null,"text":"Let’s suppose I have taken a look at Hugging Face Models Hub (https:\u002F\u002Fhuggingface.co\u002Fmodels), and I have detected 7 models I want to import into Spark NLP, for BertForSequenceClassification:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":62,"end":91,"href":"https:\u002F\u002Fhuggingface.co\u002Fmodels","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8fab244d90bc_60":{"__typename":"Paragraph","id":"8fab244d90bc_60","name":"de76","type":"PRE","href":null,"layout":null,"metadata":null,"text":"models = ['philschmid\u002FBERT-Banking77']\nmodels.append('Hate-speech-CNERG\u002Fbert-base-uncased-hatexplain')\nmodels.append('mrm8488\u002Fbert-mini-finetuned-age_news-classification')\nmodels.append('juliensimon\u002Fautonlp-song-lyrics-18753417')\nmodels.append('astarostap\u002Fautonlp-antisemitism-2-21194454')\nmodels.append('aychang\u002Fbert-base-cased-trec-coarse')\nmodels.append('mrm8488\u002Fbert-tiny-finetuned-sms-spam-detection')","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8fab244d90bc_61":{"__typename":"Paragraph","id":"8fab244d90bc_61","name":"aabf","type":"P","href":null,"layout":null,"metadata":null,"text":"Since the steps are more or less the same as described in first example, I’m going to automatize in a loop all the steps from downloading, to importing into SparkNLP and inferring, to illustrate an end-to-end import.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8fab244d90bc_62":{"__typename":"Paragraph","id":"8fab244d90bc_62","name":"9f82","type":"P","href":null,"layout":null,"metadata":null,"text":"There is one extra step we need to carry out when importing Classifiers from Hugging Face: we need a labels.txt, a file that has 1 line per label included in the classifier.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":101,"end":111,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8fab244d90bc_63":{"__typename":"Paragraph","id":"8fab244d90bc_63","name":"e907","type":"P","href":null,"layout":null,"metadata":null,"text":"That file can be created using the config.json file, with a field called id2label, provided in most of Hugging Face models. However, we may find models without that field, what leads to using just numeric values for the labels, what is not very user friendly.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":35,"end":47,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":73,"end":81,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8fab244d90bc_64":{"__typename":"Paragraph","id":"8fab244d90bc_64","name":"6c23","type":"P","href":null,"layout":null,"metadata":null,"text":"To support both importing from config.json and creating our own labels, let’s declare an array:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8fab244d90bc_65":{"__typename":"Paragraph","id":"8fab244d90bc_65","name":"2b29","type":"PRE","href":null,"layout":null,"metadata":null,"text":"predefined_labels = [None, None, None, None, ('False','True'), None, ('False','True')]","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8fab244d90bc_66":{"__typename":"Paragraph","id":"8fab244d90bc_66","name":"546b","type":"P","href":null,"layout":null,"metadata":null,"text":"Each item in the array corresponds to the model in models array. If the value is None, then we will import the tags from the model. If there is a tuple of string labels, then the labels will be taken from the tuple. For example, for first model (philschmid\u002FBERT-Banking77) will get the labels from the model, but last model (mrm8488\u002Fbert-tiny-finetuned-sms-spam-detection) don’t have them, so we are setting them to “False” and “True”.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":81,"end":85,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":155,"end":168,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":246,"end":271,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":325,"end":371,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8fab244d90bc_67":{"__typename":"Paragraph","id":"8fab244d90bc_67","name":"401a","type":"P","href":null,"layout":null,"metadata":null,"text":"Now, let’s predefine a pipeline that will be used to check every iteration the results of the model. All of these models will manage Sentences, not documents, so we will have a DocumentAssembler(), a SentenceDetectorDL() and a Tokenizer().","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8fab244d90bc_68":{"__typename":"Paragraph","id":"8fab244d90bc_68","name":"159e","type":"PRE","href":null,"layout":null,"metadata":null,"text":"documentAssembler = DocumentAssembler()\\\n    .setInputCol(\"text\")\\\n    .setOutputCol(\"document\")","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8fab244d90bc_69":{"__typename":"Paragraph","id":"8fab244d90bc_69","name":"596f","type":"PRE","href":null,"layout":null,"metadata":null,"text":"sentenceDetector = SentenceDetectorDLModel.pretrained() \\\n    .setInputCols([\"document\"]) \\\n    .setOutputCol(\"sentence\")","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8fab244d90bc_70":{"__typename":"Paragraph","id":"8fab244d90bc_70","name":"19eb","type":"PRE","href":null,"layout":null,"metadata":null,"text":"spark_tokenizer = Tokenizer()\\\n    .setInputCols(\"sentence\")\\\n    .setOutputCol(\"token\")","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8fab244d90bc_71":{"__typename":"Paragraph","id":"8fab244d90bc_71","name":"2dc2","type":"P","href":null,"layout":null,"metadata":null,"text":"And now, let’s start the bulk import!","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8fab244d90bc_72":{"__typename":"Paragraph","id":"8fab244d90bc_72","name":"81e3","type":"PRE","href":null,"layout":null,"metadata":null,"text":"from shutil import copyfile\nimport collections\nimport shutil\n    \nfor i, model in enumerate(models):\n    print(f\"- Downloading {model}\")\n    tokenizer = AutoTokenizer.from_pretrained(model)\n    modelpt = AutoModelForSequenceClassification.from_pretrained(model)\n    \n    tokenizer_path = f'.\u002Fmodels\u002F{model}_tokenizer' \n    model_tf_path = f'.\u002Fmodels\u002F{model}_tf'\n    model_sparknlp_path = f'.\u002Fmodels\u002F{model}_sparknlp'\n    model_zip_path = f'.\u002Fmodels\u002F{model}'\n    \n    print(f\"- Saving {model} in local\")\n    tokenizer.save_pretrained(tokenizer_path)\n    modelpt.save_pretrained(model_tf_path, saved_model=True, save_format='tf')            \n      \n    print(f\"- Adding vocab.txt\")\n    vocab_pth = f\"{tokenizer_path}\u002Fvocab.txt\"\n    saved_model_pth = f'{model_tf_path}\u002Fsaved_model\u002F1\u002Fassets\u002Fvocab.txt'\n    copyfile(vocab_pth, saved_model_pth)    \n        \n    print(f\"- Creating and adding labels.txt\")\n    labels = None\n    labels_path = f'{model_pt_path}\u002Flabels.txt'\n    with open(f'{model_pt_path}\u002Fconfig.json', 'r') as f:\n        config = json.load(f)\n        if predefined_labels[i] is not None:\n            labels = list(predefined_labels[i])\n        else:\n            labels = config['id2label']\n            od = collections.OrderedDict(sorted(labels.items()))\n            labels = list(od.values())\n        if labels is None:\n            print(\"-- ERROR: predefined_labels are None and no 'id2label' found in config.json. Skipping\")\n            continue\n        with open(labels_path, 'w') as fw:\n            for i, l in enumerate(labels):\n                if i != 0:\n                    fw.write('\\n')\n                fw.write(l)\n            print(f\"- Labels: {labels}\")","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8fab244d90bc_73":{"__typename":"Paragraph","id":"8fab244d90bc_73","name":"7a39","type":"PRE","href":null,"layout":null,"metadata":null,"text":"labels_model_path = f'{model_tf_path}\u002Fsaved_model\u002F1\u002Fassets\u002Flabels.txt'\n    copyfile(labels_path, labels_model_path)\n    \n    print(\"- Importing into SparkNLP\")\n    seq = BertForSequenceClassification.loadSavedModel(\n        f'{model_tf_path}\u002Fsaved_model\u002F1',\n        spark)\\\n    .setInputCols([\"token\", \"sentence\"])\\\n    .setOutputCol(\"label\")\\\n    .setCaseSensitive(True)\n    \n    print(\"- Saving the sparknlp model in disk\")\n    seq.write().overwrite().save(model_sparknlp_path)\n    \n    print(\"- Zipping it to prepare it for Modelshub upload\")\n    shutil.make_archive(model_zip_path, 'zip', model_sparknlp_path)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8fab244d90bc_74":{"__typename":"Paragraph","id":"8fab244d90bc_74","name":"ef61","type":"PRE","href":null,"layout":null,"metadata":null,"text":"print(\"- Testing model in SparkNLP\")\n    pipeline = Pipeline(stages = [\n        documentAssembler,\n        sentenceDetector,\n        spark_tokenizer,\n        seq])\n    \n    empty = spark.createDataFrame([['']]).toDF(\"text\")\n    p_model = pipeline.fit(empty)\n    test_sentences = [\"\"\"What feature in your car did you not realize you had until someone else told you about it?\nYears ago, my Dad bought me a cute little VW Beetle. The first day I had it, me and my BFF were sitting in my car looking at everything.\nWhen we opened the center console, we had quite the scare. Inside was a hollowed out, plastic phallic looking object with tiny spikes on it.\nMy friend and I literally screamed in horror. It was clear to us that somehow someone left their “toy” in my new car! We were shook, as they say.\nThis was my car, I had to do something. So, I used a pen to pick up the nasty looking thing and threw it out.\nWe freaked out about how gross it was and then we forgot about it… until my Dad called me.\nMy Dad said: How’s the new car? Have you seen the flower holder in the center console?\nTo summarize, we thought a flower vase was an XXX item…\nIn our defense, this is a picture of a VW Beetle flower holder.  Camera - You are awarded a SiPix Digital Camera! call 09061221066 fromm landline.\"\"\"]\n    res = p_model.transform(spark.createDataFrame(pd.DataFrame({'text': test_sentences})))","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8fab244d90bc_75":{"__typename":"Paragraph","id":"8fab244d90bc_75","name":"ed64","type":"PRE","href":null,"layout":null,"metadata":null,"text":"result_df = res.select(F.explode(F.arrays_zip(\"sentence.result\",\"label.result\")).alias(\"cols\"))\\\n        .select(F.expr(\"cols['0']\").alias(\"sentence\"),\n                F.expr(\"cols['1']\").alias(\"label\"))","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8fab244d90bc_76":{"__typename":"Paragraph","id":"8fab244d90bc_76","name":"ba89","type":"PRE","href":null,"layout":null,"metadata":null,"text":"result_df.show(50, truncate=100)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8fab244d90bc_77":{"__typename":"Paragraph","id":"8fab244d90bc_77","name":"8254","type":"P","href":null,"layout":null,"metadata":null,"text":"Let’s see how our mrm8488\u002Fbert-mini-finetuned-age_news-classification model classifies the topics of our sentences. using the predefined labels set by the author in Hugging Face:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":18,"end":69,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*8idebnjUSWoDr3vjNhxf2g.png":{"__typename":"ImageMetadata","id":"1*8idebnjUSWoDr3vjNhxf2g.png","originalHeight":320,"originalWidth":797,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:8fab244d90bc_78":{"__typename":"Paragraph","id":"8fab244d90bc_78","name":"4a07","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*8idebnjUSWoDr3vjNhxf2g.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8fab244d90bc_79":{"__typename":"Paragraph","id":"8fab244d90bc_79","name":"a442","type":"P","href":null,"layout":null,"metadata":null,"text":"Now let’s take a look at the spam vs not spam model. The test was taken from a blog post, so it’s not spam. But we added a last spam sentence (Camera — You are awardeda SiPix…), to check if our spam model is able to detect it. These are the results of the iteration for the import of that model:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":143,"end":175,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*Skz_rnd8yhw3aus8ugdWjw.png":{"__typename":"ImageMetadata","id":"1*Skz_rnd8yhw3aus8ugdWjw.png","originalHeight":357,"originalWidth":884,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:8fab244d90bc_80":{"__typename":"Paragraph","id":"8fab244d90bc_80","name":"aa9d","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*Skz_rnd8yhw3aus8ugdWjw.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8fab244d90bc_81":{"__typename":"Paragraph","id":"8fab244d90bc_81","name":"dbd4","type":"P","href":null,"layout":null,"metadata":null,"text":"As we can see, the was correctly detected by our model, setting it to label True","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":76,"end":80,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8fab244d90bc_82":{"__typename":"Paragraph","id":"8fab244d90bc_82","name":"4d9e","type":"H3","href":null,"layout":null,"metadata":null,"text":"Links to reference notebooks","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8fab244d90bc_83":{"__typename":"Paragraph","id":"8fab244d90bc_83","name":"a044","type":"P","href":null,"layout":null,"metadata":null,"text":"The Spark NLP team has prepared a github documentation page with information about the supported transformers in Spark NLP and one reference notebook for each of them. You can find it here: https:\u002F\u002Fgithub.com\u002FJohnSnowLabs\u002Fspark-nlp\u002Fdiscussions\u002F5669","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":190,"end":248,"href":"https:\u002F\u002Fgithub.com\u002FJohnSnowLabs\u002Fspark-nlp\u002Fdiscussions\u002F5669","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8fab244d90bc_84":{"__typename":"Paragraph","id":"8fab244d90bc_84","name":"bfcc","type":"H3","href":null,"layout":null,"metadata":null,"text":"Empower the Spark NLP community","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8fab244d90bc_85":{"__typename":"Paragraph","id":"8fab244d90bc_85","name":"fecf","type":"P","href":null,"layout":null,"metadata":null,"text":"Feel free to upload your imported models into the Spark NLP Models Hub as showed above, so that everyone can leverage your work. Make an impact in the Open Source community!","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"CollectionViewerEdge:collectionId:81310c8f4868-viewerId:lo_08ed06595df6":{"__typename":"CollectionViewerEdge","id":"collectionId:81310c8f4868-viewerId:lo_08ed06595df6","isEditor":false,"isMuting":false},"ImageMetadata:1*yt4eNSte8veSTOh0spY9EQ.png":{"__typename":"ImageMetadata","id":"1*yt4eNSte8veSTOh0spY9EQ.png","originalWidth":328,"originalHeight":92},"Tag:spark-nlp":{"__typename":"Tag","id":"spark-nlp","displayTitle":"Spark Nlp","normalizedTagSlug":"spark-nlp"},"Tag:hugging-face":{"__typename":"Tag","id":"hugging-face","displayTitle":"Hugging Face","normalizedTagSlug":"hugging-face"},"Tag:nlp":{"__typename":"Tag","id":"nlp","displayTitle":"NLP","normalizedTagSlug":"nlp"},"Tag:deep-learning":{"__typename":"Tag","id":"deep-learning","displayTitle":"Deep Learning","normalizedTagSlug":"deep-learning"},"Post:8c63bdea671d":{"__typename":"Post","id":"8c63bdea671d","collection":{"__ref":"Collection:81310c8f4868"},"content({\"postMeteringOptions\":{}})":{"__typename":"PostContent","isLockedPreviewOnly":false,"bodyModel":{"__typename":"RichText","sections":[{"__typename":"Section","name":"d15b","startIndex":0,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null},{"__typename":"Section","name":"3c3a","startIndex":4,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null},{"__typename":"Section","name":"001c","startIndex":11,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null},{"__typename":"Section","name":"8b0e","startIndex":27,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null},{"__typename":"Section","name":"65d6","startIndex":33,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null},{"__typename":"Section","name":"0583","startIndex":49,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null},{"__typename":"Section","name":"30cb","startIndex":58,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null},{"__typename":"Section","name":"8086","startIndex":67,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null},{"__typename":"Section","name":"40c4","startIndex":82,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null},{"__typename":"Section","name":"6f42","startIndex":84,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null}],"paragraphs":[{"__ref":"Paragraph:8fab244d90bc_0"},{"__ref":"Paragraph:8fab244d90bc_1"},{"__ref":"Paragraph:8fab244d90bc_2"},{"__ref":"Paragraph:8fab244d90bc_3"},{"__ref":"Paragraph:8fab244d90bc_4"},{"__ref":"Paragraph:8fab244d90bc_5"},{"__ref":"Paragraph:8fab244d90bc_6"},{"__ref":"Paragraph:8fab244d90bc_7"},{"__ref":"Paragraph:8fab244d90bc_8"},{"__ref":"Paragraph:8fab244d90bc_9"},{"__ref":"Paragraph:8fab244d90bc_10"},{"__ref":"Paragraph:8fab244d90bc_11"},{"__ref":"Paragraph:8fab244d90bc_12"},{"__ref":"Paragraph:8fab244d90bc_13"},{"__ref":"Paragraph:8fab244d90bc_14"},{"__ref":"Paragraph:8fab244d90bc_15"},{"__ref":"Paragraph:8fab244d90bc_16"},{"__ref":"Paragraph:8fab244d90bc_17"},{"__ref":"Paragraph:8fab244d90bc_18"},{"__ref":"Paragraph:8fab244d90bc_19"},{"__ref":"Paragraph:8fab244d90bc_20"},{"__ref":"Paragraph:8fab244d90bc_21"},{"__ref":"Paragraph:8fab244d90bc_22"},{"__ref":"Paragraph:8fab244d90bc_23"},{"__ref":"Paragraph:8fab244d90bc_24"},{"__ref":"Paragraph:8fab244d90bc_25"},{"__ref":"Paragraph:8fab244d90bc_26"},{"__ref":"Paragraph:8fab244d90bc_27"},{"__ref":"Paragraph:8fab244d90bc_28"},{"__ref":"Paragraph:8fab244d90bc_29"},{"__ref":"Paragraph:8fab244d90bc_30"},{"__ref":"Paragraph:8fab244d90bc_31"},{"__ref":"Paragraph:8fab244d90bc_32"},{"__ref":"Paragraph:8fab244d90bc_33"},{"__ref":"Paragraph:8fab244d90bc_34"},{"__ref":"Paragraph:8fab244d90bc_35"},{"__ref":"Paragraph:8fab244d90bc_36"},{"__ref":"Paragraph:8fab244d90bc_37"},{"__ref":"Paragraph:8fab244d90bc_38"},{"__ref":"Paragraph:8fab244d90bc_39"},{"__ref":"Paragraph:8fab244d90bc_40"},{"__ref":"Paragraph:8fab244d90bc_41"},{"__ref":"Paragraph:8fab244d90bc_42"},{"__ref":"Paragraph:8fab244d90bc_43"},{"__ref":"Paragraph:8fab244d90bc_44"},{"__ref":"Paragraph:8fab244d90bc_45"},{"__ref":"Paragraph:8fab244d90bc_46"},{"__ref":"Paragraph:8fab244d90bc_47"},{"__ref":"Paragraph:8fab244d90bc_48"},{"__ref":"Paragraph:8fab244d90bc_49"},{"__ref":"Paragraph:8fab244d90bc_50"},{"__ref":"Paragraph:8fab244d90bc_51"},{"__ref":"Paragraph:8fab244d90bc_52"},{"__ref":"Paragraph:8fab244d90bc_53"},{"__ref":"Paragraph:8fab244d90bc_54"},{"__ref":"Paragraph:8fab244d90bc_55"},{"__ref":"Paragraph:8fab244d90bc_56"},{"__ref":"Paragraph:8fab244d90bc_57"},{"__ref":"Paragraph:8fab244d90bc_58"},{"__ref":"Paragraph:8fab244d90bc_59"},{"__ref":"Paragraph:8fab244d90bc_60"},{"__ref":"Paragraph:8fab244d90bc_61"},{"__ref":"Paragraph:8fab244d90bc_62"},{"__ref":"Paragraph:8fab244d90bc_63"},{"__ref":"Paragraph:8fab244d90bc_64"},{"__ref":"Paragraph:8fab244d90bc_65"},{"__ref":"Paragraph:8fab244d90bc_66"},{"__ref":"Paragraph:8fab244d90bc_67"},{"__ref":"Paragraph:8fab244d90bc_68"},{"__ref":"Paragraph:8fab244d90bc_69"},{"__ref":"Paragraph:8fab244d90bc_70"},{"__ref":"Paragraph:8fab244d90bc_71"},{"__ref":"Paragraph:8fab244d90bc_72"},{"__ref":"Paragraph:8fab244d90bc_73"},{"__ref":"Paragraph:8fab244d90bc_74"},{"__ref":"Paragraph:8fab244d90bc_75"},{"__ref":"Paragraph:8fab244d90bc_76"},{"__ref":"Paragraph:8fab244d90bc_77"},{"__ref":"Paragraph:8fab244d90bc_78"},{"__ref":"Paragraph:8fab244d90bc_79"},{"__ref":"Paragraph:8fab244d90bc_80"},{"__ref":"Paragraph:8fab244d90bc_81"},{"__ref":"Paragraph:8fab244d90bc_82"},{"__ref":"Paragraph:8fab244d90bc_83"},{"__ref":"Paragraph:8fab244d90bc_84"},{"__ref":"Paragraph:8fab244d90bc_85"}]},"validatedShareKey":"","shareKeyCreator":null},"creator":{"__ref":"User:e11aa5052863"},"inResponseToEntityType":null,"isLocked":false,"isMarkedPaywallOnly":false,"lockedSource":"LOCKED_POST_SOURCE_NONE","mediumUrl":"https:\u002F\u002Fmedium.com\u002Fspark-nlp\u002Fimporting-huggingface-models-into-sparknlp-8c63bdea671d","primaryTopic":{"__ref":"Topic:1eca0103fff3"},"topics":[{"__typename":"Topic","slug":"machine-learning"}],"isPublished":true,"latestPublishedVersion":"8fab244d90bc","visibility":"PUBLIC","postResponses":{"__typename":"PostResponses","count":0},"clapCount":62,"allowResponses":true,"isLimitedState":false,"title":"Importing HuggingFace models into SparkNLP","isSeries":false,"sequence":null,"uniqueSlug":"importing-huggingface-models-into-sparknlp-8c63bdea671d","socialTitle":"","socialDek":"","canonicalUrl":"https:\u002F\u002Fwww.johnsnowlabs.com\u002Fimporting-huggingface-models-into-spark-nlp\u002F","metaDescription":"","latestPublishedAt":1637318681568,"readingTime":6.718867924528302,"previewContent":{"__typename":"PreviewContent","subtitle":"In this article we are going to show two examples of how to import Hugging Face embeddings models into Spark NLP, and another example for…"},"previewImage":{"__ref":"ImageMetadata:1*oCr5acFXd5-DNl5c988rLA.png"},"isShortform":false,"seoTitle":"","firstPublishedAt":1636382467292,"updatedAt":1682364659036,"shortformType":"SHORTFORM_TYPE_LINK","seoDescription":"","isSuspended":false,"license":"ALL_RIGHTS_RESERVED","tags":[{"__ref":"Tag:spark-nlp"},{"__ref":"Tag:hugging-face"},{"__ref":"Tag:nlp"},{"__ref":"Tag:deep-learning"}],"isNewsletter":false,"statusForCollection":"APPROVED","pendingCollection":null,"detectedLanguage":"en","wordCount":1595,"layerCake":3}}</script><script>window.__MIDDLEWARE_STATE__={"session":{"xsrf":""},"cache":{"cacheStatus":"HIT"}}</script><script src="https://cdn-client.medium.com/lite/static/js/manifest.5107984b.js"></script><script src="https://cdn-client.medium.com/lite/static/js/3652.c1c01f1e.js"></script><script src="https://cdn-client.medium.com/lite/static/js/main.f4f86923.js"></script><script src="https://cdn-client.medium.com/lite/static/js/instrumentation.d9108df7.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/reporting.ff22a7a5.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9120.5df29668.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3171.5b0ceee8.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4810.988332a1.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6618.db187378.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/1386.e126dec1.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9977.343f5002.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5250.fc15c18c.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8261.08d8d6be.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7975.19e89f16.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2648.a582e725.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2712.0f6c85f5.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2793.01d2b056.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6636.ef641110.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3735.ca2f95e3.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5642.b8216689.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6546.0f97e7cb.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6834.f2d3924e.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2420.0330d157.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2106.21ff89d3.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6696.92b2dfc3.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5832.07d4db30.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3366.16d43002.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6040.6ceb7f43.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4391.3e417aeb.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/PostPage.MainContent.713701de.chunk.js"></script><script>window.main();</script></body></html>