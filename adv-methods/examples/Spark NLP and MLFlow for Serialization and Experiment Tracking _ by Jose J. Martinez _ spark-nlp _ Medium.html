<!doctype html><html lang="en"><head><title data-rh="true">Spark NLP and MLFlow for Serialization and Experiment Tracking | by Jose J. Martinez | spark-nlp | Medium</title><meta data-rh="true" charset="utf-8"/><meta data-rh="true" name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1,maximum-scale=1"/><meta data-rh="true" name="theme-color" content="#000000"/><meta data-rh="true" name="twitter:app:name:iphone" content="Medium"/><meta data-rh="true" name="twitter:app:id:iphone" content="828256236"/><meta data-rh="true" property="al:ios:app_name" content="Medium"/><meta data-rh="true" property="al:ios:app_store_id" content="828256236"/><meta data-rh="true" property="al:android:package" content="com.medium.reader"/><meta data-rh="true" property="fb:app_id" content="542599432471018"/><meta data-rh="true" property="og:site_name" content="Medium"/><meta data-rh="true" property="og:type" content="article"/><meta data-rh="true" property="article:published_time" content="2021-12-16T12:01:36.397Z"/><meta data-rh="true" name="title" content="Spark NLP and MLFlow for Serialization and Experiment Tracking | by Jose J. Martinez | spark-nlp | Medium"/><meta data-rh="true" property="og:title" content="Spark NLP and MLFlow for Serialization and Experiment Tracking"/><meta data-rh="true" property="al:android:url" content="medium://p/c4549827ece4"/><meta data-rh="true" property="al:ios:url" content="medium://p/c4549827ece4"/><meta data-rh="true" property="al:android:app_name" content="Medium"/><meta data-rh="true" name="description" content="How to use MLFlow for Serialization of Spark NLP models, and local and remote Experiment Tracking. This is the first article of the upcoming series of…"/><meta data-rh="true" property="og:description" content="How to use MLFlow for Serialization of Spark NLP models, and local and remote Experiment Tracking"/><meta data-rh="true" property="og:url" content="https://medium.com/spark-nlp/spark-nlp-and-mlflow-for-serialization-and-experiment-tracking-c4549827ece4"/><meta data-rh="true" property="al:web:url" content="https://medium.com/spark-nlp/spark-nlp-and-mlflow-for-serialization-and-experiment-tracking-c4549827ece4"/><meta data-rh="true" property="og:image" content="https://miro.medium.com/v2/resize:fit:742/1*3w3Cxo8ElFmAK7VM_jNxDA.png"/><meta data-rh="true" property="article:author" content="https://medium.com/@jjmcarrascosa"/><meta data-rh="true" name="author" content="Jose J. Martinez"/><meta data-rh="true" name="robots" content="index,noarchive,follow,max-image-preview:large"/><meta data-rh="true" name="referrer" content="unsafe-url"/><meta data-rh="true" property="twitter:title" content="Spark NLP and MLFlow for Serialization and Experiment Tracking"/><meta data-rh="true" name="twitter:site" content="@johnsnowlabs"/><meta data-rh="true" name="twitter:app:url:iphone" content="medium://p/c4549827ece4"/><meta data-rh="true" property="twitter:description" content="How to use MLFlow for Serialization of Spark NLP models, and local and remote Experiment Tracking"/><meta data-rh="true" name="twitter:image:src" content="https://miro.medium.com/v2/resize:fit:742/1*3w3Cxo8ElFmAK7VM_jNxDA.png"/><meta data-rh="true" name="twitter:card" content="summary_large_image"/><meta data-rh="true" name="twitter:label1" content="Reading time"/><meta data-rh="true" name="twitter:data1" content="10 min read"/><link data-rh="true" rel="icon" href="https://miro.medium.com/v2/1*m-R_BkNf1Qjr1YbyOIJY2w.png"/><link data-rh="true" rel="search" type="application/opensearchdescription+xml" title="Medium" href="/osd.xml"/><link data-rh="true" rel="apple-touch-icon" sizes="152x152" href="https://miro.medium.com/v2/resize:fill:304:304/1*sHhtYhaCe2Uc3IU0IgKwIQ.png"/><link data-rh="true" rel="apple-touch-icon" sizes="120x120" href="https://miro.medium.com/v2/resize:fill:240:240/1*sHhtYhaCe2Uc3IU0IgKwIQ.png"/><link data-rh="true" rel="apple-touch-icon" sizes="76x76" href="https://miro.medium.com/v2/resize:fill:152:152/1*sHhtYhaCe2Uc3IU0IgKwIQ.png"/><link data-rh="true" rel="apple-touch-icon" sizes="60x60" href="https://miro.medium.com/v2/resize:fill:120:120/1*sHhtYhaCe2Uc3IU0IgKwIQ.png"/><link data-rh="true" rel="mask-icon" href="https://cdn-static-1.medium.com/_/fp/icons/Medium-Avatar-500x500.svg" color="#171717"/><link data-rh="true" rel="preconnect" href="https://glyph.medium.com" crossOrigin=""/><link data-rh="true" id="glyph_preload_link" rel="preload" as="style" type="text/css" href="https://glyph.medium.com/css/unbound.css"/><link data-rh="true" id="glyph_link" rel="stylesheet" type="text/css" href="https://glyph.medium.com/css/unbound.css"/><link data-rh="true" rel="author" href="https://medium.com/@jjmcarrascosa"/><link data-rh="true" rel="canonical" href="https://github.com/josejuanmartinez/medium/blob/main/mlflow/mlflow.md"/><link data-rh="true" rel="alternate" href="android-app://com.medium.reader/https/medium.com/p/c4549827ece4"/><script data-rh="true" type="application/ld+json">{"@context":"http:\u002F\u002Fschema.org","@type":"NewsArticle","image":["https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fresize:fit:1200\u002F1*3w3Cxo8ElFmAK7VM_jNxDA.png"],"url":"https:\u002F\u002Fmedium.com\u002Fspark-nlp\u002Fspark-nlp-and-mlflow-for-serialization-and-experiment-tracking-c4549827ece4","dateCreated":"2021-12-16T10:49:43.046Z","datePublished":"2021-12-16T10:49:43.046Z","dateModified":"2022-01-04T02:22:01.690Z","headline":"Spark NLP and MLFlow for Serialization and Experiment Tracking","name":"Spark NLP and MLFlow for Serialization and Experiment Tracking","description":"How to use MLFlow for Serialization of Spark NLP models, and local and remote Experiment Tracking. This is the first article of the upcoming series of…","identifier":"c4549827ece4","author":{"@type":"Person","name":"Jose J. Martinez","url":"https:\u002F\u002Fmedium.com\u002F@jjmcarrascosa"},"creator":["Jose J. Martinez"],"publisher":{"@type":"Organization","name":"spark-nlp","url":"https:\u002F\u002Fmedium.com\u002Fspark-nlp","logo":{"@type":"ImageObject","width":213,"height":60,"url":"https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fresize:fit:426\u002F1*yt4eNSte8veSTOh0spY9EQ.png"}},"mainEntityOfPage":"https:\u002F\u002Fmedium.com\u002Fspark-nlp\u002Fspark-nlp-and-mlflow-for-serialization-and-experiment-tracking-c4549827ece4"}</script><style type="text/css" data-fela-rehydration="545" data-fela-type="STATIC">html{box-sizing:border-box;-webkit-text-size-adjust:100%}*, *:before, *:after{box-sizing:inherit}body{margin:0;padding:0;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;color:rgba(0,0,0,0.8);position:relative;min-height:100vh}h1, h2, h3, h4, h5, h6, dl, dd, ol, ul, menu, figure, blockquote, p, pre, form{margin:0}menu, ol, ul{padding:0;list-style:none;list-style-image:none}main{display:block}a{color:inherit;text-decoration:none}a, button, input{-webkit-tap-highlight-color:transparent}img, svg{vertical-align:middle}button{background:transparent;overflow:visible}button, input, optgroup, select, textarea{margin:0}:root{--reach-tabs:1;--reach-menu-button:1}#speechify-root{font-family:Sohne, sans-serif}div[data-popper-reference-hidden="true"]{visibility:hidden;pointer-events:none}.grecaptcha-badge{visibility:hidden}
/*XCode style (c) Angel Garcia <angelgarcia.mail@gmail.com>*/.hljs {background: #fff;color: black;
}/* Gray DOCTYPE selectors like WebKit */
.xml .hljs-meta {color: #c0c0c0;
}.hljs-comment,
.hljs-quote {color: #007400;
}.hljs-tag,
.hljs-attribute,
.hljs-keyword,
.hljs-selector-tag,
.hljs-literal,
.hljs-name {color: #aa0d91;
}.hljs-variable,
.hljs-template-variable {color: #3F6E74;
}.hljs-code,
.hljs-string,
.hljs-meta .hljs-string {color: #c41a16;
}.hljs-regexp,
.hljs-link {color: #0E0EFF;
}.hljs-title,
.hljs-symbol,
.hljs-bullet,
.hljs-number {color: #1c00cf;
}.hljs-section,
.hljs-meta {color: #643820;
}.hljs-title.class_,
.hljs-class .hljs-title,
.hljs-type,
.hljs-built_in,
.hljs-params {color: #5c2699;
}.hljs-attr {color: #836C28;
}.hljs-subst {color: #000;
}.hljs-formula {background-color: #eee;font-style: italic;
}.hljs-addition {background-color: #baeeba;
}.hljs-deletion {background-color: #ffc8bd;
}.hljs-selector-id,
.hljs-selector-class {color: #9b703f;
}.hljs-doctag,
.hljs-strong {font-weight: bold;
}.hljs-emphasis {font-style: italic;
}
</style><style type="text/css" data-fela-rehydration="545" data-fela-type="KEYFRAME">@-webkit-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@-moz-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}</style><style type="text/css" data-fela-rehydration="545" data-fela-type="RULE">.a{font-family:medium-content-sans-serif-font, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif}.b{font-weight:400}.c{background-color:rgba(255, 255, 255, 1)}.l{display:block}.m{position:sticky}.n{top:0}.o{z-index:500}.p{padding:0 24px}.q{align-items:center}.r{border-bottom:solid 1px #F2F2F2}.y{height:41px}.z{line-height:20px}.ab{display:flex}.ac{height:57px}.ae{flex:1 0 auto}.af{color:inherit}.ag{fill:inherit}.ah{font-size:inherit}.ai{border:inherit}.aj{font-family:inherit}.ak{letter-spacing:inherit}.al{font-weight:inherit}.am{padding:0}.an{margin:0}.ao{cursor:pointer}.ap:disabled{cursor:not-allowed}.aq:disabled{color:#6B6B6B}.ar:disabled{fill:#6B6B6B}.au path{fill:#242424}.av{height:27px}.aw{margin-left:16px}.ax{border:none}.ay{border-radius:20px}.az{width:240px}.ba{background:#F9F9F9}.bb path{fill:#6B6B6B}.bd{outline:none}.be{font-family:sohne, "Helvetica Neue", Helvetica, Arial, sans-serif}.bf{font-size:14px}.bg{width:100%}.bh{padding:10px 20px 10px 0}.bi{background-color:transparent}.bj{color:#242424}.bk::placeholder{color:#6B6B6B}.bl{display:inline-block}.bm{margin-left:12px}.bn{margin-right:12px}.bo{border-radius:4px}.bp{margin-left:24px}.bq{height:24px}.bw{background-color:#F9F9F9}.bx{border-radius:50%}.by{height:32px}.bz{width:32px}.ca{justify-content:center}.cg{max-width:680px}.ch{min-width:0}.ci{animation:k1 1.2s ease-in-out infinite}.cj{height:100vh}.ck{margin-bottom:16px}.cl{margin-top:48px}.cm{align-items:flex-start}.cn{flex-direction:column}.co{justify-content:space-between}.cp{margin-bottom:24px}.cv{width:80%}.cw{background-color:#F2F2F2}.dc{height:44px}.dd{width:44px}.de{margin:auto 0}.df{margin-bottom:4px}.dg{height:16px}.dh{width:120px}.di{width:80px}.do{margin-bottom:8px}.dp{width:96%}.dq{width:98%}.dr{width:81%}.ds{margin-left:8px}.dt{color:#6B6B6B}.du{font-size:13px}.dv{height:100%}.eo{color:#FFFFFF}.ep{fill:#FFFFFF}.eq{background:rgba(60, 141, 207, 1)}.er{border-color:rgba(60, 141, 207, 1)}.ev:disabled{cursor:inherit !important}.ew:disabled{opacity:0.3}.ex:disabled:hover{background:rgba(60, 141, 207, 1)}.ey:disabled:hover{border-color:rgba(60, 141, 207, 1)}.ez{border-radius:99em}.fa{border-width:1px}.fb{border-style:solid}.fc{box-sizing:border-box}.fd{text-decoration:none}.fe{text-align:center}.fh{margin-right:32px}.fi{position:relative}.fj{fill:#6B6B6B}.fm{background:transparent}.fn svg{margin-left:4px}.fo svg{fill:#6B6B6B}.fq{box-shadow:inset 0 0 0 1px rgba(0, 0, 0, 0.05)}.fr{position:absolute}.fy{margin:0 24px}.gc{background:rgba(255, 255, 255, 1)}.gd{border:1px solid #F2F2F2}.ge{box-shadow:0 1px 4px #F2F2F2}.gf{max-height:100vh}.gg{overflow-y:auto}.gh{left:0}.gi{top:calc(100vh + 100px)}.gj{bottom:calc(100vh + 100px)}.gk{width:10px}.gl{pointer-events:none}.gm{word-break:break-word}.gn{word-wrap:break-word}.go:after{display:block}.gp:after{content:""}.gq:after{clear:both}.gr{line-height:1.23}.gs{letter-spacing:0}.gt{font-style:normal}.gu{font-weight:700}.hz{align-items:baseline}.ia{width:48px}.ib{height:48px}.ic{border:2px solid rgba(255, 255, 255, 1)}.id{z-index:0}.ie{box-shadow:none}.if{border:1px solid rgba(0, 0, 0, 0.05)}.ig{margin-left:-12px}.ih{width:28px}.ii{height:28px}.ij{z-index:1}.ik{width:24px}.il{margin-bottom:2px}.im{flex-wrap:nowrap}.in{font-size:16px}.io{line-height:24px}.iq{margin:0 8px}.ir{display:inline}.is{color:rgba(60, 141, 207, 1)}.it{fill:rgba(60, 141, 207, 1)}.iw{flex:0 0 auto}.iz{flex-wrap:wrap}.jc{white-space:pre-wrap}.jd{margin-right:4px}.je{overflow:hidden}.jf{max-height:20px}.jg{text-overflow:ellipsis}.jh{display:-webkit-box}.ji{-webkit-line-clamp:1}.jj{-webkit-box-orient:vertical}.jk{word-break:break-all}.jm{padding-left:8px}.jn{padding-right:8px}.ko> *{flex-shrink:0}.kp{overflow-x:scroll}.kq::-webkit-scrollbar{display:none}.kr{scrollbar-width:none}.ks{-ms-overflow-style:none}.kt{width:74px}.ku{flex-direction:row}.kv{z-index:2}.ky{-webkit-user-select:none}.kz{border:0}.la{fill:rgba(117, 117, 117, 1)}.ld{outline:0}.le{user-select:none}.lf> svg{pointer-events:none}.lo{cursor:progress}.lp{opacity:1}.lq{padding:4px 0}.lt{margin-top:0px}.lu{width:16px}.lw{display:inline-flex}.mc{max-width:100%}.md{padding:8px 2px}.me svg{color:#6B6B6B}.mv{margin-left:auto}.mw{margin-right:auto}.mx{max-width:742px}.nd{clear:both}.nf{cursor:zoom-in}.ng{z-index:auto}.ni{height:auto}.nj{line-height:1.58}.nk{letter-spacing:-0.004em}.nl{font-family:source-serif-pro, Georgia, Cambria, "Times New Roman", Times, serif}.og{margin-bottom:-0.46em}.oh{line-height:1.12}.oi{letter-spacing:-0.022em}.oj{font-weight:600}.pe{margin-bottom:-0.28em}.pk{text-decoration:underline}.pl{list-style-type:disc}.pm{margin-left:30px}.pn{padding-left:0px}.pt{margin-top:32px}.pu{margin-bottom:14px}.pv{padding-top:24px}.pw{padding-bottom:10px}.px{background-color:#000000}.py{height:3px}.pz{width:3px}.qa{margin-right:20px}.qg{padding:2px 4px}.qh{font-size:75%}.qi> strong{font-family:inherit}.qj{font-family:source-code-pro, Menlo, Monaco, "Courier New", Courier, monospace}.qk{max-width:1900px}.qq{overflow-x:auto}.qr{padding:20px}.qs{border-radius:0}.qt{background:#F2F2F2}.qu{line-height:1.18}.qv{margin-top:-0.09em}.qw{margin-bottom:-0.09em}.qx{min-width:fit-content}.qy{margin-top:0.91em}.rm{margin-bottom:-0.31em}.rn{font-style:italic}.ro{max-width:444px}.rp{max-width:1291px}.rq{max-width:689px}.rr{margin-bottom:26px}.rs{margin-top:6px}.rt{margin-top:8px}.ru{margin-right:8px}.rv{padding:8px 16px}.rw{border-radius:100px}.rx{transition:background 300ms ease}.rz{white-space:nowrap}.sa{border-top:none}.sg{height:52px}.sh{max-height:52px}.si{box-sizing:content-box}.sj{position:static}.sl{max-width:155px}.sw{align-items:flex-end}.sx{width:76px}.sy{height:76px}.sz{border:2px solid #F9F9F9}.ta{height:72px}.tb{width:72px}.tc{margin-left:-16px}.td{width:36px}.te{height:36px}.tf{width:auto}.tg{stroke:#F2F2F2}.th{color:#F2F2F2}.ti{fill:#F2F2F2}.tj{border-color:#F2F2F2}.tp{font-weight:500}.tq{font-size:24px}.tr{line-height:30px}.ts{letter-spacing:-0.016em}.tt{margin-top:16px}.tu{height:0px}.tv{border-bottom:solid 1px #E5E5E5}.tw{margin-top:72px}.tx{padding:24px 0}.ty{margin-bottom:0px}.tz{margin-right:16px}.as:hover:not(:disabled){color:rgba(25, 25, 25, 1)}.at:hover:not(:disabled){fill:rgba(25, 25, 25, 1)}.es:hover{background:rgba(59, 121, 173, 1)}.et:hover{border-color:rgba(59, 121, 173, 1)}.eu:hover{cursor:pointer}.fk:hover{color:#242424}.fl:hover{fill:#242424}.fp:hover svg{fill:#242424}.fs:hover{background-color:rgba(0, 0, 0, 0.1)}.ip:hover{text-decoration:underline}.iu:hover:not(:disabled){color:rgba(59, 121, 173, 1)}.iv:hover:not(:disabled){fill:rgba(59, 121, 173, 1)}.lc:hover{fill:rgba(8, 8, 8, 1)}.lr:hover{fill:#000000}.ls:hover p{color:#000000}.lv:hover{color:#000000}.mf:hover svg{color:#000000}.ry:hover{background-color:#F2F2F2}.tk:hover{background:#F2F2F2}.tl:hover{border-color:#F2F2F2}.tm:hover{cursor:wait}.tn:hover{color:#F2F2F2}.to:hover{fill:#F2F2F2}.bc:focus-within path{fill:#242424}.lb:focus{fill:rgba(8, 8, 8, 1)}.mg:focus svg{color:#000000}.nh:focus{transform:scale(1.01)}.lg:active{border-style:none}</style><style type="text/css" data-fela-rehydration="545" data-fela-type="RULE" media="all and (min-width: 1080px)">.d{display:none}.bv{width:64px}.cf{margin:0 64px}.cu{height:48px}.db{margin-bottom:52px}.dn{margin-bottom:48px}.ee{font-size:14px}.ef{line-height:20px}.el{font-size:13px}.em{padding:5px 12px}.fg{display:flex}.fx{margin-bottom:68px}.gb{max-width:680px}.hp{font-size:42px}.hq{margin-top:1.19em}.hr{margin-bottom:32px}.hs{line-height:52px}.ht{letter-spacing:-0.011em}.hy{align-items:center}.ka{border-top:solid 1px #F2F2F2}.kb{border-bottom:solid 1px #F2F2F2}.kc{margin:32px 0 0}.kd{padding:3px 8px}.km> *{margin-right:24px}.kn> :last-child{margin-right:0}.ln{margin-top:0px}.mb{margin:0}.nc{margin-top:40px}.oc{font-size:20px}.od{margin-top:2.14em}.oe{line-height:32px}.of{letter-spacing:-0.003em}.pa{font-size:24px}.pb{margin-top:1.95em}.pc{line-height:30px}.pd{letter-spacing:-0.016em}.pj{margin-top:0.94em}.ps{margin-top:1.14em}.qf{margin-top:1.25em}.qp{margin-top:56px}.rj{margin-top:1.72em}.rk{line-height:24px}.rl{letter-spacing:0}.sf{margin-bottom:88px}.sq{display:inline-block}.sv{padding-top:72px}</style><style type="text/css" data-fela-rehydration="545" data-fela-type="RULE" media="all and (max-width: 1079.98px)">.e{display:none}.lm{margin-top:0px}.sp{display:inline-block}</style><style type="text/css" data-fela-rehydration="545" data-fela-type="RULE" media="all and (max-width: 903.98px)">.f{display:none}.ll{margin-top:0px}.so{display:inline-block}</style><style type="text/css" data-fela-rehydration="545" data-fela-type="RULE" media="all and (max-width: 727.98px)">.g{display:none}.lj{margin-top:0px}.lk{margin-right:0px}.sn{display:inline-block}</style><style type="text/css" data-fela-rehydration="545" data-fela-type="RULE" media="all and (max-width: 551.98px)">.h{display:none}.s{display:flex}.t{justify-content:space-between}.br{width:24px}.cb{margin:0 24px}.cq{height:40px}.cx{margin-bottom:44px}.dj{margin-bottom:32px}.dw{font-size:13px}.dx{line-height:20px}.eg{padding:0px 8px 1px}.ft{margin-bottom:4px}.gv{font-size:32px}.gw{margin-top:1.01em}.gx{margin-bottom:24px}.gy{line-height:38px}.gz{letter-spacing:-0.014em}.hu{align-items:flex-start}.ix{flex-direction:column}.ja{margin-bottom:2px}.jo{margin:24px -24px 0}.jp{padding:0}.ke> *{margin-right:8px}.kf> :last-child{margin-right:24px}.kw{margin-left:0px}.lh{margin-top:0px}.li{margin-right:0px}.lx{margin:0}.mh{border:1px solid #F2F2F2}.mi{border-radius:99em}.mj{padding:0px 16px 0px 12px}.mk{height:38px}.ml{align-items:center}.mn svg{margin-right:8px}.my{margin-top:32px}.nm{font-size:18px}.nn{margin-top:1.56em}.no{line-height:28px}.np{letter-spacing:-0.003em}.ok{font-size:20px}.ol{margin-top:1.2em}.om{line-height:24px}.on{letter-spacing:0}.pf{margin-top:0.67em}.po{margin-top:1.34em}.qb{margin-top:0.93em}.ql{margin-top:40px}.qz{font-size:16px}.ra{margin-top:1.23em}.sb{margin-bottom:80px}.sm{display:inline-block}.sr{padding-top:48px}.mm:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="545" data-fela-type="RULE" media="all and (min-width: 904px) and (max-width: 1079.98px)">.i{display:none}.bu{width:64px}.ce{margin:0 64px}.ct{height:48px}.da{margin-bottom:52px}.dm{margin-bottom:48px}.ec{font-size:14px}.ed{line-height:20px}.ej{font-size:13px}.ek{padding:5px 12px}.ff{display:flex}.fw{margin-bottom:68px}.ga{max-width:680px}.hk{font-size:42px}.hl{margin-top:1.19em}.hm{margin-bottom:32px}.hn{line-height:52px}.ho{letter-spacing:-0.011em}.hx{align-items:center}.jw{border-top:solid 1px #F2F2F2}.jx{border-bottom:solid 1px #F2F2F2}.jy{margin:32px 0 0}.jz{padding:3px 8px}.kk> *{margin-right:24px}.kl> :last-child{margin-right:0}.ma{margin:0}.nb{margin-top:40px}.ny{font-size:20px}.nz{margin-top:2.14em}.oa{line-height:32px}.ob{letter-spacing:-0.003em}.ow{font-size:24px}.ox{margin-top:1.95em}.oy{line-height:30px}.oz{letter-spacing:-0.016em}.pi{margin-top:0.94em}.pr{margin-top:1.14em}.qe{margin-top:1.25em}.qo{margin-top:56px}.rg{margin-top:1.72em}.rh{line-height:24px}.ri{letter-spacing:0}.se{margin-bottom:88px}.su{padding-top:72px}</style><style type="text/css" data-fela-rehydration="545" data-fela-type="RULE" media="all and (min-width: 728px) and (max-width: 903.98px)">.j{display:none}.w{display:flex}.x{justify-content:space-between}.bt{width:64px}.cd{margin:0 48px}.cs{height:48px}.cz{margin-bottom:52px}.dl{margin-bottom:48px}.ea{font-size:13px}.eb{line-height:20px}.ei{padding:0px 8px 1px}.fv{margin-bottom:68px}.fz{max-width:680px}.hf{font-size:42px}.hg{margin-top:1.19em}.hh{margin-bottom:32px}.hi{line-height:52px}.hj{letter-spacing:-0.011em}.hw{align-items:center}.js{border-top:solid 1px #F2F2F2}.jt{border-bottom:solid 1px #F2F2F2}.ju{margin:32px 0 0}.jv{padding:3px 8px}.ki> *{margin-right:24px}.kj> :last-child{margin-right:0}.lz{margin:0}.na{margin-top:40px}.nu{font-size:20px}.nv{margin-top:2.14em}.nw{line-height:32px}.nx{letter-spacing:-0.003em}.os{font-size:24px}.ot{margin-top:1.95em}.ou{line-height:30px}.ov{letter-spacing:-0.016em}.ph{margin-top:0.94em}.pq{margin-top:1.14em}.qd{margin-top:1.25em}.qn{margin-top:56px}.rd{margin-top:1.72em}.re{line-height:24px}.rf{letter-spacing:0}.sd{margin-bottom:88px}.st{padding-top:72px}</style><style type="text/css" data-fela-rehydration="545" data-fela-type="RULE" media="all and (min-width: 552px) and (max-width: 727.98px)">.k{display:none}.u{display:flex}.v{justify-content:space-between}.bs{width:24px}.cc{margin:0 24px}.cr{height:40px}.cy{margin-bottom:44px}.dk{margin-bottom:32px}.dy{font-size:13px}.dz{line-height:20px}.eh{padding:0px 8px 1px}.fu{margin-bottom:4px}.ha{font-size:32px}.hb{margin-top:1.01em}.hc{margin-bottom:24px}.hd{line-height:38px}.he{letter-spacing:-0.014em}.hv{align-items:flex-start}.iy{flex-direction:column}.jb{margin-bottom:2px}.jq{margin:24px 0 0}.jr{padding:0}.kg> *{margin-right:8px}.kh> :last-child{margin-right:8px}.kx{margin-left:0px}.ly{margin:0}.mo{border:1px solid #F2F2F2}.mp{border-radius:99em}.mq{padding:0px 16px 0px 12px}.mr{height:38px}.ms{align-items:center}.mu svg{margin-right:8px}.mz{margin-top:32px}.nq{font-size:18px}.nr{margin-top:1.56em}.ns{line-height:28px}.nt{letter-spacing:-0.003em}.oo{font-size:20px}.op{margin-top:1.2em}.oq{line-height:24px}.or{letter-spacing:0}.pg{margin-top:0.67em}.pp{margin-top:1.34em}.qc{margin-top:0.93em}.qm{margin-top:40px}.rb{font-size:16px}.rc{margin-top:1.23em}.sc{margin-bottom:80px}.ss{padding-top:48px}.mt:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="545" data-fela-type="RULE" media="print">.sk{display:none}</style><style type="text/css" data-fela-rehydration="545" data-fela-type="RULE" media="(orientation: landscape) and (max-width: 903.98px)">.jl{max-height:none}</style><style type="text/css" data-fela-rehydration="545" data-fela-type="RULE" media="(prefers-reduced-motion: no-preference)">.ne{transition:transform 300ms cubic-bezier(0.2, 0, 0.2, 1)}</style></head><body><div id="root"><div class="a b c"><div class="d e f g h i j k"></div><script>document.domain = document.domain;</script><div class="l c"><div class="l m n o c"><div class="p q r s t u v w x i d y z"><a class="dt ag du be ak b am an ao ap aq ar as at s u w i d q dv z" href="https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fc4549827ece4&amp;%7Efeature=LoOpenInAppButton&amp;%7Echannel=ShowPostUnderCollection&amp;source=---two_column_layout_nav----------------------------------" rel="noopener follow">Open in app<svg xmlns="http://www.w3.org/2000/svg" width="10" height="10" fill="none" viewBox="0 0 10 10" class="ds"><path fill="currentColor" d="M.985 8.485a.375.375 0 1 0 .53.53zM8.75 1.25h.375A.375.375 0 0 0 8.75.875zM8.375 6.5a.375.375 0 1 0 .75 0zM3.5.875a.375.375 0 1 0 0 .75zm-1.985 8.14 7.5-7.5-.53-.53-7.5 7.5zm6.86-7.765V6.5h.75V1.25zM3.5 1.625h5.25v-.75H3.5z"></path></svg></a><div class="ab q"><p class="be b dw dx dy dz ea eb ec ed ee ef dt"><span><button class="be b dw dx eg dy dz eh ea eb ei ej ed ek el ef em eo ep eq er es et eu ev ew ex ey ez fa fb fc bl fd fe" data-testid="headerSignUpButton">Sign up</button></span></p><div class="aw l"><p class="be b dw dx dy dz ea eb ec ed ee ef dt"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSignInButton" rel="noopener follow" href="/m/signin?operation=login&amp;redirect=https%3A%2F%2Fmedium.com%2Fspark-nlp%2Fspark-nlp-and-mlflow-for-serialization-and-experiment-tracking-c4549827ece4&amp;source=post_page---two_column_layout_nav-----------------------global_nav-----------">Sign in</a></span></p></div></div></div><div class="p q r ab ac"><div class="ab q ae"><a class="af ag ah ai aj ak al am an ao ap aq ar as at ab" aria-label="Homepage" data-testid="headerMediumLogo" rel="noopener follow" href="/?source=---two_column_layout_nav----------------------------------"><svg xmlns="http://www.w3.org/2000/svg" width="120" height="26" fill="none" viewBox="0 0 120 26" class="au av"><path fill="#000" d="m29.57 1.404.036-.008V1.12h-7.27l-6.75 15.979-6.75-15.98H1.003v.278l.035.008c1.327.302 2 .752 2 2.374v18.993c0 1.623-.676 2.073-2.003 2.374L1 25.153v.279h5.315v-.278l-.035-.008c-1.327-.302-2-.751-2-2.374V4.88l8.67 20.552h.492l8.924-21.125V23.24c-.114 1.282-.782 1.677-1.983 1.95l-.036.009v.275h9.259V25.2l-.036-.008c-1.203-.274-1.886-.67-2-1.95l-.006-19.464h.006c0-1.622.674-2.072 2-2.374m4.23 12.582c.15-3.412 1.367-5.875 3.41-5.918.629.01 1.157.219 1.568.62.872.852 1.282 2.634 1.219 5.298zm-.092.962h10.85v-.046c-.03-2.61-.78-4.64-2.228-6.033-1.25-1.204-3.103-1.867-5.048-1.867h-.043c-1.01 0-2.248.246-3.13.693a7.3 7.3 0 0 0-2.623 2.086c-1.185 1.479-1.903 3.477-2.078 5.724a14 14 0 0 0-.04.755q-.007.292-.001.587C29.484 21.934 32.213 26 37.059 26c4.254 0 6.73-3.132 7.348-7.336l-.312-.11c-1.085 2.259-3.034 3.628-5.252 3.461-3.028-.228-5.347-3.32-5.137-7.066m23.122 6.893c-.356.85-1.099 1.319-2.094 1.319s-1.905-.689-2.552-1.939c-.694-1.342-1.06-3.24-1.06-5.487 0-4.678 1.445-7.704 3.68-7.704.937 0 1.674.468 2.026 1.284zm7.198 3.335c-1.327-.316-2-.787-2-2.492V0l-8.062 2.392v.293l.05-.004c1.111-.09 1.866.064 2.304.472.343.32.51.809.51 1.498v3.11C56.033 7.25 55.088 7 53.94 7c-2.326 0-4.453.987-5.986 2.779-1.599 1.867-2.444 4.42-2.444 7.38 0 5.287 2.584 8.84 6.43 8.84 2.25 0 4.06-1.242 4.888-3.336v2.811h7.233v-.29zM70.94 3.085c0-1.65-1.236-2.896-2.875-2.896-1.632 0-2.908 1.272-2.908 2.896s1.278 2.896 2.908 2.896c1.64 0 2.875-1.245 2.875-2.896m1.903 22.092c-1.327-.316-2-.787-2-2.492h-.006V7.055l-7.234 2.092v.284l.043.004c1.566.14 1.994.683 1.994 2.525v13.515h7.24v-.29zm18.536 0c-1.327-.316-2-.787-2-2.492V7.055L82.49 9.078v.285l.04.004c1.28.136 1.65.71 1.65 2.56v9.88c-.426.85-1.227 1.356-2.196 1.39-1.573 0-2.439-1.07-2.439-3.012V7.055l-7.234 2.092v.284l.044.004c1.565.14 1.994.683 1.994 2.525v8.362a9.4 9.4 0 0 0 .15 1.741l.13.57C75.243 24.845 76.848 26 79.362 26c2.129 0 3.996-1.328 4.818-3.405v2.885h7.233v-.291zm28.102.298v-.291l-.035-.009c-1.44-.334-2.001-.964-2.001-2.248V12.295C117.445 8.98 115.597 7 112.5 7c-2.257 0-4.16 1.314-4.893 3.36-.582-2.168-2.257-3.36-4.734-3.36-2.175 0-3.88 1.156-4.612 3.11V7.056l-7.233 2.006v.286l.043.004c1.547.138 1.994.697 1.994 2.492v13.631h6.75v-.29l-.037-.01c-1.148-.271-1.519-.767-1.519-2.04V10.95c.304-.715.917-1.562 2.127-1.562 1.504 0 2.266 1.05 2.266 3.116v12.972h6.751v-.29l-.035-.01c-1.149-.271-1.52-.767-1.52-2.04V12.294a7 7 0 0 0-.095-1.21c.322-.777.97-1.696 2.23-1.696 1.524 0 2.265 1.02 2.265 3.116v12.972z"></path></svg></a><div class="aw h"><div class="ab ax ay az ba q bb bc"><div class="bl" aria-hidden="false" aria-describedby="searchResults" aria-labelledby="searchResults"></div><div class="bm bn ab"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M4.092 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0m6.95-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .79-.79l-3.73-3.73A8.05 8.05 0 0 0 11.042 3z" clip-rule="evenodd"></path></svg></div><input role="combobox" aria-controls="searchResults" aria-expanded="false" aria-label="search" data-testid="headerSearchInput" tabindex="0" class="ax bd be bf z bg bh bi bj bk" placeholder="Search" value=""/></div></div></div><div class="h k w ff fg"><div class="fh ab"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerWriteButton" rel="noopener follow" href="/m/signin?operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fnew-story&amp;source=---two_column_layout_nav-----------------------new_post_topnav-----------"><div class="be b bf z dt fi fj ab q fk fl"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-label="Write"><path fill="currentColor" d="M14 4a.5.5 0 0 0 0-1zm7 6a.5.5 0 0 0-1 0zm-7-7H4v1h10zM3 4v16h1V4zm1 17h16v-1H4zm17-1V10h-1v10zm-1 1a1 1 0 0 0 1-1h-1zM3 20a1 1 0 0 0 1 1v-1zM4 3a1 1 0 0 0-1 1h1z"></path><path stroke="currentColor" d="m17.5 4.5-8.458 8.458a.25.25 0 0 0-.06.098l-.824 2.47a.25.25 0 0 0 .316.316l2.47-.823a.25.25 0 0 0 .098-.06L19.5 6.5m-2-2 2.323-2.323a.25.25 0 0 1 .354 0l1.646 1.646a.25.25 0 0 1 0 .354L19.5 6.5m-2-2 2 2"></path></svg><div class="ds l">Write</div></div></a></span></div></div><div class="k j i d"><div class="fh ab"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSearchButton" rel="noopener follow" href="/search?source=---two_column_layout_nav----------------------------------"><div class="be b bf z dt fi fj ab q fk fl"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-label="Search"><path fill="currentColor" fill-rule="evenodd" d="M4.092 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0m6.95-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .79-.79l-3.73-3.73A8.05 8.05 0 0 0 11.042 3z" clip-rule="evenodd"></path></svg></div></a></div></div><div class="fh h k j"><div class="ab q"><p class="be b dw dx dy dz ea eb ec ed ee ef dt"><span><button class="be b dw dx eg dy dz eh ea eb ei ej ed ek el ef em eo ep eq er es et eu ev ew ex ey ez fa fb fc bl fd fe" data-testid="headerSignUpButton">Sign up</button></span></p><div class="aw l"><p class="be b dw dx dy dz ea eb ec ed ee ef dt"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSignInButton" rel="noopener follow" href="/m/signin?operation=login&amp;redirect=https%3A%2F%2Fmedium.com%2Fspark-nlp%2Fspark-nlp-and-mlflow-for-serialization-and-experiment-tracking-c4549827ece4&amp;source=post_page---two_column_layout_nav-----------------------global_nav-----------">Sign in</a></span></p></div></div></div><div class="l" aria-hidden="false"><button class="ax fm am ab q ao fn fo fp" aria-label="user options menu" data-testid="headerUserIcon"><div class="l fi"><img alt="" class="l fc bx by bz cw" src="https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png" width="32" height="32" loading="lazy" role="presentation"/><div class="fq bx l by bz fr n ax fs"></div></div></button></div></div></div><div class="l"><div class="ft fu fv fw fx l"><div class="ab ca"><div class="ch bg fy fz ga gb"></div></div><article><div class="l"><div class="l"><span class="l"></span><section><div><div class="fr gh gi gj gk gl"></div><div class="gm gn go gp gq"><div class="ab ca"><div class="ch bg fy fz ga gb"><div><h1 id="3668" class="pw-post-title gr gs gt be gu gv gw gx gy gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho hp hq hr hs ht bj" data-testid="storyTitle">Spark NLP and MLFlow for Serialization and Experiment Tracking</h1><div><div class="speechify-ignore ab co"><div class="speechify-ignore bg l"><div class="hu hv hw hx hy ab"><div><div class="ab hz"><a rel="noopener follow" href="/@jjmcarrascosa?source=post_page-----c4549827ece4--------------------------------"><div><div class="bl" aria-hidden="false"><div class="l ia ib bx ic id"><div class="l fi"><img alt="Jose J. Martinez" class="l fc bx dc dd cw" src="https://miro.medium.com/v2/resize:fill:88:88/1*HJWy2OxORWQKGdinLrCCmg.jpeg" width="44" height="44" loading="lazy" data-testid="authorPhoto"/><div class="ie bx l dc dd fr n if fs"></div></div></div></div></div></a><a href="https://medium.com/spark-nlp?source=post_page-----c4549827ece4--------------------------------" rel="noopener follow"><div class="ig ab fi"><div><div class="bl" aria-hidden="false"><div class="l ih ii bx ic ij"><div class="l fi"><img alt="spark-nlp" class="l fc bx bq ik cw" src="https://miro.medium.com/v2/resize:fill:48:48/1*NM-W9Li1MU8zNvfTT2Opkw.jpeg" width="24" height="24" loading="lazy" data-testid="publicationPhoto"/><div class="ie bx l bq ik fr n if fs"></div></div></div></div></div></div></a></div></div><div class="bm bg l"><div class="ab"><div style="flex:1"><span class="be b bf z bj"><div class="il ab q"><div class="ab q im"><div class="ab q"><div><div class="bl" aria-hidden="false"><p class="be b in io bj"><a class="af ag ah ai aj ak al am an ao ap aq ar ip" data-testid="authorName" rel="noopener follow" href="/@jjmcarrascosa?source=post_page-----c4549827ece4--------------------------------">Jose J. Martinez</a></p></div></div></div><span class="iq ir" aria-hidden="true"><span class="be b bf z dt">·</span></span><p class="be b in io dt"><span><a class="is it ah ai aj ak al am an ao ap aq ar ew iu iv" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe11aa5052863&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fspark-nlp%2Fspark-nlp-and-mlflow-for-serialization-and-experiment-tracking-c4549827ece4&amp;user=Jose+J.+Martinez&amp;userId=e11aa5052863&amp;source=post_page-e11aa5052863----c4549827ece4---------------------post_header-----------">Follow</a></span></p></div></div></span></div></div><div class="l iw"><span class="be b bf z dt"><div class="ab cm ix iy iz"><div class="ja jb ab"><div class="be b bf z dt ab jc"><span class="jd l iw">Published in</span><div><div class="l" aria-hidden="false"><a class="af ag ah ai aj ak al am an ao ap aq ar ip ab q" data-testid="publicationName" href="https://medium.com/spark-nlp?source=post_page-----c4549827ece4--------------------------------" rel="noopener follow"><p class="be b bf z je jf jg jh ji jj jk jl bj">spark-nlp</p></a></div></div></div><div class="h k"><span class="iq ir" aria-hidden="true"><span class="be b bf z dt">·</span></span></div></div><span class="be b bf z dt"><div class="ab ae"><span data-testid="storyReadTime">10 min read</span><div class="jm jn l" aria-hidden="true"><span class="l" aria-hidden="true"><span class="be b bf z dt">·</span></span></div><span data-testid="storyPublishDate">Dec 16, 2021</span></div></span></div></span></div></div></div><div class="ab co jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd"><div class="h k w ff fg q"><div class="kt l"><div class="ab q ku kv"><div class="pw-multi-vote-icon fi jd kw kx ky"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerClapButton" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fspark-nlp%2Fc4549827ece4&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fspark-nlp%2Fspark-nlp-and-mlflow-for-serialization-and-experiment-tracking-c4549827ece4&amp;user=Jose+J.+Martinez&amp;userId=e11aa5052863&amp;source=-----c4549827ece4---------------------clap_footer-----------"><div><div class="bl" aria-hidden="false"><div class="kz ao la lb lc ld am le lf lg ky"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l lh li lj lk ll lm ln"><p class="be b du z dt"><span class="lo">--</span></p></div></div></div><div><div class="bl" aria-hidden="false"><button class="ao kz lp lq ab q fj lr ls" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="lt"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"></path></svg></button></div></div></div><div class="ab q ke kf kg kh ki kj kk kl km kn ko kp kq kr ks"><div class="lu k j i d"></div><div class="h k"><div><div class="bl" aria-hidden="false"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerBookmarkButton" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc4549827ece4&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fspark-nlp%2Fspark-nlp-and-mlflow-for-serialization-and-experiment-tracking-c4549827ece4&amp;source=-----c4549827ece4---------------------bookmark_footer-----------"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="dt lv" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></a></span></div></div></div><div class="fc lw cm"><div class="l ae"><div class="ab ca"><div class="lx ly lz ma mb mc ch bg"><div class="ab"><div class="bl bg" aria-hidden="false"><div><div class="bl" aria-hidden="false"><button aria-label="Listen" data-testid="audioPlayButton" class="af fj ah ai aj ak al md an ao ap ew me mf ls mg mh mi mj mk s ml mm mn mo mp mq mr u ms mt mu"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M3 12a9 9 0 1 1 18 0 9 9 0 0 1-18 0m9-10C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2m3.376 10.416-4.599 3.066a.5.5 0 0 1-.777-.416V8.934a.5.5 0 0 1 .777-.416l4.599 3.066a.5.5 0 0 1 0 .832" clip-rule="evenodd"></path></svg><div class="j i d"><p class="be b bf z dt">Listen</p></div></button></div></div></div></div></div></div></div></div><div class="bl" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bl" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="headerSocialShareButton" class="af fj ah ai aj ak al md an ao ap ew me mf ls mg mh mi mj mk s ml mm mn mo mp mq mr u ms mt mu"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"></path></svg><div class="j i d"><p class="be b bf z dt">Share</p></div></button></div></div></div></div></div></div></div></div></div><figure class="my mz na nb nc nd mv mw paragraph-image"><div role="button" tabindex="0" class="ne nf fi ng bg nh"><div class="mv mw mx"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*3w3Cxo8ElFmAK7VM_jNxDA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*3w3Cxo8ElFmAK7VM_jNxDA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*3w3Cxo8ElFmAK7VM_jNxDA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*3w3Cxo8ElFmAK7VM_jNxDA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*3w3Cxo8ElFmAK7VM_jNxDA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*3w3Cxo8ElFmAK7VM_jNxDA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3w3Cxo8ElFmAK7VM_jNxDA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*3w3Cxo8ElFmAK7VM_jNxDA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*3w3Cxo8ElFmAK7VM_jNxDA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*3w3Cxo8ElFmAK7VM_jNxDA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*3w3Cxo8ElFmAK7VM_jNxDA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*3w3Cxo8ElFmAK7VM_jNxDA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*3w3Cxo8ElFmAK7VM_jNxDA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*3w3Cxo8ElFmAK7VM_jNxDA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bg mc ni c" width="700" height="504" loading="eager" role="presentation"/></picture></div></div></figure><p id="ec7d" class="pw-post-body-paragraph nj nk gt nl b nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og gm bj">In this article, we are going to describe how to use MLFlow for Serialization of Spark NLP models, and local and remote Experiment Tracking. This is the first article of the upcoming series of MLFlow, where we will be showcasing also the consumption of serialized Spark NLP models for inference, to come soon to Spark NLP channel on Medium.</p><h1 id="4b7e" class="oh oi gt be oj ok ol om on oo op oq or os ot ou ov ow ox oy oz pa pb pc pd pe bj">About MLFlow</h1><p id="5005" class="pw-post-body-paragraph nj nk gt nl b nm pf no np nq pg ns nt nu ph nw nx ny pi oa ob oc pj oe of og gm bj">Spark NLP uses Spark MLlib Pipelines, which are natively supported by MLFlow. MLFlow is, as stated in their <a class="af pk" href="https://mlflow.org/" rel="noopener ugc nofollow" target="_blank">official webpage</a>, an open-source platform for the machine learning lifecycle, that includes:</p><ul class=""><li id="f7f8" class="nj nk gt nl b nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og pl pm pn bj"><strong class="nl gu">Mlflow Tracking</strong>: Record and query experiments: code, data, config, and results</li><li id="c013" class="nj nk gt nl b nm po no np nq pp ns nt nu pq nw nx ny pr oa ob oc ps oe of og pl pm pn bj"><strong class="nl gu">MLflow Projects</strong>: Package data science code in a format to reproduce runs on any platform</li><li id="446d" class="nj nk gt nl b nm po no np nq pp ns nt nu pq nw nx ny pr oa ob oc ps oe of og pl pm pn bj"><strong class="nl gu">MLflow Models</strong>: Deploy machine learning models in diverse serving environments</li><li id="e5aa" class="nj nk gt nl b nm po no np nq pp ns nt nu pq nw nx ny pr oa ob oc ps oe of og pl pm pn bj"><strong class="nl gu">Model Registry</strong>: Store, annotate, discover, and manage models in a central repository</li></ul><p id="b3b9" class="pw-post-body-paragraph nj nk gt nl b nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og gm bj">MLFlow is also integrated into Databricks, so you will be able to track your experiments in any Databricks environment, and even use MLFLow Model Registry to serve models for production purposes, using the REST API (see section “Productionizing Spark NLP”).</p><p id="6acb" class="pw-post-body-paragraph nj nk gt nl b nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og gm bj">We will be using in this documentation Jupyter Notebook syntax.</p></div></div></div><div class="ab ca pt pu pv pw" role="separator"><span class="px bx bl py pz qa"></span><span class="px bx bl py pz qa"></span><span class="px bx bl py pz"></span></div><div class="gm gn go gp gq"><div class="ab ca"><div class="ch bg fy fz ga gb"><h1 id="63e9" class="oh oi gt be oj ok qb om on oo qc oq or os qd ou ov ow qe oy oz pa qf pc pd pe bj">Available configurations</h1><p id="7c64" class="pw-post-body-paragraph nj nk gt nl b nm pf no np nq pg ns nt nu ph nw nx ny pi oa ob oc pj oe of og gm bj">There are several ways of deploying an MLFlow Model Registry:</p><p id="7b87" class="pw-post-body-paragraph nj nk gt nl b nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og gm bj"><strong class="nl gu">Scenario 1: MLflow on localhost with no Tracking Server:</strong> This scenario uses a localhost folder (<code class="cw qg qh qi qj b">./mlruns</code> by default) to serialize and store your models, but there is no tracking server available (version tracking will be disabled).</p><figure class="ql qm qn qo qp nd mv mw paragraph-image"><div role="button" tabindex="0" class="ne nf fi ng bg nh"><div class="mv mw qk"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*YjwVfFwIttKYIg3_.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*YjwVfFwIttKYIg3_.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*YjwVfFwIttKYIg3_.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*YjwVfFwIttKYIg3_.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*YjwVfFwIttKYIg3_.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*YjwVfFwIttKYIg3_.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/0*YjwVfFwIttKYIg3_.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*YjwVfFwIttKYIg3_.png 640w, https://miro.medium.com/v2/resize:fit:720/0*YjwVfFwIttKYIg3_.png 720w, https://miro.medium.com/v2/resize:fit:750/0*YjwVfFwIttKYIg3_.png 750w, https://miro.medium.com/v2/resize:fit:786/0*YjwVfFwIttKYIg3_.png 786w, https://miro.medium.com/v2/resize:fit:828/0*YjwVfFwIttKYIg3_.png 828w, https://miro.medium.com/v2/resize:fit:1100/0*YjwVfFwIttKYIg3_.png 1100w, https://miro.medium.com/v2/resize:fit:1400/0*YjwVfFwIttKYIg3_.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bg mc ni c" width="700" height="394" loading="eager" role="presentation"/></picture></div></div></figure><p id="0a3e" class="pw-post-body-paragraph nj nk gt nl b nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og gm bj">We skip Scenario 2 (MLFlow on localhost with SQlite, but you can take a look at it <a class="af pk" href="https://www.mlflow.org/docs/latest/tracking.html#scenario-2-mlflow-on-localhost-with-sqlite" rel="noopener ugc nofollow" target="_blank">here</a>)</p><p id="3557" class="pw-post-body-paragraph nj nk gt nl b nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og gm bj"><strong class="nl gu">Scenario 3: MLflow on localhost with a Tracking Server</strong> This scenario uses a localhost folder (<code class="cw qg qh qi qj b">./mlruns</code> by default) to serialize and store your models, and a database as a Tracking Server. It uses SQLAlchemy under the hood, so the following databases are supported: <code class="cw qg qh qi qj b">mssql</code>, <code class="cw qg qh qi qj b">postgresql</code>, <code class="cw qg qh qi qj b">mysql</code>, <code class="cw qg qh qi qj b">sqlite</code>.</p><figure class="ql qm qn qo qp nd mv mw paragraph-image"><div role="button" tabindex="0" class="ne nf fi ng bg nh"><div class="mv mw qk"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*9ewyRtiEf-hg2A_v.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*9ewyRtiEf-hg2A_v.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*9ewyRtiEf-hg2A_v.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*9ewyRtiEf-hg2A_v.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*9ewyRtiEf-hg2A_v.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*9ewyRtiEf-hg2A_v.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/0*9ewyRtiEf-hg2A_v.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*9ewyRtiEf-hg2A_v.png 640w, https://miro.medium.com/v2/resize:fit:720/0*9ewyRtiEf-hg2A_v.png 720w, https://miro.medium.com/v2/resize:fit:750/0*9ewyRtiEf-hg2A_v.png 750w, https://miro.medium.com/v2/resize:fit:786/0*9ewyRtiEf-hg2A_v.png 786w, https://miro.medium.com/v2/resize:fit:828/0*9ewyRtiEf-hg2A_v.png 828w, https://miro.medium.com/v2/resize:fit:1100/0*9ewyRtiEf-hg2A_v.png 1100w, https://miro.medium.com/v2/resize:fit:1400/0*9ewyRtiEf-hg2A_v.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bg mc ni c" width="700" height="394" loading="lazy" role="presentation"/></picture></div></div></figure><p id="c316" class="pw-post-body-paragraph nj nk gt nl b nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og gm bj">We are going to show how to implement this scenario with a <code class="cw qg qh qi qj b">mysql</code> database.</p><p id="3a72" class="pw-post-body-paragraph nj nk gt nl b nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og gm bj"><strong class="nl gu">Scenario 4</strong>: MLflow on remote with a Tracking Server This scenario is a remote version of Scenario 3. It uses a remote S3 bucket to serialize and store your models, and a database as a Tracking Server. Again, it uses SQLAlchemy for the Tracking Server under the hood, so the following databases are supported: <code class="cw qg qh qi qj b">mssql</code>, <code class="cw qg qh qi qj b">postgresql</code>, <code class="cw qg qh qi qj b">mysql</code>, <code class="cw qg qh qi qj b">sqlite</code>. In this case, you can use any service as AWS RDS or Azure SQL Database.</p><figure class="ql qm qn qo qp nd mv mw paragraph-image"><div role="button" tabindex="0" class="ne nf fi ng bg nh"><div class="mv mw qk"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*l9uYeFVSDO4VAZZu.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*l9uYeFVSDO4VAZZu.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*l9uYeFVSDO4VAZZu.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*l9uYeFVSDO4VAZZu.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*l9uYeFVSDO4VAZZu.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*l9uYeFVSDO4VAZZu.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/0*l9uYeFVSDO4VAZZu.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*l9uYeFVSDO4VAZZu.png 640w, https://miro.medium.com/v2/resize:fit:720/0*l9uYeFVSDO4VAZZu.png 720w, https://miro.medium.com/v2/resize:fit:750/0*l9uYeFVSDO4VAZZu.png 750w, https://miro.medium.com/v2/resize:fit:786/0*l9uYeFVSDO4VAZZu.png 786w, https://miro.medium.com/v2/resize:fit:828/0*l9uYeFVSDO4VAZZu.png 828w, https://miro.medium.com/v2/resize:fit:1100/0*l9uYeFVSDO4VAZZu.png 1100w, https://miro.medium.com/v2/resize:fit:1400/0*l9uYeFVSDO4VAZZu.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bg mc ni c" width="700" height="394" loading="lazy" role="presentation"/></picture></div></div></figure></div></div></div><div class="ab ca pt pu pv pw" role="separator"><span class="px bx bl py pz qa"></span><span class="px bx bl py pz qa"></span><span class="px bx bl py pz"></span></div><div class="gm gn go gp gq"><div class="ab ca"><div class="ch bg fy fz ga gb"><h1 id="4762" class="oh oi gt be oj ok qb om on oo qc oq or os qd ou ov ow qe oy oz pa qf pc pd pe bj">Requirements</h1><p id="123a" class="pw-post-body-paragraph nj nk gt nl b nm pf no np nq pg ns nt nu ph nw nx ny pi oa ob oc pj oe of og gm bj">We are going to showcase Scenario 3. Since we want to have an Experiment Tracking Server with <code class="cw qg qh qi qj b">mysql</code>, we will need to install in our server the requirements for it.</p><p id="9b9e" class="pw-post-body-paragraph nj nk gt nl b nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og gm bj"><code class="cw qg qh qi qj b">!sudo apt-get install -y python-mysqldb mysql-server libmysqlclient-dev</code></p><p id="64c9" class="pw-post-body-paragraph nj nk gt nl b nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og gm bj">Also, let’s install a MySQL Python interface library, called <code class="cw qg qh qi qj b">pymsql</code>, to access <code class="cw qg qh qi qj b">mysql</code> databases.</p><p id="9367" class="pw-post-body-paragraph nj nk gt nl b nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og gm bj"><code class="cw qg qh qi qj b">!pip install mysqlclient pymysql</code></p><p id="6587" class="pw-post-body-paragraph nj nk gt nl b nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og gm bj">We will also need MLFlow (this example was tested with version 1.21.0)</p><p id="7280" class="pw-post-body-paragraph nj nk gt nl b nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og gm bj"><code class="cw qg qh qi qj b">!pip install mlflow</code></p><p id="d36a" class="pw-post-body-paragraph nj nk gt nl b nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og gm bj">Finally, make sure you follow the Spark NLP installation, available <a class="af pk" href="https://nlp.johnsnowlabs.com/docs/en/install#python" rel="noopener ugc nofollow" target="_blank">here</a></p></div></div></div><div class="ab ca pt pu pv pw" role="separator"><span class="px bx bl py pz qa"></span><span class="px bx bl py pz qa"></span><span class="px bx bl py pz"></span></div><div class="gm gn go gp gq"><div class="ab ca"><div class="ch bg fy fz ga gb"><h1 id="d433" class="oh oi gt be oj ok qb om on oo qc oq or os qd ou ov ow qe oy oz pa qf pc pd pe bj">Instantiating a MySQL database</h1><p id="15f8" class="pw-post-body-paragraph nj nk gt nl b nm pf no np nq pg ns nt nu ph nw nx ny pi oa ob oc pj oe of og gm bj">We are going to use Docker to instantiate a MySQL container with a persistent volume, but you can install it directly on your machine without Docker.</p><p id="a84d" class="pw-post-body-paragraph nj nk gt nl b nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og gm bj">To do that, we will need to have installed (feel free to skip this step if you will install MySql without Docker):</p><p id="d2bd" class="pw-post-body-paragraph nj nk gt nl b nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og gm bj">In our case, I used this <code class="cw qg qh qi qj b">docker-compose.yml</code> file to instantiate a <code class="cw qg qh qi qj b">mysql</code> database with a persistent volume:</p><pre class="ql qm qn qo qp qq qj qr qs ax qt bj"><span id="5fc9" class="qu oi gt qj b in qv qw l jc qx">version: &#x27;3&#x27;</span><span id="141e" class="qu oi gt qj b in qy qw l jc qx">services:<br/>  # MySQL<br/>  mflow_models:<br/>    container_name: mlflow_models<br/>    image: mysql:8.0<br/>    command: mysqld --default-authentication-plugin=mysql_native_password --character-set-server=utf8mb4 --collation-server=utf8mb4_unicode_ci<br/>    environment:<br/>      MYSQL_ROOT_PASSWORD: root<br/>      MYSQL_DATABASE: mlflow_models<br/>      MYSQL_USER: jsl<br/>      MYSQL_PASSWORD: passpass<br/>      MYSQL_ALLOW_EMPTY_PASSWORD: &quot;yes&quot;<br/>    ports:<br/>      - &#x27;3306:3306&#x27;<br/>    volumes:<br/>      - &#x27;./docker/db/data:/var/lib/mysql&#x27;<br/>      - &#x27;./docker/db/my.cnf:/etc/mysql/conf.d/my.cnf&#x27;<br/>      - &#x27;./docker/db/sql:/docker-entrypoint-initdb.d&#x27;</span></pre><p id="49b8" class="pw-post-body-paragraph nj nk gt nl b nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og gm bj">Just by executing the following command in the folder where your <code class="cw qg qh qi qj b">docker-compose.yml</code> the file is, you will have your MySQL engine, with a <code class="cw qg qh qi qj b">mlflow_models</code> a database running and prepared for MLFlow Experiment Tracking:<code class="cw qg qh qi qj b">!sudo docker-compose up -d .</code></p><p id="9ded" class="pw-post-body-paragraph nj nk gt nl b nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og gm bj">Make sure it’s running using the following command:</p><pre class="ql qm qn qo qp qq qj qr qs ax qt bj"><span id="c75e" class="qu oi gt qj b in qv qw l jc qx">!docker ps | grep -o mlflow_models`</span></pre></div></div></div><div class="ab ca pt pu pv pw" role="separator"><span class="px bx bl py pz qa"></span><span class="px bx bl py pz qa"></span><span class="px bx bl py pz"></span></div><div class="gm gn go gp gq"><div class="ab ca"><div class="ch bg fy fz ga gb"><h1 id="abf5" class="oh oi gt be oj ok qb om on oo qc oq or os qd ou ov ow qe oy oz pa qf pc pd pe bj">Connection String</h1><p id="09df" class="pw-post-body-paragraph nj nk gt nl b nm pf no np nq pg ns nt nu ph nw nx ny pi oa ob oc pj oe of og gm bj">You will need a connection string that will tell MLFlow (SQLAlchemy) how to reach that database.</p><p id="109c" class="pw-post-body-paragraph nj nk gt nl b nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og gm bj">Connections strings in SQLALchemy have this format:</p><p id="5ee8" class="pw-post-body-paragraph nj nk gt nl b nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og gm bj"><code class="cw qg qh qi qj b">&lt;dialect&gt;+&lt;driver&gt;://&lt;username&gt;:&lt;password&gt;@&lt;host&gt;:&lt;port&gt;/&lt;database&gt;</code></p><p id="9e2e" class="pw-post-body-paragraph nj nk gt nl b nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og gm bj">In our case, we declare a <code class="cw qg qh qi qj b">CONNECTION_STRING</code> var as:</p><p id="d02a" class="pw-post-body-paragraph nj nk gt nl b nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og gm bj"><code class="cw qg qh qi qj b">CONNECTION_STRING = f&quot;mysql+pymysql://root:root@localhost:3306/mlflow_models&quot;</code></p></div></div></div><div class="ab ca pt pu pv pw" role="separator"><span class="px bx bl py pz qa"></span><span class="px bx bl py pz qa"></span><span class="px bx bl py pz"></span></div><div class="gm gn go gp gq"><div class="ab ca"><div class="ch bg fy fz ga gb"><h1 id="fea5" class="oh oi gt be oj ok qb om on oo qc oq or os qd ou ov ow qe oy oz pa qf pc pd pe bj">Training</h1><p id="027b" class="pw-post-body-paragraph nj nk gt nl b nm pf no np nq pg ns nt nu ph nw nx ny pi oa ob oc pj oe of og gm bj">Let’s now import all the libraries we will need.</p><h2 id="dfc0" class="qu oi gt be oj qz ra dx on rb rc dz or nu rd re rf ny rg rh ri oc rj rk rl rm bj"><strong class="al">Generic Imports</strong></h2><pre class="ql qm qn qo qp qq qj qr qs ax qt bj"><span id="a433" class="qu oi gt qj b in qv qw l jc qx">import json<br/>import os<br/>from sklearn.metrics import classification_report<br/>import time<br/>import mlflow<br/>from mlflow.models.signature import infer_signature<br/>from urllib.parse import urlparse<br/>import pandas as pd<br/>import glob</span></pre><h2 id="dbd5" class="qu oi gt be oj qz ra dx on rb rc dz or nu rd re rf ny rg rh ri oc rj rk rl rm bj">Spark NLP Imports</h2><pre class="ql qm qn qo qp qq qj qr qs ax qt bj"><span id="a657" class="qu oi gt qj b in qv qw l jc qx">import sparknlp<br/>from sparknlp.base import *<br/>from sparknlp.annotator import *<br/>from sparknlp.training import *<br/>from pyspark.ml import Pipeline<br/>import pyspark.sql.functions as F<br/>from sparknlp.training import CoNLL<br/>from pyspark.sql import SparkSession</span></pre><h2 id="1dbc" class="qu oi gt be oj qz ra dx on rb rc dz or nu rd re rf ny rg rh ri oc rj rk rl rm bj">Setting the connection string in MLFlow</h2><p id="05c7" class="pw-post-body-paragraph nj nk gt nl b nm pf no np nq pg ns nt nu ph nw nx ny pi oa ob oc pj oe of og gm bj">Now that we have imported mlflow, let’s set the connection string we had prepared before.</p><pre class="ql qm qn qo qp qq qj qr qs ax qt bj"><span id="8686" class="qu oi gt qj b in qv qw l jc qx">mlflow.set_tracking_uri(CONNECTION_STRING)<br/>mlflow.get_tracking_uri() # This checks if it was set properly</span></pre><h2 id="b090" class="qu oi gt be oj qz ra dx on rb rc dz or nu rd re rf ny rg rh ri oc rj rk rl rm bj">Constant with pip_requirements</h2><p id="f4f3" class="pw-post-body-paragraph nj nk gt nl b nm pf no np nq pg ns nt nu ph nw nx ny pi oa ob oc pj oe of og gm bj">MLFLow requires either a <code class="cw qg qh qi qj b">conda_env</code> (conda environment) definition of the requirements of your models, or a <code class="cw qg qh qi qj b">pip_requirements</code> list with all pip libraries. We will use this second way, so let&#x27;s prepare the list with <code class="cw qg qh qi qj b">Spark NLP</code> and <code class="cw qg qh qi qj b">MLFlow</code>:</p><pre class="ql qm qn qo qp qq qj qr qs ax qt bj"><span id="f903" class="qu oi gt qj b in qv qw l jc qx">PIP_REQUIREMENTS = [f&quot;sparknlp=={sparknlp.version()}&quot;, f&quot;mlflow=={mlflow.__version__}&quot;] <br/>PIP_REQUIREMENTS # This checks if it was set properly</span></pre><h2 id="19c5" class="qu oi gt be oj qz ra dx on rb rc dz or nu rd re rf ny rg rh ri oc rj rk rl rm bj">Training a NERDLApproach()</h2><p id="0474" class="pw-post-body-paragraph nj nk gt nl b nm pf no np nq pg ns nt nu ph nw nx ny pi oa ob oc pj oe of og gm bj">We will be showcasing the serialization and experiment tracking of <code class="cw qg qh qi qj b">NERDLApproach()</code>.</p><h2 id="1912" class="qu oi gt be oj qz ra dx on rb rc dz or nu rd re rf ny rg rh ri oc rj rk rl rm bj"><strong class="al">Ner Log Parser Util</strong></h2><p id="4d17" class="pw-post-body-paragraph nj nk gt nl b nm pf no np nq pg ns nt nu ph nw nx ny pi oa ob oc pj oe of og gm bj">There is one specific util that is able to parse the log of that approach in order to extract the metrics and charts. Let’s get it.</p><p id="571b" class="pw-post-body-paragraph nj nk gt nl b nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og gm bj"><code class="cw qg qh qi qj b">!wget -q <a class="af pk" href="https://raw.githubusercontent.com/JohnSnowLabs/spark-nlp-workshop/master/tutorials/Certification_Trainings/Public/utils/ner_image_log_parser.py" rel="noopener ugc nofollow" target="_blank">https://raw.githubusercontent.com/JohnSnowLabs/spark-nlp-workshop/master/tutorials/Certification_Trainings/Public/utils/ner_image_log_parser.py</a></code></p><p id="2f49" class="pw-post-body-paragraph nj nk gt nl b nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og gm bj">Now, let’s import the library:</p><p id="dfad" class="pw-post-body-paragraph nj nk gt nl b nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og gm bj"><code class="cw qg qh qi qj b">import ner_image_log_parser</code></p><h2 id="7d78" class="qu oi gt be oj qz ra dx on rb rc dz or nu rd re rf ny rg rh ri oc rj rk rl rm bj"><strong class="al">Starting a SparkNLP session</strong></h2><p id="502d" class="pw-post-body-paragraph nj nk gt nl b nm pf no np nq pg ns nt nu ph nw nx ny pi oa ob oc pj oe of og gm bj">It’s important we create a Spark NLP Session using the Session Builder, since we need to specify the jars not only of Spark NLP, but also of MLFlow.</p><pre class="ql qm qn qo qp qq qj qr qs ax qt bj"><span id="289c" class="qu oi gt qj b in qv qw l jc qx">def start():<br/>    builder = SparkSession.builder \<br/>        .appName(&quot;Spark NLP Licensed&quot;) \<br/>        .master(&quot;local[80]&quot;) \<br/>        .config(&quot;spark.driver.memory&quot;, &quot;256G&quot;) \<br/>        .config(&quot;spark.serializer&quot;, &quot;org.apache.spark.serializer.KryoSerializer&quot;) \<br/>        .config(&quot;spark.kryoserializer.buffer.max&quot;, &quot;2000M&quot;) \<br/>        .config(&quot;spark.driver.maxResultSize&quot;,&quot;4000M&quot;) \<br/>        .config(&quot;spark.jars.packages&quot;, &quot;com.johnsnowlabs.nlp:spark-nlp_2.12:3.3.4,org.mlflow:mlflow-spark:1.21.0&quot;)<br/>      <br/>    return builder.getOrCreate()</span><span id="ebe4" class="qu oi gt qj b in qy qw l jc qx">spark = start()</span></pre><h2 id="1e01" class="qu oi gt be oj qz ra dx on rb rc dz or nu rd re rf ny rg rh ri oc rj rk rl rm bj">Training dataset preparation</h2><p id="7011" class="pw-post-body-paragraph nj nk gt nl b nm pf no np nq pg ns nt nu ph nw nx ny pi oa ob oc pj oe of og gm bj">Let’s download some training and test datasets:</p><pre class="ql qm qn qo qp qq qj qr qs ax qt bj"><span id="684d" class="qu oi gt qj b in qv qw l jc qx">!wget -q <a class="af pk" href="https://raw.githubusercontent.com/JohnSnowLabs/spark-nlp/master/src/test/resources/conll2003/eng.train" rel="noopener ugc nofollow" target="_blank">https://raw.githubusercontent.com/JohnSnowLabs/spark-nlp/master/src/test/resources/conll2003/eng.train</a><br/>!wget -q <a class="af pk" href="https://raw.githubusercontent.com/JohnSnowLabs/spark-nlp/master/src/test/resources/conll2003/eng.testa" rel="noopener ugc nofollow" target="_blank">https://raw.githubusercontent.com/JohnSnowLabs/spark-nlp/master/src/test/resources/conll2003/eng.testa</a></span><span id="cb14" class="qu oi gt qj b in qy qw l jc qx">TRAIN_DATASET = &quot;eng.train&quot;<br/>TEST_DATASET = &quot;eng.testa&quot;</span></pre><p id="b09b" class="pw-post-body-paragraph nj nk gt nl b nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og gm bj">Let’s read the training dataset:</p><pre class="ql qm qn qo qp qq qj qr qs ax qt bj"><span id="14e4" class="qu oi gt qj b in qv qw l jc qx">training_data = CoNLL().readDataset(spark, TRAIN_DATASET) training_data.show(3)</span></pre><p id="d466" class="pw-post-body-paragraph nj nk gt nl b nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og gm bj">Let’s get the size:</p><pre class="ql qm qn qo qp qq qj qr qs ax qt bj"><span id="0651" class="qu oi gt qj b in qv qw l jc qx">%%time TRAINING_SIZE = training_data.count() TRAINING_SIZE</span></pre><h2 id="da14" class="qu oi gt be oj qz ra dx on rb rc dz or nu rd re rf ny rg rh ri oc rj rk rl rm bj">Hyperparameters configuration</h2><p id="093b" class="pw-post-body-paragraph nj nk gt nl b nm pf no np nq pg ns nt nu ph nw nx ny pi oa ob oc pj oe of og gm bj">Let’s configure our hyperparameter values.</p><pre class="ql qm qn qo qp qq qj qr qs ax qt bj"><span id="b3fc" class="qu oi gt qj b in qv qw l jc qx">MODEL_NAME = &#x27;&#x27; # Add your model name here. Example: clinical_ner<br/>EXPERIMENT_NAME = &#x27;&#x27; # Add your experiment name here. Example: testing_dropout<br/>OUTPUT_DIR = f&quot;{MODEL_NAME}_{EXPERIMENT_NAME}_output&quot; # Output folder of all your model artifacts<br/>MODEL_DIR = f&quot;model&quot; # Name of the folder where the MLFlow model will be stored</span><span id="cf68" class="qu oi gt qj b in qy qw l jc qx">MAX_EPOCHS = 10 # Adapt me to your experiment<br/>LEARNING_RATE = 0.003 # Adapt me to your experiment<br/>BATCH_SIZE = 2048 # Adapt me to your experiment<br/>RANDOM_SEED = 0 # Adapt me to your experiment<br/>VALIDATION_SPLIT = 0.1 # Adapt me to your experiment</span></pre><h2 id="e17a" class="qu oi gt be oj qz ra dx on rb rc dz or nu rd re rf ny rg rh ri oc rj rk rl rm bj">Creating the experiment</h2><p id="a521" class="pw-post-body-paragraph nj nk gt nl b nm pf no np nq pg ns nt nu ph nw nx ny pi oa ob oc pj oe of og gm bj">Now, we are ready to instantiate an experiment in MLFlow</p><pre class="ql qm qn qo qp qq qj qr qs ax qt bj"><span id="88d2" class="qu oi gt qj b in qv qw l jc qx">EXPERIMENT_ID = mlflow.create_experiment(f&quot;{MODEL_NAME}_{EXPERIMENT_NAME}&quot;)</span></pre><p id="4f09" class="pw-post-body-paragraph nj nk gt nl b nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og gm bj">Each time you want to test a different thing, change the EXPERIMENT_NAME and rerun the line above to create a new entry in the experiment. By changing the experiment name, a new experiment ID will be generated. Each experiment ID groups runs in separate folder inside <code class="cw qg qh qi qj b">./mlruns</code>.</p><h2 id="448c" class="qu oi gt be oj qz ra dx on rb rc dz or nu rd re rf ny rg rh ri oc rj rk rl rm bj">Pipeline creation</h2><pre class="ql qm qn qo qp qq qj qr qs ax qt bj"><span id="bd4c" class="qu oi gt qj b in qv qw l jc qx">document = DocumentAssembler()\<br/>        .setInputCol(&quot;text&quot;)\<br/>        .setOutputCol(&quot;document&quot;)</span><span id="7af1" class="qu oi gt qj b in qy qw l jc qx">sentence = SentenceDetector()\<br/>        .setInputCols([&#x27;document&#x27;])\<br/>        .setOutputCol(&#x27;sentence&#x27;)</span><span id="fa82" class="qu oi gt qj b in qy qw l jc qx">token = Tokenizer()\<br/>        .setInputCols([&#x27;sentence&#x27;])\<br/>        .setOutputCol(&#x27;token&#x27;)</span><span id="9955" class="qu oi gt qj b in qy qw l jc qx">embeddings = BertEmbeddings.pretrained(&quot;bert_base_cased&quot;, &quot;en&quot;) \<br/>      .setInputCols(&quot;sentence&quot;, &quot;token&quot;) \<br/>      .setOutputCol(&quot;embeddings&quot;)</span><span id="df50" class="qu oi gt qj b in qy qw l jc qx">ner_approach = NerDLApproach()\<br/>      .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;embeddings&quot;])\<br/>      .setLabelColumn(&quot;label&quot;)\<br/>      .setOutputCol(&quot;ner&quot;)\<br/>      .setMaxEpochs(MAX_EPOCHS)\<br/>      .setLr(LEARNING_RATE)\<br/>      .setBatchSize(BATCH_SIZE)\<br/>      .setRandomSeed(RANDOM_SEED)\<br/>      .setVerbose(1)\<br/>      .setEnableOutputLogs(True)\<br/>      .setIncludeConfidence(True)\<br/>      .setIncludeAllConfidenceScores(True)\<br/>      .setEvaluationLogExtended(True)\<br/>      .setOutputLogsPath(OUTPUT_DIR)\<br/>      .setValidationSplit(VALIDATION_SPLIT)</span></pre><p id="bb79" class="pw-post-body-paragraph nj nk gt nl b nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og gm bj">Let’s create a preprocessing pipeline without the NerDLApproach():</p><pre class="ql qm qn qo qp qq qj qr qs ax qt bj"><span id="34de" class="qu oi gt qj b in qv qw l jc qx">ner_preprocessing_pipeline = Pipeline(stages=[<br/>    document,<br/>    sentence,<br/>    token,<br/>    embeddings<br/> ])</span></pre><p id="e942" class="pw-post-body-paragraph nj nk gt nl b nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og gm bj">And a training pipeline with it:</p><pre class="ql qm qn qo qp qq qj qr qs ax qt bj"><span id="9eda" class="qu oi gt qj b in qv qw l jc qx">ner_training_pipeline = Pipeline(stages = ner_preprocessing_pipeline.getStages() + [ner_approach])</span></pre><h1 id="312b" class="oh oi gt be oj ok ol om on oo op oq or os ot ou ov ow ox oy oz pa pb pc pd pe bj">Inference</h1><p id="7ccc" class="pw-post-body-paragraph nj nk gt nl b nm pf no np nq pg ns nt nu ph nw nx ny pi oa ob oc pj oe of og gm bj">Now, let’s prepare the inference as well since we will train and infer afterwards, and store all the results of training and inference as artefacts in our MLFlow object.</p><h2 id="9975" class="qu oi gt be oj qz ra dx on rb rc dz or nu rd re rf ny rg rh ri oc rj rk rl rm bj">Test dataset preparation</h2><pre class="ql qm qn qo qp qq qj qr qs ax qt bj"><span id="6f0d" class="qu oi gt qj b in qv qw l jc qx">test_data = CoNLL().readDataset(spark, TEST_DATASET)</span></pre><h2 id="d84f" class="qu oi gt be oj qz ra dx on rb rc dz or nu rd re rf ny rg rh ri oc rj rk rl rm bj">Setting the name of the inference objects</h2><pre class="ql qm qn qo qp qq qj qr qs ax qt bj"><span id="53e6" class="qu oi gt qj b in qv qw l jc qx">INFERENCE_NAME = &quot;inference.parquet&quot; # This is the name of the results inference on the test dataset, serialized in parquet,</span><span id="00b4" class="qu oi gt qj b in qy qw l jc qx">CLASSIFICATION_REPORT_LOG_NAME = &quot;classification_report.txt&quot; # Name of the classification report from scikit-learn on Ner Entities</span><span id="4503" class="qu oi gt qj b in qy qw l jc qx">PREC_REC_F1_NAME = &quot;precrecf1.jpg&quot; # Name of the precision-recall-f1 file</span><span id="f529" class="qu oi gt qj b in qy qw l jc qx">MACRO_MICRO_AVG_NAME = &quot;macromicroavg.jpg&quot; # Name of the macro-micro-average file</span><span id="51ab" class="qu oi gt qj b in qy qw l jc qx">LOSS_NAME = &quot;loss.jpg&quot; # Name of the loss plot file</span></pre><h1 id="03a6" class="oh oi gt be oj ok ol om on oo op oq or os ot ou ov ow ox oy oz pa pb pc pd pe bj">Now, let’s run the experiment!</h1><p id="9c29" class="pw-post-body-paragraph nj nk gt nl b nm pf no np nq pg ns nt nu ph nw nx ny pi oa ob oc pj oe of og gm bj">The experiment has already been created before (see “<em class="rn">Creating the experiment</em>” section). So we take the ID and start a run. Each time you run execute this cell, you will get a different run for the same experiment. If you want to change the experiment id (and name), go back to “Hyperparameters configuration”. As mentioned before, by changing the experiment name, a new experiment ID will be generated. Each experiment ID groups all runs in separates folder inside <code class="cw qg qh qi qj b">./mlruns</code>.</p><pre class="ql qm qn qo qp qq qj qr qs ax qt bj"><span id="2d14" class="qu oi gt qj b in qv qw l jc qx">with mlflow.start_run(experiment_id=EXPERIMENT_ID) as run:<br/>    <br/>    # Printing RUN and EXPERIMENT ID<br/> # ==============================<br/>    print(f&quot;Model name: {MODEL_NAME}&quot;)<br/>    RUN_ID = run.info.run_id<br/>    print(f&quot;Run id: {RUN_ID}&quot;)<br/>    EXPERIMENT_ID = run.info.experiment_id<br/>    print(f&quot;Experiment id: {EXPERIMENT_ID}&quot;)    <br/>    <br/>    # Training the model<br/> # ==================<br/>    print(&quot;Starting training...&quot;)<br/>    start = time.time()<br/>    ner_model = ner_training_pipeline.fit(training_data)<br/>    end = time.time()<br/>    ELAPSED_SEC_TRAINING = end - start<br/>    print(&quot;- Finished!&quot;)<br/>    <br/>    # Saving the model in TensorFlow (ready to be loaded using NerDLModel.load)<br/> # ============================== <br/>    print(&quot;Saving the model...&quot;)<br/>    ner_model.stages[-1].write().overwrite().save(f&quot;{OUTPUT_DIR}/{MODEL_DIR}/{MODEL_NAME}&quot;)<br/>    print(&quot;- Finished!&quot;)<br/>    <br/>    # Loading the model (to check everything worked)<br/> # ==============================<br/>    print(&quot;Loading back the model...&quot;)<br/>    loaded_ner_model = NerDLModel.load(f&quot;{OUTPUT_DIR}/{MODEL_DIR}/{MODEL_NAME}&quot;)\<br/>        .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;embeddings&quot;])\<br/>        .setOutputCol(&quot;ner&quot;)<br/>    <br/> # Creating the inference pipeline with the loaded model<br/> # ==============================<br/>    ner_prediction_pipeline = Pipeline(stages = ner_preprocessing_pipeline.getStages() + [loaded_ner_model])<br/>    <br/>    # Triggering inference<br/> # ==============================<br/>    print(&quot;Starting inference...&quot;)<br/>    prediction_data = spark.createDataFrame([[&quot;&quot;]]).toDF(&quot;text&quot;)<br/>    prediction_model = ner_prediction_pipeline.fit(prediction_data)<br/>    start = time.time()<br/>    prediction_model.transform(test_data).write.mode(&#x27;overwrite&#x27;).parquet(f&quot;{OUTPUT_DIR}/{INFERENCE_NAME}&quot;)<br/>    end = time.time()<br/>    ELAPSED_SEC_INFERENCE = end - start<br/>    print(&quot;- Finished!&quot;)<br/>    <br/>    # Calculating NER metrics from logs using scikit-learn &#x27;classification_report&#x27;<br/> # ==============================<br/>    print(&quot;Starting metric calculation...&quot;)<br/>    predictions = spark.read.parquet(f&quot;{OUTPUT_DIR}/{INFERENCE_NAME}&quot;)<br/>    preds_df = predictions.select(F.explode(F.arrays_zip(&#x27;token.result&#x27;,&#x27;label.result&#x27;,&#x27;ner.result&#x27;)).alias(&quot;cols&quot;)) \<br/>                      .select(F.expr(&quot;cols[&#x27;0&#x27;]&quot;).alias(&quot;token&quot;),<br/>                              F.expr(&quot;cols[&#x27;1&#x27;]&quot;).alias(&quot;ground_truth&quot;),<br/>                              F.expr(&quot;cols[&#x27;2&#x27;]&quot;).alias(&quot;prediction&quot;)).toPandas()<br/>    preds_df = preds_df.fillna(value=&#x27;O&#x27;)<br/>    with open(f&#x27;{OUTPUT_DIR}/{CLASSIFICATION_REPORT_LOG_NAME}&#x27;, &#x27;w&#x27;) as f:    <br/>        metrics = classification_report(preds_df[&#x27;ground_truth&#x27;], preds_df[&#x27;prediction&#x27;])<br/>        f.write(metrics)<br/>    <br/>    metrics_dict = classification_report(preds_df[&#x27;ground_truth&#x27;], preds_df[&#x27;prediction&#x27;], output_dict=True)<br/>    print(&quot;- Finished!&quot;)<br/>    <br/>    # Printing metrics<br/> # ==============================<br/>    print(f&quot;Training dataset size: {TRAINING_SIZE}&quot;)    <br/>    print(f&quot;Training time (sec): {ELAPSED_SEC_TRAINING}&quot;)<br/>    print(f&quot;Inference dataset size: {TEST_SIZE}&quot;)<br/>    print(f&quot;Inference time (sec): {ELAPSED_SEC_INFERENCE}&quot;)<br/>    print(f&quot;Metrics:\n&quot;)<br/>    print(metrics)<br/>    <br/>    # Logging all our params, metrics, charts and artifacts using MLFlow<br/> # - log_param: logs a configuration param<br/> # - log_artifacts: logs a folder and all its files<br/> # - log_artifact: adds a file<br/> # - log_metric: logs a metric, what allows you use the MLFlow UI to visually compare results<br/> # ==============================<br/>    print(&quot;Logging params, artifacts, metrics and charts in MLFlow&quot;)<br/>    mlflow.log_param(&quot;training_size&quot;, TRAINING_SIZE)<br/>    mlflow.log_param(&quot;training_time&quot;, ELAPSED_SEC_TRAINING)<br/>    mlflow.log_param(&quot;model_name&quot;, MODEL_NAME)<br/>    mlflow.log_param(&quot;test_size&quot;, TEST_SIZE)<br/>    mlflow.log_param(&quot;test_time&quot;, ELAPSED_SEC_INFERENCE)<br/>    mlflow.log_param(&quot;run_id&quot;, RUN_ID)<br/>    mlflow.log_param(&quot;max_epochs&quot;, MAX_EPOCHS)<br/> mlflow.log_param(&quot;learning_rate&quot;, LEARNING_RATE)<br/> mlflow.log_param(&quot;batch_size&quot;, BATCH_SIZE)<br/> mlflow.log_param(&quot;random_seed&quot;, RANDOM_SEED)<br/> mlflow.log_param(&quot;validation_split&quot;, VALIDATION_SPLIT)<br/> <br/>    for file in glob.glob(f&quot;{OUTPUT_DIR}/*.log&quot;):<br/>        images = {}<br/>        images.update(ner_image_log_parser.get_charts(file, img_prec_rec_f1_path=f&quot;{OUTPUT_DIR}/{PREC_REC_F1_NAME}&quot;, <br/>                                  img_macro_micro_avg_path=f&quot;{OUTPUT_DIR}/{MACRO_MICRO_AVG_NAME}&quot;))<br/>        images.update(ner_image_log_parser.loss_plot(file, img_loss_path=f&quot;{OUTPUT_DIR}/{LOSS_NAME}&quot;))<br/>    <br/>    mlflow.log_artifacts(OUTPUT_DIR)<br/>    mlflow.log_artifact(TRAIN_DATASET)<br/>    mlflow.log_artifact(TEST_DATASET)<br/>                                  <br/>    for k,v in metrics_dict.items():<br/>        if isinstance(v, dict):<br/>            for kv, vv in v.items():<br/>                mlflow.log_metric(f&quot;{k}_{kv}&quot;, vv)<br/>        else:<br/>            mlflow.log_metric(k, v)  <br/>    print(&quot;- Finished!&quot;)<br/>            <br/>    print(&quot;Logging the model in MLFlow&quot;)    <br/> # ==============================<br/>    # Logging the model to be explored in the MLFLow UI<br/>    tracking_url_type_store = urlparse(mlflow.get_tracking_uri()).scheme<br/>    # Model registry does not work with file store<br/>    if tracking_url_type_store != &quot;file&quot;:</span><span id="fdd9" class="qu oi gt qj b in qy qw l jc qx"># Register the model<br/>        # There are other ways to use the Model Registry, which depends on the use case,<br/>        # please refer to the doc for more information:<br/>        # <a class="af pk" href="https://mlflow.org/docs/latest/model-registry.html#api-workflow" rel="noopener ugc nofollow" target="_blank">https://mlflow.org/docs/latest/model-registry.html#api-workflow</a><br/>        mlflow.spark.log_model(ner_model, f&quot;{MODEL_NAME}_{EXPERIMENT_ID}_{RUN_ID}&quot;, registered_model_name=MODEL_NAME, pip_requirements=PIP_REQUIREMENTS)<br/>    else:<br/>        mlflow.spark.log_model(ner_model, f&quot;{MODEL_NAME}_{EXPERIMENT_ID}_{RUN_ID}&quot;, pip_requirements=PIP_REQUIREMENTS)<br/>    print(&quot;- Finished!&quot;)<br/>    <br/>    # Saving the model, in case you want to export it<br/> # ==============================<br/>    print(&quot;Saving the model...&quot;)<br/>    input_example = predictions.select(&quot;sentence&quot;, &quot;token&quot;, &quot;embeddings&quot;).limit(1).toPandas()<br/>    mlflow.spark.save_model(loaded_ner_model, MODEL_NAME, pip_requirements=PIP_REQUIREMENTS, input_example=input_example)<br/>    print(&quot;- Finished!&quot;)</span></pre><p id="833c" class="pw-post-body-paragraph nj nk gt nl b nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og gm bj">This is an example of the output generated:</p><pre class="ql qm qn qo qp qq qj qr qs ax qt bj"><span id="303f" class="qu oi gt qj b in qv qw l jc qx">Model name: NER_base_2048_mlflow<br/>Run id: 5f8601fbfc664b3b91c7c61cde31e16d<br/>Experiment id: 2<br/>Starting training...<br/>- Finished!<br/>Saving the model...<br/>- Finished!<br/>Loading back the model...<br/>Starting inference...<br/>- Finished!<br/>Starting metric calculation...<br/>- Finished!<br/>Training dataset size: 14041<br/>Training time (sec): 12000.3835768699646<br/>Inference dataset size: 3250<br/>Inference time (sec): 2900.713200330734253<br/>Metrics:</span><span id="fd7e" class="qu oi gt qj b in qy qw l jc qx">precision    recall  f1-score   support</span><span id="0a43" class="qu oi gt qj b in qy qw l jc qx">       B-LOC       0.85      0.82      0.83      1837<br/>      B-MISC       0.86      0.83      0.81       922<br/>       B-ORG       0.81      0.83      0.82      1341<br/>       B-PER       0.86      0.81      0.80      1842<br/>       I-LOC       0.80      0.80      0.80       257<br/>      I-MISC       0.80      0.80      0.80       346<br/>       I-ORG       0.83      0.89      0.80       751<br/>       I-PER       0.86      0.83      0.82      1307<br/>           O       0.81      0.98      0.84     43792</span><span id="ad39" class="qu oi gt qj b in qy qw l jc qx">accuracy                               0.87     52395<br/>   macro avg       0.88      0.83      0.88     52395<br/>weighted avg       0.84      0.87      0.85     52395</span><span id="cb1c" class="qu oi gt qj b in qy qw l jc qx">Logging params, artifacts, metrics and charts in MLFlow<br/>- Finished!<br/>Logging the model in MLFlow<br/>Registered model &#x27;NER_base_2048_mlflow&#x27; already exists. Creating a new version of this model...<br/>2021/11/25 11:51:24 INFO mlflow.tracking._model_registry.client: Waiting up to 300 seconds for model version to finish creation.                     Model name: NER_base_2048_mlflow, version 2<br/>Created version &#x27;2&#x27; of model &#x27;NER_base_2048_mlflow&#x27;.<br/>- Finished!<br/>Saving the model...<br/>- Finished!</span></pre></div></div></div><div class="ab ca pt pu pv pw" role="separator"><span class="px bx bl py pz qa"></span><span class="px bx bl py pz qa"></span><span class="px bx bl py pz"></span></div><div class="gm gn go gp gq"><div class="ab ca"><div class="ch bg fy fz ga gb"><h1 id="585f" class="oh oi gt be oj ok qb om on oo qc oq or os qd ou ov ow qe oy oz pa qf pc pd pe bj">MLFLow UI to check results</h1><p id="becd" class="pw-post-body-paragraph nj nk gt nl b nm pf no np nq pg ns nt nu ph nw nx ny pi oa ob oc pj oe of og gm bj">Now, we just need to launch the MLFLow UI to see:</p><ul class=""><li id="5681" class="nj nk gt nl b nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og pl pm pn bj">All the experiments</li><li id="d68d" class="nj nk gt nl b nm po no np nq pp ns nt nu pq nw nx ny pr oa ob oc ps oe of og pl pm pn bj">All the runs in each experiment</li><li id="60d3" class="nj nk gt nl b nm po no np nq pp ns nt nu pq nw nx ny pr oa ob oc ps oe of og pl pm pn bj">The automatic versioning in the Tracking Server database in MySQL</li><li id="f04c" class="nj nk gt nl b nm po no np nq pp ns nt nu pq nw nx ny pr oa ob oc ps oe of og pl pm pn bj">THe MLFlow model, and the TensorFlow version as well</li><li id="8301" class="nj nk gt nl b nm po no np nq pp ns nt nu pq nw nx ny pr oa ob oc ps oe of og pl pm pn bj">The UI for comparing the metrics we set using log_metrics</li><li id="e671" class="nj nk gt nl b nm po no np nq pp ns nt nu pq nw nx ny pr oa ob oc ps oe of og pl pm pn bj">The UI for visualizing the image artifacts we have logged (charts)</li><li id="9a89" class="nj nk gt nl b nm po no np nq pp ns nt nu pq nw nx ny pr oa ob oc ps oe of og pl pm pn bj">etc</li></ul><pre class="ql qm qn qo qp qq qj qr qs ax qt bj"><span id="fe7b" class="qu oi gt qj b in qv qw l jc qx">!mlflow ui --backend-store-uri $CONNECTION_STRING</span></pre><figure class="ql qm qn qo qp nd mv mw paragraph-image"><div class="mv mw ro"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*Njzl0FlzFXOZ11f8.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*Njzl0FlzFXOZ11f8.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*Njzl0FlzFXOZ11f8.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*Njzl0FlzFXOZ11f8.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*Njzl0FlzFXOZ11f8.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*Njzl0FlzFXOZ11f8.png 1100w, https://miro.medium.com/v2/resize:fit:888/format:webp/0*Njzl0FlzFXOZ11f8.png 888w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 444px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*Njzl0FlzFXOZ11f8.png 640w, https://miro.medium.com/v2/resize:fit:720/0*Njzl0FlzFXOZ11f8.png 720w, https://miro.medium.com/v2/resize:fit:750/0*Njzl0FlzFXOZ11f8.png 750w, https://miro.medium.com/v2/resize:fit:786/0*Njzl0FlzFXOZ11f8.png 786w, https://miro.medium.com/v2/resize:fit:828/0*Njzl0FlzFXOZ11f8.png 828w, https://miro.medium.com/v2/resize:fit:1100/0*Njzl0FlzFXOZ11f8.png 1100w, https://miro.medium.com/v2/resize:fit:888/0*Njzl0FlzFXOZ11f8.png 888w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 444px"/><img alt="" class="bg mc ni c" width="444" height="388" loading="lazy" role="presentation"/></picture></div></figure><figure class="ql qm qn qo qp nd mv mw paragraph-image"><div role="button" tabindex="0" class="ne nf fi ng bg nh"><div class="mv mw rp"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*TqyAIxFDM-iDYAr5.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*TqyAIxFDM-iDYAr5.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*TqyAIxFDM-iDYAr5.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*TqyAIxFDM-iDYAr5.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*TqyAIxFDM-iDYAr5.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*TqyAIxFDM-iDYAr5.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/0*TqyAIxFDM-iDYAr5.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*TqyAIxFDM-iDYAr5.png 640w, https://miro.medium.com/v2/resize:fit:720/0*TqyAIxFDM-iDYAr5.png 720w, https://miro.medium.com/v2/resize:fit:750/0*TqyAIxFDM-iDYAr5.png 750w, https://miro.medium.com/v2/resize:fit:786/0*TqyAIxFDM-iDYAr5.png 786w, https://miro.medium.com/v2/resize:fit:828/0*TqyAIxFDM-iDYAr5.png 828w, https://miro.medium.com/v2/resize:fit:1100/0*TqyAIxFDM-iDYAr5.png 1100w, https://miro.medium.com/v2/resize:fit:1400/0*TqyAIxFDM-iDYAr5.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bg mc ni c" width="700" height="285" loading="lazy" role="presentation"/></picture></div></div></figure><figure class="ql qm qn qo qp nd mv mw paragraph-image"><div class="mv mw rq"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*Z8MbcjeeuO0eTGS_.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*Z8MbcjeeuO0eTGS_.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*Z8MbcjeeuO0eTGS_.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*Z8MbcjeeuO0eTGS_.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*Z8MbcjeeuO0eTGS_.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*Z8MbcjeeuO0eTGS_.png 1100w, https://miro.medium.com/v2/resize:fit:1378/format:webp/0*Z8MbcjeeuO0eTGS_.png 1378w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 689px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*Z8MbcjeeuO0eTGS_.png 640w, https://miro.medium.com/v2/resize:fit:720/0*Z8MbcjeeuO0eTGS_.png 720w, https://miro.medium.com/v2/resize:fit:750/0*Z8MbcjeeuO0eTGS_.png 750w, https://miro.medium.com/v2/resize:fit:786/0*Z8MbcjeeuO0eTGS_.png 786w, https://miro.medium.com/v2/resize:fit:828/0*Z8MbcjeeuO0eTGS_.png 828w, https://miro.medium.com/v2/resize:fit:1100/0*Z8MbcjeeuO0eTGS_.png 1100w, https://miro.medium.com/v2/resize:fit:1378/0*Z8MbcjeeuO0eTGS_.png 1378w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 689px"/><img alt="" class="bg mc ni c" width="689" height="627" loading="lazy" role="presentation"/></picture></div></figure></div></div></div><div class="ab ca pt pu pv pw" role="separator"><span class="px bx bl py pz qa"></span><span class="px bx bl py pz qa"></span><span class="px bx bl py pz"></span></div><div class="gm gn go gp gq"><div class="ab ca"><div class="ch bg fy fz ga gb"><p id="b768" class="pw-post-body-paragraph nj nk gt nl b nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og gm bj">Any question? Email us at support@johnsnowlabs.com or visit <a class="af pk" href="https://www.johnsnowlabs.com/" rel="noopener ugc nofollow" target="_blank">https://www.johnsnowlabs.com/</a> and <a class="af pk" href="https://www.johnsnowlabs.com/" rel="noopener ugc nofollow" target="_blank">https://nlp.www.johnsnowlabs.com/</a> for technical documentation.</p></div></div></div></div></section></div></div></article></div><div class="ab ca"><div class="ch bg fy fz ga gb"><div class="rr rs ab iz"><div class="rt ab"><a class="ru ax am ao" rel="noopener follow" href="/tag/nlp?source=post_page-----c4549827ece4---------------nlp-----------------"><div class="rv fi cw rw gd rx ry be b bf z bj rz">NLP</div></a></div><div class="rt ab"><a class="ru ax am ao" rel="noopener follow" href="/tag/spark-nlp?source=post_page-----c4549827ece4---------------spark_nlp-----------------"><div class="rv fi cw rw gd rx ry be b bf z bj rz">Spark Nlp</div></a></div><div class="rt ab"><a class="ru ax am ao" rel="noopener follow" href="/tag/mlflow?source=post_page-----c4549827ece4---------------mlflow-----------------"><div class="rv fi cw rw gd rx ry be b bf z bj rz">Mlflow</div></a></div><div class="rt ab"><a class="ru ax am ao" rel="noopener follow" href="/tag/experiment-tracking?source=post_page-----c4549827ece4---------------experiment_tracking-----------------"><div class="rv fi cw rw gd rx ry be b bf z bj rz">Experiment Tracking</div></a></div><div class="rt ab"><a class="ru ax am ao" rel="noopener follow" href="/tag/ai?source=post_page-----c4549827ece4---------------ai-----------------"><div class="rv fi cw rw gd rx ry be b bf z bj rz">AI</div></a></div></div></div></div><div class="l"></div><footer class="sa sb sc sd se sf sg sh si ab q sj ij c"><div class="l ae"><div class="ab ca"><div class="ch bg fy fz ga gb"><div class="ab co sk"><div class="ab q ku"><div class="sl l"><span class="l sm sn so e d"><div class="ab q ku kv"><div class="pw-multi-vote-icon fi jd kw kx ky"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerClapButton" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fspark-nlp%2Fc4549827ece4&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fspark-nlp%2Fspark-nlp-and-mlflow-for-serialization-and-experiment-tracking-c4549827ece4&amp;user=Jose+J.+Martinez&amp;userId=e11aa5052863&amp;source=-----c4549827ece4---------------------clap_footer-----------"><div><div class="bl" aria-hidden="false"><div class="kz ao la lb lc ld am le lf lg ky"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l lh li lj lk ll lm ln"><p class="be b du z dt"><span class="lo">--</span></p></div></div></span><span class="l h g f sp sq"><div class="ab q ku kv"><div class="pw-multi-vote-icon fi jd kw kx ky"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerClapButton" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fspark-nlp%2Fc4549827ece4&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fspark-nlp%2Fspark-nlp-and-mlflow-for-serialization-and-experiment-tracking-c4549827ece4&amp;user=Jose+J.+Martinez&amp;userId=e11aa5052863&amp;source=-----c4549827ece4---------------------clap_footer-----------"><div><div class="bl" aria-hidden="false"><div class="kz ao la lb lc ld am le lf lg ky"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l lh li lj lk ll lm ln"><p class="be b du z dt"><span class="lo">--</span></p></div></div></span></div><div class="bp ab"><div><div class="bl" aria-hidden="false"><button class="ao kz lp lq ab q fj lr ls" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="lt"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"></path></svg></button></div></div></div></div><div class="ab q"><div class="qa l iw"><div><div class="bl" aria-hidden="false"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerBookmarkButton" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc4549827ece4&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fspark-nlp%2Fspark-nlp-and-mlflow-for-serialization-and-experiment-tracking-c4549827ece4&amp;source=--------------------------bookmark_footer-----------"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="dt lv" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></a></span></div></div></div><div class="qa l iw"><div class="bl" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bl" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="footerSocialShareButton" class="af fj ah ai aj ak al md an ao ap ew me mf ls mg"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"></path></svg></button></div></div></div></div></div></div></div></div></div></footer><div class="sr ss st su sv l bw"><div class="ab ca"><div class="ch bg fy fz ga gb"><div class="ck ab sw co"><div class="ab hz"><a rel="noopener follow" href="/@jjmcarrascosa?source=post_page-----c4549827ece4--------------------------------"><div class="l sx sy bx sz id"><div class="l fi"><img alt="Jose J. Martinez" class="l fc bx ta tb cw" src="https://miro.medium.com/v2/resize:fill:144:144/1*HJWy2OxORWQKGdinLrCCmg.jpeg" width="72" height="72" loading="lazy"/><div class="ie bx l ta tb fr n if fs"></div></div></div></a><a href="https://medium.com/spark-nlp?source=post_page-----c4549827ece4--------------------------------" rel="noopener follow"><div class="tc ab fi"><div><div class="bl" aria-hidden="false"><div class="l td te bx sz ij"><div class="l fi"><img alt="spark-nlp" class="l fc bx by bz cw" src="https://miro.medium.com/v2/resize:fill:64:64/1*NM-W9Li1MU8zNvfTT2Opkw.jpeg" width="32" height="32" loading="lazy"/><div class="ie bx l by bz fr n if fs"></div></div></div></div></div></div></a></div><div class="j i d"><div class="ab"><span><button class="be b bf z eo rv ep eq er es et eu ev ew ex ey ez tf fa fb fc bl fd fe">Follow</button></span><div class="ds l"><div><div><div class="bl" aria-hidden="false"><div class="l"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F5126caea940&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fspark-nlp%2Fspark-nlp-and-mlflow-for-serialization-and-experiment-tracking-c4549827ece4&amp;newsletterV3=e11aa5052863&amp;newsletterV3Id=5126caea940&amp;user=Jose+J.+Martinez&amp;userId=e11aa5052863&amp;source=-----c4549827ece4---------------------subscribe_user-----------"><button class="be b bf z th am ti qt tj tk tl tm tn to ev ew ex ey ez fa fb fc bl fd fe" aria-label="Subscribe"><svg xmlns="http://www.w3.org/2000/svg" width="38" height="38" fill="none" viewBox="0 0 38 38" class="tg te td"><rect width="0.5" height="6.5" x="26.25" y="9.25" rx="0.25"></rect><rect width="0.5" height="6.5" x="29.75" y="12.25" rx="0.25" transform="rotate(90 29.75 12.25)"></rect><path d="M19.5 12.5h-7a1 1 0 0 0-1 1v11a1 1 0 0 0 1 1h13a1 1 0 0 0 1-1v-5"></path><path d="M11.5 14.5 19 20l4-3"></path></svg></button></a></span></div></div></div></div></div></div></div></div><div class="ab cm co"><div class="l"><div class="ab q"><a class="af ag ah ai aj ak al am an ao ap aq ar as at ab q" rel="noopener follow" href="/@jjmcarrascosa?source=post_page-----c4549827ece4--------------------------------"><h2 class="pw-author-name be tp tq tr ts bj"><span class="gm jn">Written by <!-- -->Jose J. Martinez</span></h2></a></div><div class="rt ab"><div class="l iw"><span class="pw-follower-count be b bf z bj"><a class="af ag ah ai aj ak al am an ao ap aq ar ip" rel="noopener follow" href="/@jjmcarrascosa/followers?source=post_page-----c4549827ece4--------------------------------">597 Followers</a></span></div><div class="be b bf z je jf jg ab ji jj jk jl dt jc"><span class="iq l" aria-hidden="true"><span class="be b bf z dt">·</span></span><span class="l iw">Writer for </span><div><div class="l" aria-hidden="false"><a class="af ag ah ai aj ak al am an ao ap aq ar ip ab q" href="https://medium.com/spark-nlp?source=post_page-----c4549827ece4--------------------------------" rel="noopener follow"><p class="be b bf z je jf jg jh ji jj jk jl bj">spark-nlp</p></a></div></div></div></div><div class="tt l"><p class="be b bf z bj"><span class="gm">Video Games AI NLP Developer</span></p></div></div><div class="h k"><div class="ab"><span><button class="be b bf z eo rv ep eq er es et eu ev ew ex ey ez tf fa fb fc bl fd fe">Follow</button></span><div class="ds l"><div><div><div class="bl" aria-hidden="false"><div class="l"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F5126caea940&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fspark-nlp%2Fspark-nlp-and-mlflow-for-serialization-and-experiment-tracking-c4549827ece4&amp;newsletterV3=e11aa5052863&amp;newsletterV3Id=5126caea940&amp;user=Jose+J.+Martinez&amp;userId=e11aa5052863&amp;source=-----c4549827ece4---------------------subscribe_user-----------"><button class="be b bf z th am ti qt tj tk tl tm tn to ev ew ex ey ez fa fb fc bl fd fe" aria-label="Subscribe"><svg xmlns="http://www.w3.org/2000/svg" width="38" height="38" fill="none" viewBox="0 0 38 38" class="tg te td"><rect width="0.5" height="6.5" x="26.25" y="9.25" rx="0.25"></rect><rect width="0.5" height="6.5" x="29.75" y="12.25" rx="0.25" transform="rotate(90 29.75 12.25)"></rect><path d="M19.5 12.5h-7a1 1 0 0 0-1 1v11a1 1 0 0 0 1 1h13a1 1 0 0 0 1-1v-5"></path><path d="M11.5 14.5 19 20l4-3"></path></svg></button></a></span></div></div></div></div></div></div></div></div><div class="tu bg tv my mz na nb nc"></div></div></div><div class="h k j"><div class="tu bg tv tw"></div><div class="ab ca"><div class="ch bg fy fz ga gb"><div class="tx ab ku iz"><div class="ty tz l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://help.medium.com/hc/en-us?source=post_page-----c4549827ece4--------------------------------" rel="noopener follow"><p class="be b du z dt">Help</p></a></div><div class="ty tz l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.statuspage.io/?source=post_page-----c4549827ece4--------------------------------" rel="noopener follow"><p class="be b du z dt">Status</p></a></div><div class="ty tz l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/about?autoplay=1&amp;source=post_page-----c4549827ece4--------------------------------"><p class="be b du z dt">About</p></a></div><div class="ty tz l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----c4549827ece4--------------------------------"><p class="be b du z dt">Careers</p></a></div><div class="ty tz l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="pressinquiries@medium.com?source=post_page-----c4549827ece4--------------------------------" rel="noopener follow"><p class="be b du z dt">Press</p></a></div><div class="ty tz l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://blog.medium.com/?source=post_page-----c4549827ece4--------------------------------" rel="noopener follow"><p class="be b du z dt">Blog</p></a></div><div class="ty tz l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----c4549827ece4--------------------------------" rel="noopener follow"><p class="be b du z dt">Privacy</p></a></div><div class="ty tz l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----c4549827ece4--------------------------------" rel="noopener follow"><p class="be b du z dt">Terms</p></a></div><div class="ty tz l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://speechify.com/medium?source=post_page-----c4549827ece4--------------------------------" rel="noopener follow"><p class="be b du z dt">Text to speech</p></a></div><div class="ty l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/business?source=post_page-----c4549827ece4--------------------------------"><p class="be b du z dt">Teams</p></a></div></div></div></div></div></div></div></div></div></div><script>window.__BUILD_ID__="main-20240809-164208-b204ec94e1"</script><script>window.__GRAPHQL_URI__ = "https://medium.com/_/graphql"</script><script>window.__PRELOADED_STATE__ = {"algolia":{"queries":{}},"cache":{"experimentGroupSet":true,"reason":"","group":"enabled","tags":["group-edgeCachePosts","post-c4549827ece4","user-e11aa5052863","collection-81310c8f4868"],"serverVariantState":"44136fa355b3678a1146ad16f7e8649e94fb4fc21fe77e8310c060f61caaff8a","middlewareEnabled":true,"cacheStatus":"DYNAMIC","shouldUseCache":true,"vary":[],"lohpSummerUpsellEnabled":true,"lohpSummerDiscountTakeoverEnabled":false,"logoUpdatePhase2Enabled":false},"client":{"hydrated":false,"isUs":false,"isNativeMedium":false,"isSafariMobile":false,"isSafari":false,"isFirefox":false,"routingEntity":{"type":"DEFAULT","explicit":false},"viewerIsBot":false},"debug":{"requestId":"41757781-f909-42df-ba02-a30f6dcab0fc","hybridDevServices":[],"originalSpanCarrier":{}},"multiVote":{"clapsPerPost":{}},"navigation":{"branch":{"show":null,"hasRendered":null,"blockedByCTA":false},"hideGoogleOneTap":false,"hasRenderedAlternateUserBanner":null,"currentLocation":"https:\u002F\u002Fmedium.com\u002Fspark-nlp\u002Fspark-nlp-and-mlflow-for-serialization-and-experiment-tracking-c4549827ece4","host":"medium.com","hostname":"medium.com","referrer":"","hasSetReferrer":false,"susiModal":{"step":null,"operation":"register"},"postRead":false,"partnerProgram":{"selectedCountryCode":null},"queryString":"","currentHash":""},"config":{"nodeEnv":"production","version":"main-20240809-164208-b204ec94e1","target":"production","productName":"Medium","publicUrl":"https:\u002F\u002Fcdn-client.medium.com\u002Flite","authDomain":"medium.com","authGoogleClientId":"216296035834-k1k6qe060s2tp2a2jam4ljdcms00sttg.apps.googleusercontent.com","favicon":"production","glyphUrl":"https:\u002F\u002Fglyph.medium.com","branchKey":"key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm","algolia":{"appId":"MQ57UUUQZ2","apiKeySearch":"394474ced050e3911ae2249ecc774921","indexPrefix":"medium_","host":"-dsn.algolia.net"},"recaptchaKey":"6Lfc37IUAAAAAKGGtC6rLS13R1Hrw_BqADfS1LRk","recaptcha3Key":"6Lf8R9wUAAAAABMI_85Wb8melS7Zj6ziuf99Yot5","recaptchaEnterpriseKeyId":"6Le-uGgpAAAAAPprRaokM8AKthQ9KNGdoxaGUvVp","datadog":{"applicationId":"6702d87d-a7e0-42fe-bbcb-95b469547ea0","clientToken":"pub853ea8d17ad6821d9f8f11861d23dfed","rumToken":"pubf9cc52896502b9413b68ba36fc0c7162","context":{"deployment":{"target":"production","tag":"main-20240809-164208-b204ec94e1","commit":"b204ec94e1858518561092b037a81e2a0101aa27"}},"datacenter":"us"},"googleAnalyticsCode":"G-7JY7T788PK","googlePay":{"apiVersion":"2","apiVersionMinor":"0","merchantId":"BCR2DN6TV7EMTGBM","merchantName":"Medium","instanceMerchantId":"13685562959212738550"},"applePay":{"version":3},"signInWallCustomDomainCollectionIds":["3a8144eabfe3","336d898217ee","61061eb0c96b","138adf9c44c","819cc2aaeee0"],"mediumMastodonDomainName":"me.dm","mediumOwnedAndOperatedCollectionIds":["8a9336e5bb4","b7e45b22fec3","193b68bd4fba","8d6b8a439e32","54c98c43354d","3f6ecf56618","d944778ce714","92d2092dc598","ae2a65f35510","1285ba81cada","544c7006046e","fc8964313712","40187e704f1c","88d9857e584e","7b6769f2748b","bcc38c8f6edf","cef6983b292","cb8577c9149e","444d13b52878","713d7dbc99b0","ef8e90590e66","191186aaafa0","55760f21cdc5","9dc80918cc93","bdc4052bbdba","8ccfed20cbb2"],"tierOneDomains":["medium.com","thebolditalic.com","arcdigital.media","towardsdatascience.com","uxdesign.cc","codeburst.io","psiloveyou.xyz","writingcooperative.com","entrepreneurshandbook.co","prototypr.io","betterhumans.coach.me","theascent.pub"],"topicsToFollow":["d61cf867d93f","8a146bc21b28","1eca0103fff3","4d562ee63426","aef1078a3ef5","e15e46793f8d","6158eb913466","55f1c20aba7a","3d18b94f6858","4861fee224fd","63c6f1f93ee","1d98b3a9a871","decb52b64abf","ae5d4995e225","830cded25262"],"topicToTagMappings":{"accessibility":"accessibility","addiction":"addiction","android-development":"android-development","art":"art","artificial-intelligence":"artificial-intelligence","astrology":"astrology","basic-income":"basic-income","beauty":"beauty","biotech":"biotech","blockchain":"blockchain","books":"books","business":"business","cannabis":"cannabis","cities":"cities","climate-change":"climate-change","comics":"comics","coronavirus":"coronavirus","creativity":"creativity","cryptocurrency":"cryptocurrency","culture":"culture","cybersecurity":"cybersecurity","data-science":"data-science","design":"design","digital-life":"digital-life","disability":"disability","economy":"economy","education":"education","equality":"equality","family":"family","feminism":"feminism","fiction":"fiction","film":"film","fitness":"fitness","food":"food","freelancing":"freelancing","future":"future","gadgets":"gadgets","gaming":"gaming","gun-control":"gun-control","health":"health","history":"history","humor":"humor","immigration":"immigration","ios-development":"ios-development","javascript":"javascript","justice":"justice","language":"language","leadership":"leadership","lgbtqia":"lgbtqia","lifestyle":"lifestyle","machine-learning":"machine-learning","makers":"makers","marketing":"marketing","math":"math","media":"media","mental-health":"mental-health","mindfulness":"mindfulness","money":"money","music":"music","neuroscience":"neuroscience","nonfiction":"nonfiction","outdoors":"outdoors","parenting":"parenting","pets":"pets","philosophy":"philosophy","photography":"photography","podcasts":"podcast","poetry":"poetry","politics":"politics","privacy":"privacy","product-management":"product-management","productivity":"productivity","programming":"programming","psychedelics":"psychedelics","psychology":"psychology","race":"race","relationships":"relationships","religion":"religion","remote-work":"remote-work","san-francisco":"san-francisco","science":"science","self":"self","self-driving-cars":"self-driving-cars","sexuality":"sexuality","social-media":"social-media","society":"society","software-engineering":"software-engineering","space":"space","spirituality":"spirituality","sports":"sports","startups":"startup","style":"style","technology":"technology","transportation":"transportation","travel":"travel","true-crime":"true-crime","tv":"tv","ux":"ux","venture-capital":"venture-capital","visual-design":"visual-design","work":"work","world":"world","writing":"writing"},"defaultImages":{"avatar":{"imageId":"1*dmbNkD5D-u45r44go_cf0g.png","height":150,"width":150},"orgLogo":{"imageId":"1*OMF3fSqH8t4xBJ9-6oZDZw.png","height":106,"width":545},"postLogo":{"imageId":"1*kFrc4tBFM_tCis-2Ic87WA.png","height":810,"width":1440},"postPreviewImage":{"imageId":"1*hn4v1tCaJy7cWMyb0bpNpQ.png","height":386,"width":579}},"collectionStructuredData":{"8d6b8a439e32":{"name":"Elemental","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F980\u002F1*9ygdqoKprhwuTVKUM0DLPA@2x.png","width":980,"height":159}}},"3f6ecf56618":{"name":"Forge","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F596\u002F1*uULpIlImcO5TDuBZ6lm7Lg@2x.png","width":596,"height":183}}},"ae2a65f35510":{"name":"GEN","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F264\u002F1*RdVZMdvfV3YiZTw6mX7yWA.png","width":264,"height":140}}},"88d9857e584e":{"name":"LEVEL","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*JqYMhNX6KNNb2UlqGqO2WQ.png","width":540,"height":108}}},"7b6769f2748b":{"name":"Marker","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F383\u002F1*haCUs0wF6TgOOvfoY-jEoQ@2x.png","width":383,"height":92}}},"444d13b52878":{"name":"OneZero","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*cw32fIqCbRWzwJaoQw6BUg.png","width":540,"height":123}}},"8ccfed20cbb2":{"name":"Zora","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*tZUQqRcCCZDXjjiZ4bDvgQ.png","width":540,"height":106}}}},"embeddedPostIds":{"coronavirus":"cd3010f9d81f"},"sharedCdcMessaging":{"COVID_APPLICABLE_TAG_SLUGS":[],"COVID_APPLICABLE_TOPIC_NAMES":[],"COVID_APPLICABLE_TOPIC_NAMES_FOR_TOPIC_PAGE":[],"COVID_MESSAGES":{"tierA":{"text":"For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":66,"end":73,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"tierB":{"text":"Anyone can publish on Medium per our Policies, but we don’t fact-check every story. For more info about the coronavirus, see cdc.gov.","markups":[{"start":37,"end":45,"href":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Fcategories\u002F201931128-Policies-Safety"},{"start":125,"end":132,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"paywall":{"text":"This article has been made free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":56,"end":70,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":138,"end":145,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"unbound":{"text":"This article is free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":45,"end":59,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":127,"end":134,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]}},"COVID_BANNER_POST_ID_OVERRIDE_WHITELIST":["3b31a67bff4a"]},"sharedVoteMessaging":{"TAGS":["politics","election-2020","government","us-politics","election","2020-presidential-race","trump","donald-trump","democrats","republicans","congress","republican-party","democratic-party","biden","joe-biden","maga"],"TOPICS":["politics","election"],"MESSAGE":{"text":"Find out more about the U.S. election results here.","markups":[{"start":46,"end":50,"href":"https:\u002F\u002Fcookpolitical.com\u002F2020-national-popular-vote-tracker"}]},"EXCLUDE_POSTS":["397ef29e3ca5"]},"embedPostRules":[],"recircOptions":{"v1":{"limit":3},"v2":{"limit":8}},"braintreeClientKey":"production_zjkj96jm_m56f8fqpf7ngnrd4","braintree":{"enabled":true,"merchantId":"m56f8fqpf7ngnrd4","merchantAccountId":{"usd":"AMediumCorporation_instant","eur":"amediumcorporation_EUR","cad":"amediumcorporation_CAD"},"publicKey":"ds2nn34bg2z7j5gd","braintreeEnvironment":"production","dashboardUrl":"https:\u002F\u002Fwww.braintreegateway.com\u002Fmerchants","gracePeriodDurationInDays":14,"mediumMembershipPlanId":{"monthly":"ce105f8c57a3","monthlyV2":"e8a5e126-792b-4ee6-8fba-d574c1b02fc5","monthlyWithTrial":"d5ee3dbe3db8","monthlyPremium":"fa741a9b47a2","yearly":"a40ad4a43185","yearlyV2":"3815d7d6-b8ca-4224-9b8c-182f9047866e","yearlyStaff":"d74fb811198a","yearlyWithTrial":"b3bc7350e5c7","yearlyPremium":"e21bd2c12166","monthlyOneYearFree":"e6c0637a-2bad-4171-ab4f-3c268633d83c","monthly25PercentOffFirstYear":"235ecc62-0cdb-49ae-9378-726cd21c504b","monthly20PercentOffFirstYear":"ba518864-9c13-4a99-91ca-411bf0cac756","monthly15PercentOffFirstYear":"594c029b-9f89-43d5-88f8-8173af4e070e","monthly10PercentOffFirstYear":"c6c7bc9a-40f2-4b51-8126-e28511d5bdb0","monthlyForStudents":"629ebe51-da7d-41fd-8293-34cd2f2030a8","yearlyOneYearFree":"78ba7be9-0d9f-4ece-aa3e-b54b826f2bf1","yearly25PercentOffFirstYear":"2dbb010d-bb8f-4eeb-ad5c-a08509f42d34","yearly20PercentOffFirstYear":"47565488-435b-47f8-bf93-40d5fbe0ebc8","yearly15PercentOffFirstYear":"8259809b-0881-47d9-acf7-6c001c7f720f","yearly10PercentOffFirstYear":"9dd694fb-96e1-472c-8d9e-3c868d5c1506","yearlyForStudents":"e29345ef-ab1c-4234-95c5-70e50fe6bc23","monthlyCad":"p52orjkaceei","yearlyCad":"h4q9g2up9ktt"},"braintreeDiscountId":{"oneMonthFree":"MONTHS_FREE_01","threeMonthsFree":"MONTHS_FREE_03","sixMonthsFree":"MONTHS_FREE_06","fiftyPercentOffOneYear":"FIFTY_PERCENT_OFF_ONE_YEAR"},"3DSecureVersion":"2","defaultCurrency":"usd","providerPlanIdCurrency":{"4ycw":"usd","rz3b":"usd","3kqm":"usd","jzw6":"usd","c2q2":"usd","nnsw":"usd","q8qw":"usd","d9y6":"usd","fx7w":"cad","nwf2":"cad"}},"paypalClientId":"AXj1G4fotC2GE8KzWX9mSxCH1wmPE3nJglf4Z2ig_amnhvlMVX87otaq58niAg9iuLktVNF_1WCMnN7v","paypal":{"host":"https:\u002F\u002Fapi.paypal.com:443","clientMode":"production","serverMode":"live","webhookId":"4G466076A0294510S","monthlyPlan":{"planId":"P-9WR0658853113943TMU5FDQA","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlan":{"planId":"P-7N8963881P8875835MU5JOPQ","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oneYearGift":{"name":"Medium Membership (1 Year, Digital Gift Code)","description":"Unlimited access to the best and brightest stories on Medium. Gift codes can be redeemed at medium.com\u002Fredeem.","price":"50.00","currency":"USD","sku":"membership-gift-1-yr"},"oldMonthlyPlan":{"planId":"P-96U02458LM656772MJZUVH2Y","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlan":{"planId":"P-59P80963JF186412JJZU3SMI","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"monthlyPlanWithTrial":{"planId":"P-66C21969LR178604GJPVKUKY","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlanWithTrial":{"planId":"P-6XW32684EX226940VKCT2MFA","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oldMonthlyPlanNoSetupFee":{"planId":"P-4N046520HR188054PCJC7LJI","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlanNoSetupFee":{"planId":"P-7A4913502Y5181304CJEJMXQ","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"sdkUrl":"https:\u002F\u002Fwww.paypal.com\u002Fsdk\u002Fjs"},"stripePublishableKey":"pk_live_7FReX44VnNIInZwrIIx6ghjl","log":{"json":true,"level":"info"},"imageUploadMaxSizeMb":25,"staffPicks":{"title":"Staff Picks","catalogId":"c7bc6e1ee00f"}},"session":{"xsrf":""}}</script><script>window.__APOLLO_STATE__ = {"ROOT_QUERY":{"__typename":"Query","viewer":null,"collectionByDomainOrSlug({\"domainOrSlug\":\"spark-nlp\"})":{"__ref":"Collection:81310c8f4868"},"postResult({\"id\":\"c4549827ece4\"})":{"__ref":"Post:c4549827ece4"}},"ImageMetadata:":{"__typename":"ImageMetadata","id":""},"Collection:81310c8f4868":{"__typename":"Collection","id":"81310c8f4868","favicon":{"__ref":"ImageMetadata:"},"customStyleSheet":{"__ref":"CustomStyleSheet:8948cfcdc8bd"},"colorPalette":{"__typename":"ColorPalette","highlightSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FFFFFFFF","colorPoints":[{"__typename":"ColorPoint","color":"#FFFFFFFF","point":0},{"__typename":"ColorPoint","color":"#FFE8F3E8","point":0.1},{"__typename":"ColorPoint","color":"#FFE8F3E8","point":0.2},{"__typename":"ColorPoint","color":"#FFD1E7D1","point":0.6},{"__typename":"ColorPoint","color":"#FFA3D0A2","point":1}]},"defaultBackgroundSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FFFFFFFF","colorPoints":[{"__typename":"ColorPoint","color":"#FF1A8917","point":0},{"__typename":"ColorPoint","color":"#FF11800E","point":0.1},{"__typename":"ColorPoint","color":"#FF0F730C","point":0.2},{"__typename":"ColorPoint","color":"#FF095407","point":1}]},"tintBackgroundSpectrum":null},"googleAnalyticsId":null,"editors":[{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:fe4b780b61e1"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:97741bccbc0e"}}],"name":"spark-nlp","avatar":{"__ref":"ImageMetadata:1*NM-W9Li1MU8zNvfTT2Opkw.jpeg"},"domain":null,"slug":"spark-nlp","description":"Natural Language Understanding Library for Apache Spark.","subscriberCount":666,"viewerEdge":{"__ref":"CollectionViewerEdge:collectionId:81310c8f4868-viewerId:lo_9b4ce265ae2f"},"twitterUsername":"johnsnowlabs","facebookPageId":null,"logo":{"__ref":"ImageMetadata:1*yt4eNSte8veSTOh0spY9EQ.png"}},"CustomStyleSheet:8948cfcdc8bd":{"__typename":"CustomStyleSheet","id":"8948cfcdc8bd","global":{"__typename":"GlobalStyles","colorPalette":{"__typename":"StyleSheetColorPalette","primary":{"__typename":"ColorValue","colorPalette":{"__typename":"ColorPalette","highlightSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FFFFFFFF","colorPoints":[{"__typename":"ColorPoint","color":"#FFE6F5FF","point":0},{"__typename":"ColorPoint","color":"#FFE1F4FF","point":0.1},{"__typename":"ColorPoint","color":"#FFDCF3FF","point":0.2},{"__typename":"ColorPoint","color":"#FFD7F1FF","point":0.3},{"__typename":"ColorPoint","color":"#FFD2F0FF","point":0.4},{"__typename":"ColorPoint","color":"#FFCDEFFF","point":0.5},{"__typename":"ColorPoint","color":"#FFC7EEFF","point":0.6},{"__typename":"ColorPoint","color":"#FFC2ECFF","point":0.7},{"__typename":"ColorPoint","color":"#FFBCEBFF","point":0.8},{"__typename":"ColorPoint","color":"#FFB6EAFF","point":0.9},{"__typename":"ColorPoint","color":"#FFB0E8FF","point":1}]},"defaultBackgroundSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FFFFFFFF","colorPoints":[{"__typename":"ColorPoint","color":"#FF3C8DCF","point":0},{"__typename":"ColorPoint","color":"#FF3C83BE","point":0.1},{"__typename":"ColorPoint","color":"#FF3B79AD","point":0.2},{"__typename":"ColorPoint","color":"#FF396F9C","point":0.3},{"__typename":"ColorPoint","color":"#FF37648B","point":0.4},{"__typename":"ColorPoint","color":"#FF33597A","point":0.5},{"__typename":"ColorPoint","color":"#FF2E4E6A","point":0.6},{"__typename":"ColorPoint","color":"#FF294259","point":0.7},{"__typename":"ColorPoint","color":"#FF223648","point":0.8},{"__typename":"ColorPoint","color":"#FF1B2937","point":0.9},{"__typename":"ColorPoint","color":"#FF111B25","point":1}]},"tintBackgroundSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FF1e77b7","colorPoints":[{"__typename":"ColorPoint","color":"#FF1E77B7","point":0},{"__typename":"ColorPoint","color":"#FF4087C1","point":0.1},{"__typename":"ColorPoint","color":"#FF5A96CB","point":0.2},{"__typename":"ColorPoint","color":"#FF71A5D5","point":0.3},{"__typename":"ColorPoint","color":"#FF86B3DE","point":0.4},{"__typename":"ColorPoint","color":"#FF9AC1E7","point":0.5},{"__typename":"ColorPoint","color":"#FFADCEEF","point":0.6},{"__typename":"ColorPoint","color":"#FFC0DBF7","point":0.7},{"__typename":"ColorPoint","color":"#FFD2E8FF","point":0.8},{"__typename":"ColorPoint","color":"#FFE4F5FF","point":0.9},{"__typename":"ColorPoint","color":"#FFF5FFFF","point":1}]}}},"background":null},"fonts":{"__typename":"StyleSheetFonts","font1":{"__typename":"StyleSheetFont","name":"SANS_SERIF_1"},"font2":{"__typename":"StyleSheetFont","name":"SANS_SERIF_1"},"font3":{"__typename":"StyleSheetFont","name":"SERIF_2"}}},"header":{"__typename":"HeaderStyles","backgroundImage":null}},"User:fe4b780b61e1":{"__typename":"User","id":"fe4b780b61e1"},"User:97741bccbc0e":{"__typename":"User","id":"97741bccbc0e"},"ImageMetadata:1*NM-W9Li1MU8zNvfTT2Opkw.jpeg":{"__typename":"ImageMetadata","id":"1*NM-W9Li1MU8zNvfTT2Opkw.jpeg"},"LinkedAccounts:e11aa5052863":{"__typename":"LinkedAccounts","mastodon":null,"id":"e11aa5052863"},"UserViewerEdge:userId:e11aa5052863-viewerId:lo_9b4ce265ae2f":{"__typename":"UserViewerEdge","id":"userId:e11aa5052863-viewerId:lo_9b4ce265ae2f","isFollowing":false,"isUser":false,"isMuting":false},"NewsletterV3:5126caea940":{"__typename":"NewsletterV3","id":"5126caea940","type":"NEWSLETTER_TYPE_AUTHOR","slug":"e11aa5052863","name":"e11aa5052863","collection":null,"user":{"__ref":"User:e11aa5052863"}},"User:e11aa5052863":{"__typename":"User","id":"e11aa5052863","name":"Jose J. Martinez","username":"jjmcarrascosa","newsletterV3":{"__ref":"NewsletterV3:5126caea940"},"linkedAccounts":{"__ref":"LinkedAccounts:e11aa5052863"},"isSuspended":false,"imageId":"1*HJWy2OxORWQKGdinLrCCmg.jpeg","mediumMemberAt":0,"verifications":{"__typename":"VerifiedInfo","isBookAuthor":false},"socialStats":{"__typename":"SocialStats","followerCount":597},"customDomainState":null,"hasSubdomain":false,"bio":"Video Games AI NLP Developer","isPartnerProgramEnrolled":false,"viewerEdge":{"__ref":"UserViewerEdge:userId:e11aa5052863-viewerId:lo_9b4ce265ae2f"},"viewerIsUser":false,"postSubscribeMembershipUpsellShownAt":0,"allowNotes":true,"twitterScreenName":"","membership":null},"Paragraph:2acb816079b_0":{"__typename":"Paragraph","id":"2acb816079b_0","name":"3668","type":"H3","href":null,"layout":null,"metadata":null,"text":"Spark NLP and MLFlow for Serialization and Experiment Tracking","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*3w3Cxo8ElFmAK7VM_jNxDA.png":{"__typename":"ImageMetadata","id":"1*3w3Cxo8ElFmAK7VM_jNxDA.png","originalHeight":534,"originalWidth":742,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:2acb816079b_1":{"__typename":"Paragraph","id":"2acb816079b_1","name":"7a78","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*3w3Cxo8ElFmAK7VM_jNxDA.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_2":{"__typename":"Paragraph","id":"2acb816079b_2","name":"ec7d","type":"P","href":null,"layout":null,"metadata":null,"text":"In this article, we are going to describe how to use MLFlow for Serialization of Spark NLP models, and local and remote Experiment Tracking. This is the first article of the upcoming series of MLFlow, where we will be showcasing also the consumption of serialized Spark NLP models for inference, to come soon to Spark NLP channel on Medium.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_3":{"__typename":"Paragraph","id":"2acb816079b_3","name":"4b7e","type":"H3","href":null,"layout":null,"metadata":null,"text":"About MLFlow","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_4":{"__typename":"Paragraph","id":"2acb816079b_4","name":"5005","type":"P","href":null,"layout":null,"metadata":null,"text":"Spark NLP uses Spark MLlib Pipelines, which are natively supported by MLFlow. MLFlow is, as stated in their official webpage, an open-source platform for the machine learning lifecycle, that includes:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":108,"end":124,"href":"https:\u002F\u002Fmlflow.org\u002F","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_5":{"__typename":"Paragraph","id":"2acb816079b_5","name":"f7f8","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Mlflow Tracking: Record and query experiments: code, data, config, and results","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":15,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_6":{"__typename":"Paragraph","id":"2acb816079b_6","name":"c013","type":"ULI","href":null,"layout":null,"metadata":null,"text":"MLflow Projects: Package data science code in a format to reproduce runs on any platform","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":15,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_7":{"__typename":"Paragraph","id":"2acb816079b_7","name":"446d","type":"ULI","href":null,"layout":null,"metadata":null,"text":"MLflow Models: Deploy machine learning models in diverse serving environments","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":13,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_8":{"__typename":"Paragraph","id":"2acb816079b_8","name":"e5aa","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Model Registry: Store, annotate, discover, and manage models in a central repository","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":14,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_9":{"__typename":"Paragraph","id":"2acb816079b_9","name":"b3b9","type":"P","href":null,"layout":null,"metadata":null,"text":"MLFlow is also integrated into Databricks, so you will be able to track your experiments in any Databricks environment, and even use MLFLow Model Registry to serve models for production purposes, using the REST API (see section “Productionizing Spark NLP”).","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_10":{"__typename":"Paragraph","id":"2acb816079b_10","name":"6acb","type":"P","href":null,"layout":null,"metadata":null,"text":"We will be using in this documentation Jupyter Notebook syntax.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_11":{"__typename":"Paragraph","id":"2acb816079b_11","name":"63e9","type":"H3","href":null,"layout":null,"metadata":null,"text":"Available configurations","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_12":{"__typename":"Paragraph","id":"2acb816079b_12","name":"7c64","type":"P","href":null,"layout":null,"metadata":null,"text":"There are several ways of deploying an MLFlow Model Registry:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_13":{"__typename":"Paragraph","id":"2acb816079b_13","name":"7b87","type":"P","href":null,"layout":null,"metadata":null,"text":"Scenario 1: MLflow on localhost with no Tracking Server: This scenario uses a localhost folder (.\u002Fmlruns by default) to serialize and store your models, but there is no tracking server available (version tracking will be disabled).","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":96,"end":104,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":56,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*YjwVfFwIttKYIg3_.png":{"__typename":"ImageMetadata","id":"0*YjwVfFwIttKYIg3_.png","originalHeight":1069,"originalWidth":1900,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:2acb816079b_14":{"__typename":"Paragraph","id":"2acb816079b_14","name":"9fb0","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*YjwVfFwIttKYIg3_.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_15":{"__typename":"Paragraph","id":"2acb816079b_15","name":"0a3e","type":"P","href":null,"layout":null,"metadata":null,"text":"We skip Scenario 2 (MLFlow on localhost with SQlite, but you can take a look at it here)","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":83,"end":87,"href":"https:\u002F\u002Fwww.mlflow.org\u002Fdocs\u002Flatest\u002Ftracking.html#scenario-2-mlflow-on-localhost-with-sqlite","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_16":{"__typename":"Paragraph","id":"2acb816079b_16","name":"3557","type":"P","href":null,"layout":null,"metadata":null,"text":"Scenario 3: MLflow on localhost with a Tracking Server This scenario uses a localhost folder (.\u002Fmlruns by default) to serialize and store your models, and a database as a Tracking Server. It uses SQLAlchemy under the hood, so the following databases are supported: mssql, postgresql, mysql, sqlite.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":94,"end":102,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":265,"end":270,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":272,"end":282,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":284,"end":289,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":291,"end":297,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":54,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*9ewyRtiEf-hg2A_v.png":{"__typename":"ImageMetadata","id":"0*9ewyRtiEf-hg2A_v.png","originalHeight":1069,"originalWidth":1900,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:2acb816079b_17":{"__typename":"Paragraph","id":"2acb816079b_17","name":"7846","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*9ewyRtiEf-hg2A_v.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_18":{"__typename":"Paragraph","id":"2acb816079b_18","name":"c316","type":"P","href":null,"layout":null,"metadata":null,"text":"We are going to show how to implement this scenario with a mysql database.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":59,"end":64,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_19":{"__typename":"Paragraph","id":"2acb816079b_19","name":"3a72","type":"P","href":null,"layout":null,"metadata":null,"text":"Scenario 4: MLflow on remote with a Tracking Server This scenario is a remote version of Scenario 3. It uses a remote S3 bucket to serialize and store your models, and a database as a Tracking Server. Again, it uses SQLAlchemy for the Tracking Server under the hood, so the following databases are supported: mssql, postgresql, mysql, sqlite. In this case, you can use any service as AWS RDS or Azure SQL Database.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":309,"end":314,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":316,"end":326,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":328,"end":333,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":335,"end":341,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":10,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*l9uYeFVSDO4VAZZu.png":{"__typename":"ImageMetadata","id":"0*l9uYeFVSDO4VAZZu.png","originalHeight":1069,"originalWidth":1900,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:2acb816079b_20":{"__typename":"Paragraph","id":"2acb816079b_20","name":"b868","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*l9uYeFVSDO4VAZZu.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_21":{"__typename":"Paragraph","id":"2acb816079b_21","name":"4762","type":"H3","href":null,"layout":null,"metadata":null,"text":"Requirements","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_22":{"__typename":"Paragraph","id":"2acb816079b_22","name":"123a","type":"P","href":null,"layout":null,"metadata":null,"text":"We are going to showcase Scenario 3. Since we want to have an Experiment Tracking Server with mysql, we will need to install in our server the requirements for it.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":94,"end":99,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_23":{"__typename":"Paragraph","id":"2acb816079b_23","name":"9b9e","type":"P","href":null,"layout":null,"metadata":null,"text":"!sudo apt-get install -y python-mysqldb mysql-server libmysqlclient-dev","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":0,"end":71,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_24":{"__typename":"Paragraph","id":"2acb816079b_24","name":"64c9","type":"P","href":null,"layout":null,"metadata":null,"text":"Also, let’s install a MySQL Python interface library, called pymsql, to access mysql databases.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":61,"end":67,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":79,"end":84,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_25":{"__typename":"Paragraph","id":"2acb816079b_25","name":"9367","type":"P","href":null,"layout":null,"metadata":null,"text":"!pip install mysqlclient pymysql","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":0,"end":32,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_26":{"__typename":"Paragraph","id":"2acb816079b_26","name":"6587","type":"P","href":null,"layout":null,"metadata":null,"text":"We will also need MLFlow (this example was tested with version 1.21.0)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_27":{"__typename":"Paragraph","id":"2acb816079b_27","name":"7280","type":"P","href":null,"layout":null,"metadata":null,"text":"!pip install mlflow","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":0,"end":19,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_28":{"__typename":"Paragraph","id":"2acb816079b_28","name":"d36a","type":"P","href":null,"layout":null,"metadata":null,"text":"Finally, make sure you follow the Spark NLP installation, available here","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":68,"end":72,"href":"https:\u002F\u002Fnlp.johnsnowlabs.com\u002Fdocs\u002Fen\u002Finstall#python","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_29":{"__typename":"Paragraph","id":"2acb816079b_29","name":"d433","type":"H3","href":null,"layout":null,"metadata":null,"text":"Instantiating a MySQL database","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_30":{"__typename":"Paragraph","id":"2acb816079b_30","name":"15f8","type":"P","href":null,"layout":null,"metadata":null,"text":"We are going to use Docker to instantiate a MySQL container with a persistent volume, but you can install it directly on your machine without Docker.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_31":{"__typename":"Paragraph","id":"2acb816079b_31","name":"a84d","type":"P","href":null,"layout":null,"metadata":null,"text":"To do that, we will need to have installed (feel free to skip this step if you will install MySql without Docker):","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_32":{"__typename":"Paragraph","id":"2acb816079b_32","name":"d2bd","type":"P","href":null,"layout":null,"metadata":null,"text":"In our case, I used this docker-compose.yml file to instantiate a mysql database with a persistent volume:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":25,"end":43,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":66,"end":71,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_33":{"__typename":"Paragraph","id":"2acb816079b_33","name":"5fc9","type":"PRE","href":null,"layout":null,"metadata":null,"text":"version: '3'","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_34":{"__typename":"Paragraph","id":"2acb816079b_34","name":"141e","type":"PRE","href":null,"layout":null,"metadata":null,"text":"services:\n  # MySQL\n  mflow_models:\n    container_name: mlflow_models\n    image: mysql:8.0\n    command: mysqld --default-authentication-plugin=mysql_native_password --character-set-server=utf8mb4 --collation-server=utf8mb4_unicode_ci\n    environment:\n      MYSQL_ROOT_PASSWORD: root\n      MYSQL_DATABASE: mlflow_models\n      MYSQL_USER: jsl\n      MYSQL_PASSWORD: passpass\n      MYSQL_ALLOW_EMPTY_PASSWORD: \"yes\"\n    ports:\n      - '3306:3306'\n    volumes:\n      - '.\u002Fdocker\u002Fdb\u002Fdata:\u002Fvar\u002Flib\u002Fmysql'\n      - '.\u002Fdocker\u002Fdb\u002Fmy.cnf:\u002Fetc\u002Fmysql\u002Fconf.d\u002Fmy.cnf'\n      - '.\u002Fdocker\u002Fdb\u002Fsql:\u002Fdocker-entrypoint-initdb.d'","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_35":{"__typename":"Paragraph","id":"2acb816079b_35","name":"49b8","type":"P","href":null,"layout":null,"metadata":null,"text":"Just by executing the following command in the folder where your docker-compose.yml the file is, you will have your MySQL engine, with a mlflow_models a database running and prepared for MLFlow Experiment Tracking:!sudo docker-compose up -d .","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":65,"end":83,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":137,"end":150,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":214,"end":242,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_36":{"__typename":"Paragraph","id":"2acb816079b_36","name":"9ded","type":"P","href":null,"layout":null,"metadata":null,"text":"Make sure it’s running using the following command:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_37":{"__typename":"Paragraph","id":"2acb816079b_37","name":"c75e","type":"PRE","href":null,"layout":null,"metadata":null,"text":"!docker ps | grep -o mlflow_models`","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_38":{"__typename":"Paragraph","id":"2acb816079b_38","name":"abf5","type":"H3","href":null,"layout":null,"metadata":null,"text":"Connection String","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_39":{"__typename":"Paragraph","id":"2acb816079b_39","name":"09df","type":"P","href":null,"layout":null,"metadata":null,"text":"You will need a connection string that will tell MLFlow (SQLAlchemy) how to reach that database.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_40":{"__typename":"Paragraph","id":"2acb816079b_40","name":"109c","type":"P","href":null,"layout":null,"metadata":null,"text":"Connections strings in SQLALchemy have this format:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_41":{"__typename":"Paragraph","id":"2acb816079b_41","name":"5ee8","type":"P","href":null,"layout":null,"metadata":null,"text":"\u003Cdialect\u003E+\u003Cdriver\u003E:\u002F\u002F\u003Cusername\u003E:\u003Cpassword\u003E@\u003Chost\u003E:\u003Cport\u003E\u002F\u003Cdatabase\u003E","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":0,"end":67,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_42":{"__typename":"Paragraph","id":"2acb816079b_42","name":"9e2e","type":"P","href":null,"layout":null,"metadata":null,"text":"In our case, we declare a CONNECTION_STRING var as:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":26,"end":43,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_43":{"__typename":"Paragraph","id":"2acb816079b_43","name":"d02a","type":"P","href":null,"layout":null,"metadata":null,"text":"CONNECTION_STRING = f\"mysql+pymysql:\u002F\u002Froot:root@localhost:3306\u002Fmlflow_models\"","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":0,"end":77,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_44":{"__typename":"Paragraph","id":"2acb816079b_44","name":"fea5","type":"H3","href":null,"layout":null,"metadata":null,"text":"Training","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_45":{"__typename":"Paragraph","id":"2acb816079b_45","name":"027b","type":"P","href":null,"layout":null,"metadata":null,"text":"Let’s now import all the libraries we will need.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_46":{"__typename":"Paragraph","id":"2acb816079b_46","name":"dfc0","type":"H4","href":null,"layout":null,"metadata":null,"text":"Generic Imports","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":15,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_47":{"__typename":"Paragraph","id":"2acb816079b_47","name":"a433","type":"PRE","href":null,"layout":null,"metadata":null,"text":"import json\nimport os\nfrom sklearn.metrics import classification_report\nimport time\nimport mlflow\nfrom mlflow.models.signature import infer_signature\nfrom urllib.parse import urlparse\nimport pandas as pd\nimport glob","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_48":{"__typename":"Paragraph","id":"2acb816079b_48","name":"dbd5","type":"H4","href":null,"layout":null,"metadata":null,"text":"Spark NLP Imports","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_49":{"__typename":"Paragraph","id":"2acb816079b_49","name":"a657","type":"PRE","href":null,"layout":null,"metadata":null,"text":"import sparknlp\nfrom sparknlp.base import *\nfrom sparknlp.annotator import *\nfrom sparknlp.training import *\nfrom pyspark.ml import Pipeline\nimport pyspark.sql.functions as F\nfrom sparknlp.training import CoNLL\nfrom pyspark.sql import SparkSession","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_50":{"__typename":"Paragraph","id":"2acb816079b_50","name":"1dbc","type":"H4","href":null,"layout":null,"metadata":null,"text":"Setting the connection string in MLFlow","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_51":{"__typename":"Paragraph","id":"2acb816079b_51","name":"05c7","type":"P","href":null,"layout":null,"metadata":null,"text":"Now that we have imported mlflow, let’s set the connection string we had prepared before.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_52":{"__typename":"Paragraph","id":"2acb816079b_52","name":"8686","type":"PRE","href":null,"layout":null,"metadata":null,"text":"mlflow.set_tracking_uri(CONNECTION_STRING)\nmlflow.get_tracking_uri() # This checks if it was set properly","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_53":{"__typename":"Paragraph","id":"2acb816079b_53","name":"b090","type":"H4","href":null,"layout":null,"metadata":null,"text":"Constant with pip_requirements","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_54":{"__typename":"Paragraph","id":"2acb816079b_54","name":"f4f3","type":"P","href":null,"layout":null,"metadata":null,"text":"MLFLow requires either a conda_env (conda environment) definition of the requirements of your models, or a pip_requirements list with all pip libraries. We will use this second way, so let's prepare the list with Spark NLP and MLFlow:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":25,"end":34,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":107,"end":123,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":213,"end":222,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":227,"end":233,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_55":{"__typename":"Paragraph","id":"2acb816079b_55","name":"f903","type":"PRE","href":null,"layout":null,"metadata":null,"text":"PIP_REQUIREMENTS = [f\"sparknlp=={sparknlp.version()}\", f\"mlflow=={mlflow.__version__}\"] \nPIP_REQUIREMENTS # This checks if it was set properly","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":0,"end":142,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_56":{"__typename":"Paragraph","id":"2acb816079b_56","name":"19c5","type":"H4","href":null,"layout":null,"metadata":null,"text":"Training a NERDLApproach()","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_57":{"__typename":"Paragraph","id":"2acb816079b_57","name":"0474","type":"P","href":null,"layout":null,"metadata":null,"text":"We will be showcasing the serialization and experiment tracking of NERDLApproach().","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":67,"end":82,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_58":{"__typename":"Paragraph","id":"2acb816079b_58","name":"1912","type":"H4","href":null,"layout":null,"metadata":null,"text":"Ner Log Parser Util","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":19,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_59":{"__typename":"Paragraph","id":"2acb816079b_59","name":"4d17","type":"P","href":null,"layout":null,"metadata":null,"text":"There is one specific util that is able to parse the log of that approach in order to extract the metrics and charts. Let’s get it.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_60":{"__typename":"Paragraph","id":"2acb816079b_60","name":"571b","type":"P","href":null,"layout":null,"metadata":null,"text":"!wget -q https:\u002F\u002Fraw.githubusercontent.com\u002FJohnSnowLabs\u002Fspark-nlp-workshop\u002Fmaster\u002Ftutorials\u002FCertification_Trainings\u002FPublic\u002Futils\u002Fner_image_log_parser.py","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":0,"end":152,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":9,"end":152,"href":"https:\u002F\u002Fraw.githubusercontent.com\u002FJohnSnowLabs\u002Fspark-nlp-workshop\u002Fmaster\u002Ftutorials\u002FCertification_Trainings\u002FPublic\u002Futils\u002Fner_image_log_parser.py","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_61":{"__typename":"Paragraph","id":"2acb816079b_61","name":"2f49","type":"P","href":null,"layout":null,"metadata":null,"text":"Now, let’s import the library:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_62":{"__typename":"Paragraph","id":"2acb816079b_62","name":"dfad","type":"P","href":null,"layout":null,"metadata":null,"text":"import ner_image_log_parser","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":0,"end":27,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_63":{"__typename":"Paragraph","id":"2acb816079b_63","name":"7d78","type":"H4","href":null,"layout":null,"metadata":null,"text":"Starting a SparkNLP session","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":27,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_64":{"__typename":"Paragraph","id":"2acb816079b_64","name":"502d","type":"P","href":null,"layout":null,"metadata":null,"text":"It’s important we create a Spark NLP Session using the Session Builder, since we need to specify the jars not only of Spark NLP, but also of MLFlow.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_65":{"__typename":"Paragraph","id":"2acb816079b_65","name":"289c","type":"PRE","href":null,"layout":null,"metadata":null,"text":"def start():\n    builder = SparkSession.builder \\\n        .appName(\"Spark NLP Licensed\") \\\n        .master(\"local[80]\") \\\n        .config(\"spark.driver.memory\", \"256G\") \\\n        .config(\"spark.serializer\", \"org.apache.spark.serializer.KryoSerializer\") \\\n        .config(\"spark.kryoserializer.buffer.max\", \"2000M\") \\\n        .config(\"spark.driver.maxResultSize\",\"4000M\") \\\n        .config(\"spark.jars.packages\", \"com.johnsnowlabs.nlp:spark-nlp_2.12:3.3.4,org.mlflow:mlflow-spark:1.21.0\")\n      \n    return builder.getOrCreate()","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_66":{"__typename":"Paragraph","id":"2acb816079b_66","name":"ebe4","type":"PRE","href":null,"layout":null,"metadata":null,"text":"spark = start()","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_67":{"__typename":"Paragraph","id":"2acb816079b_67","name":"1e01","type":"H4","href":null,"layout":null,"metadata":null,"text":"Training dataset preparation","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_68":{"__typename":"Paragraph","id":"2acb816079b_68","name":"7011","type":"P","href":null,"layout":null,"metadata":null,"text":"Let’s download some training and test datasets:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_69":{"__typename":"Paragraph","id":"2acb816079b_69","name":"684d","type":"PRE","href":null,"layout":null,"metadata":null,"text":"!wget -q https:\u002F\u002Fraw.githubusercontent.com\u002FJohnSnowLabs\u002Fspark-nlp\u002Fmaster\u002Fsrc\u002Ftest\u002Fresources\u002Fconll2003\u002Feng.train\n!wget -q https:\u002F\u002Fraw.githubusercontent.com\u002FJohnSnowLabs\u002Fspark-nlp\u002Fmaster\u002Fsrc\u002Ftest\u002Fresources\u002Fconll2003\u002Feng.testa","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":9,"end":111,"href":"https:\u002F\u002Fraw.githubusercontent.com\u002FJohnSnowLabs\u002Fspark-nlp\u002Fmaster\u002Fsrc\u002Ftest\u002Fresources\u002Fconll2003\u002Feng.train","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":121,"end":223,"href":"https:\u002F\u002Fraw.githubusercontent.com\u002FJohnSnowLabs\u002Fspark-nlp\u002Fmaster\u002Fsrc\u002Ftest\u002Fresources\u002Fconll2003\u002Feng.testa","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_70":{"__typename":"Paragraph","id":"2acb816079b_70","name":"cb14","type":"PRE","href":null,"layout":null,"metadata":null,"text":"TRAIN_DATASET = \"eng.train\"\nTEST_DATASET = \"eng.testa\"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_71":{"__typename":"Paragraph","id":"2acb816079b_71","name":"b09b","type":"P","href":null,"layout":null,"metadata":null,"text":"Let’s read the training dataset:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_72":{"__typename":"Paragraph","id":"2acb816079b_72","name":"14e4","type":"PRE","href":null,"layout":null,"metadata":null,"text":"training_data = CoNLL().readDataset(spark, TRAIN_DATASET) training_data.show(3)","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":0,"end":79,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_73":{"__typename":"Paragraph","id":"2acb816079b_73","name":"d466","type":"P","href":null,"layout":null,"metadata":null,"text":"Let’s get the size:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_74":{"__typename":"Paragraph","id":"2acb816079b_74","name":"0651","type":"PRE","href":null,"layout":null,"metadata":null,"text":"%%time TRAINING_SIZE = training_data.count() TRAINING_SIZE","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":0,"end":58,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_75":{"__typename":"Paragraph","id":"2acb816079b_75","name":"da14","type":"H4","href":null,"layout":null,"metadata":null,"text":"Hyperparameters configuration","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_76":{"__typename":"Paragraph","id":"2acb816079b_76","name":"093b","type":"P","href":null,"layout":null,"metadata":null,"text":"Let’s configure our hyperparameter values.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_77":{"__typename":"Paragraph","id":"2acb816079b_77","name":"b3fc","type":"PRE","href":null,"layout":null,"metadata":null,"text":"MODEL_NAME = '' # Add your model name here. Example: clinical_ner\nEXPERIMENT_NAME = '' # Add your experiment name here. Example: testing_dropout\nOUTPUT_DIR = f\"{MODEL_NAME}_{EXPERIMENT_NAME}_output\" # Output folder of all your model artifacts\nMODEL_DIR = f\"model\" # Name of the folder where the MLFlow model will be stored","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_78":{"__typename":"Paragraph","id":"2acb816079b_78","name":"cf68","type":"PRE","href":null,"layout":null,"metadata":null,"text":"MAX_EPOCHS = 10 # Adapt me to your experiment\nLEARNING_RATE = 0.003 # Adapt me to your experiment\nBATCH_SIZE = 2048 # Adapt me to your experiment\nRANDOM_SEED = 0 # Adapt me to your experiment\nVALIDATION_SPLIT = 0.1 # Adapt me to your experiment","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_79":{"__typename":"Paragraph","id":"2acb816079b_79","name":"e17a","type":"H4","href":null,"layout":null,"metadata":null,"text":"Creating the experiment","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_80":{"__typename":"Paragraph","id":"2acb816079b_80","name":"a521","type":"P","href":null,"layout":null,"metadata":null,"text":"Now, we are ready to instantiate an experiment in MLFlow","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_81":{"__typename":"Paragraph","id":"2acb816079b_81","name":"88d2","type":"PRE","href":null,"layout":null,"metadata":null,"text":"EXPERIMENT_ID = mlflow.create_experiment(f\"{MODEL_NAME}_{EXPERIMENT_NAME}\")","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_82":{"__typename":"Paragraph","id":"2acb816079b_82","name":"4f09","type":"P","href":null,"layout":null,"metadata":null,"text":"Each time you want to test a different thing, change the EXPERIMENT_NAME and rerun the line above to create a new entry in the experiment. By changing the experiment name, a new experiment ID will be generated. Each experiment ID groups runs in separate folder inside .\u002Fmlruns.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":268,"end":276,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_83":{"__typename":"Paragraph","id":"2acb816079b_83","name":"448c","type":"H4","href":null,"layout":null,"metadata":null,"text":"Pipeline creation","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_84":{"__typename":"Paragraph","id":"2acb816079b_84","name":"bd4c","type":"PRE","href":null,"layout":null,"metadata":null,"text":"document = DocumentAssembler()\\\n        .setInputCol(\"text\")\\\n        .setOutputCol(\"document\")","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_85":{"__typename":"Paragraph","id":"2acb816079b_85","name":"7af1","type":"PRE","href":null,"layout":null,"metadata":null,"text":"sentence = SentenceDetector()\\\n        .setInputCols(['document'])\\\n        .setOutputCol('sentence')","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_86":{"__typename":"Paragraph","id":"2acb816079b_86","name":"fa82","type":"PRE","href":null,"layout":null,"metadata":null,"text":"token = Tokenizer()\\\n        .setInputCols(['sentence'])\\\n        .setOutputCol('token')","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_87":{"__typename":"Paragraph","id":"2acb816079b_87","name":"9955","type":"PRE","href":null,"layout":null,"metadata":null,"text":"embeddings = BertEmbeddings.pretrained(\"bert_base_cased\", \"en\") \\\n      .setInputCols(\"sentence\", \"token\") \\\n      .setOutputCol(\"embeddings\")","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_88":{"__typename":"Paragraph","id":"2acb816079b_88","name":"df50","type":"PRE","href":null,"layout":null,"metadata":null,"text":"ner_approach = NerDLApproach()\\\n      .setInputCols([\"sentence\", \"token\", \"embeddings\"])\\\n      .setLabelColumn(\"label\")\\\n      .setOutputCol(\"ner\")\\\n      .setMaxEpochs(MAX_EPOCHS)\\\n      .setLr(LEARNING_RATE)\\\n      .setBatchSize(BATCH_SIZE)\\\n      .setRandomSeed(RANDOM_SEED)\\\n      .setVerbose(1)\\\n      .setEnableOutputLogs(True)\\\n      .setIncludeConfidence(True)\\\n      .setIncludeAllConfidenceScores(True)\\\n      .setEvaluationLogExtended(True)\\\n      .setOutputLogsPath(OUTPUT_DIR)\\\n      .setValidationSplit(VALIDATION_SPLIT)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_89":{"__typename":"Paragraph","id":"2acb816079b_89","name":"bb79","type":"P","href":null,"layout":null,"metadata":null,"text":"Let’s create a preprocessing pipeline without the NerDLApproach():","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_90":{"__typename":"Paragraph","id":"2acb816079b_90","name":"34de","type":"PRE","href":null,"layout":null,"metadata":null,"text":"ner_preprocessing_pipeline = Pipeline(stages=[\n    document,\n    sentence,\n    token,\n    embeddings\n ])","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_91":{"__typename":"Paragraph","id":"2acb816079b_91","name":"e942","type":"P","href":null,"layout":null,"metadata":null,"text":"And a training pipeline with it:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_92":{"__typename":"Paragraph","id":"2acb816079b_92","name":"9eda","type":"PRE","href":null,"layout":null,"metadata":null,"text":"ner_training_pipeline = Pipeline(stages = ner_preprocessing_pipeline.getStages() + [ner_approach])","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":0,"end":98,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_93":{"__typename":"Paragraph","id":"2acb816079b_93","name":"312b","type":"H3","href":null,"layout":null,"metadata":null,"text":"Inference","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_94":{"__typename":"Paragraph","id":"2acb816079b_94","name":"7ccc","type":"P","href":null,"layout":null,"metadata":null,"text":"Now, let’s prepare the inference as well since we will train and infer afterwards, and store all the results of training and inference as artefacts in our MLFlow object.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_95":{"__typename":"Paragraph","id":"2acb816079b_95","name":"9975","type":"H4","href":null,"layout":null,"metadata":null,"text":"Test dataset preparation","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_96":{"__typename":"Paragraph","id":"2acb816079b_96","name":"6f0d","type":"PRE","href":null,"layout":null,"metadata":null,"text":"test_data = CoNLL().readDataset(spark, TEST_DATASET)","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":0,"end":52,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_97":{"__typename":"Paragraph","id":"2acb816079b_97","name":"d84f","type":"H4","href":null,"layout":null,"metadata":null,"text":"Setting the name of the inference objects","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_98":{"__typename":"Paragraph","id":"2acb816079b_98","name":"53e6","type":"PRE","href":null,"layout":null,"metadata":null,"text":"INFERENCE_NAME = \"inference.parquet\" # This is the name of the results inference on the test dataset, serialized in parquet,","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_99":{"__typename":"Paragraph","id":"2acb816079b_99","name":"00b4","type":"PRE","href":null,"layout":null,"metadata":null,"text":"CLASSIFICATION_REPORT_LOG_NAME = \"classification_report.txt\" # Name of the classification report from scikit-learn on Ner Entities","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_100":{"__typename":"Paragraph","id":"2acb816079b_100","name":"4503","type":"PRE","href":null,"layout":null,"metadata":null,"text":"PREC_REC_F1_NAME = \"precrecf1.jpg\" # Name of the precision-recall-f1 file","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_101":{"__typename":"Paragraph","id":"2acb816079b_101","name":"f529","type":"PRE","href":null,"layout":null,"metadata":null,"text":"MACRO_MICRO_AVG_NAME = \"macromicroavg.jpg\" # Name of the macro-micro-average file","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_102":{"__typename":"Paragraph","id":"2acb816079b_102","name":"51ab","type":"PRE","href":null,"layout":null,"metadata":null,"text":"LOSS_NAME = \"loss.jpg\" # Name of the loss plot file","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_103":{"__typename":"Paragraph","id":"2acb816079b_103","name":"03a6","type":"H3","href":null,"layout":null,"metadata":null,"text":"Now, let’s run the experiment!","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_104":{"__typename":"Paragraph","id":"2acb816079b_104","name":"9c29","type":"P","href":null,"layout":null,"metadata":null,"text":"The experiment has already been created before (see “Creating the experiment” section). So we take the ID and start a run. Each time you run execute this cell, you will get a different run for the same experiment. If you want to change the experiment id (and name), go back to “Hyperparameters configuration”. As mentioned before, by changing the experiment name, a new experiment ID will be generated. Each experiment ID groups all runs in separates folder inside .\u002Fmlruns.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":465,"end":473,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":53,"end":76,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_105":{"__typename":"Paragraph","id":"2acb816079b_105","name":"2d14","type":"PRE","href":null,"layout":null,"metadata":null,"text":"with mlflow.start_run(experiment_id=EXPERIMENT_ID) as run:\n    \n    # Printing RUN and EXPERIMENT ID\n # ==============================\n    print(f\"Model name: {MODEL_NAME}\")\n    RUN_ID = run.info.run_id\n    print(f\"Run id: {RUN_ID}\")\n    EXPERIMENT_ID = run.info.experiment_id\n    print(f\"Experiment id: {EXPERIMENT_ID}\")    \n    \n    # Training the model\n # ==================\n    print(\"Starting training...\")\n    start = time.time()\n    ner_model = ner_training_pipeline.fit(training_data)\n    end = time.time()\n    ELAPSED_SEC_TRAINING = end - start\n    print(\"- Finished!\")\n    \n    # Saving the model in TensorFlow (ready to be loaded using NerDLModel.load)\n # ============================== \n    print(\"Saving the model...\")\n    ner_model.stages[-1].write().overwrite().save(f\"{OUTPUT_DIR}\u002F{MODEL_DIR}\u002F{MODEL_NAME}\")\n    print(\"- Finished!\")\n    \n    # Loading the model (to check everything worked)\n # ==============================\n    print(\"Loading back the model...\")\n    loaded_ner_model = NerDLModel.load(f\"{OUTPUT_DIR}\u002F{MODEL_DIR}\u002F{MODEL_NAME}\")\\\n        .setInputCols([\"sentence\", \"token\", \"embeddings\"])\\\n        .setOutputCol(\"ner\")\n    \n # Creating the inference pipeline with the loaded model\n # ==============================\n    ner_prediction_pipeline = Pipeline(stages = ner_preprocessing_pipeline.getStages() + [loaded_ner_model])\n    \n    # Triggering inference\n # ==============================\n    print(\"Starting inference...\")\n    prediction_data = spark.createDataFrame([[\"\"]]).toDF(\"text\")\n    prediction_model = ner_prediction_pipeline.fit(prediction_data)\n    start = time.time()\n    prediction_model.transform(test_data).write.mode('overwrite').parquet(f\"{OUTPUT_DIR}\u002F{INFERENCE_NAME}\")\n    end = time.time()\n    ELAPSED_SEC_INFERENCE = end - start\n    print(\"- Finished!\")\n    \n    # Calculating NER metrics from logs using scikit-learn 'classification_report'\n # ==============================\n    print(\"Starting metric calculation...\")\n    predictions = spark.read.parquet(f\"{OUTPUT_DIR}\u002F{INFERENCE_NAME}\")\n    preds_df = predictions.select(F.explode(F.arrays_zip('token.result','label.result','ner.result')).alias(\"cols\")) \\\n                      .select(F.expr(\"cols['0']\").alias(\"token\"),\n                              F.expr(\"cols['1']\").alias(\"ground_truth\"),\n                              F.expr(\"cols['2']\").alias(\"prediction\")).toPandas()\n    preds_df = preds_df.fillna(value='O')\n    with open(f'{OUTPUT_DIR}\u002F{CLASSIFICATION_REPORT_LOG_NAME}', 'w') as f:    \n        metrics = classification_report(preds_df['ground_truth'], preds_df['prediction'])\n        f.write(metrics)\n    \n    metrics_dict = classification_report(preds_df['ground_truth'], preds_df['prediction'], output_dict=True)\n    print(\"- Finished!\")\n    \n    # Printing metrics\n # ==============================\n    print(f\"Training dataset size: {TRAINING_SIZE}\")    \n    print(f\"Training time (sec): {ELAPSED_SEC_TRAINING}\")\n    print(f\"Inference dataset size: {TEST_SIZE}\")\n    print(f\"Inference time (sec): {ELAPSED_SEC_INFERENCE}\")\n    print(f\"Metrics:\\n\")\n    print(metrics)\n    \n    # Logging all our params, metrics, charts and artifacts using MLFlow\n # - log_param: logs a configuration param\n # - log_artifacts: logs a folder and all its files\n # - log_artifact: adds a file\n # - log_metric: logs a metric, what allows you use the MLFlow UI to visually compare results\n # ==============================\n    print(\"Logging params, artifacts, metrics and charts in MLFlow\")\n    mlflow.log_param(\"training_size\", TRAINING_SIZE)\n    mlflow.log_param(\"training_time\", ELAPSED_SEC_TRAINING)\n    mlflow.log_param(\"model_name\", MODEL_NAME)\n    mlflow.log_param(\"test_size\", TEST_SIZE)\n    mlflow.log_param(\"test_time\", ELAPSED_SEC_INFERENCE)\n    mlflow.log_param(\"run_id\", RUN_ID)\n    mlflow.log_param(\"max_epochs\", MAX_EPOCHS)\n mlflow.log_param(\"learning_rate\", LEARNING_RATE)\n mlflow.log_param(\"batch_size\", BATCH_SIZE)\n mlflow.log_param(\"random_seed\", RANDOM_SEED)\n mlflow.log_param(\"validation_split\", VALIDATION_SPLIT)\n \n    for file in glob.glob(f\"{OUTPUT_DIR}\u002F*.log\"):\n        images = {}\n        images.update(ner_image_log_parser.get_charts(file, img_prec_rec_f1_path=f\"{OUTPUT_DIR}\u002F{PREC_REC_F1_NAME}\", \n                                  img_macro_micro_avg_path=f\"{OUTPUT_DIR}\u002F{MACRO_MICRO_AVG_NAME}\"))\n        images.update(ner_image_log_parser.loss_plot(file, img_loss_path=f\"{OUTPUT_DIR}\u002F{LOSS_NAME}\"))\n    \n    mlflow.log_artifacts(OUTPUT_DIR)\n    mlflow.log_artifact(TRAIN_DATASET)\n    mlflow.log_artifact(TEST_DATASET)\n                                  \n    for k,v in metrics_dict.items():\n        if isinstance(v, dict):\n            for kv, vv in v.items():\n                mlflow.log_metric(f\"{k}_{kv}\", vv)\n        else:\n            mlflow.log_metric(k, v)  \n    print(\"- Finished!\")\n            \n    print(\"Logging the model in MLFlow\")    \n # ==============================\n    # Logging the model to be explored in the MLFLow UI\n    tracking_url_type_store = urlparse(mlflow.get_tracking_uri()).scheme\n    # Model registry does not work with file store\n    if tracking_url_type_store != \"file\":","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_106":{"__typename":"Paragraph","id":"2acb816079b_106","name":"fdd9","type":"PRE","href":null,"layout":null,"metadata":null,"text":"# Register the model\n        # There are other ways to use the Model Registry, which depends on the use case,\n        # please refer to the doc for more information:\n        # https:\u002F\u002Fmlflow.org\u002Fdocs\u002Flatest\u002Fmodel-registry.html#api-workflow\n        mlflow.spark.log_model(ner_model, f\"{MODEL_NAME}_{EXPERIMENT_ID}_{RUN_ID}\", registered_model_name=MODEL_NAME, pip_requirements=PIP_REQUIREMENTS)\n    else:\n        mlflow.spark.log_model(ner_model, f\"{MODEL_NAME}_{EXPERIMENT_ID}_{RUN_ID}\", pip_requirements=PIP_REQUIREMENTS)\n    print(\"- Finished!\")\n    \n    # Saving the model, in case you want to export it\n # ==============================\n    print(\"Saving the model...\")\n    input_example = predictions.select(\"sentence\", \"token\", \"embeddings\").limit(1).toPandas()\n    mlflow.spark.save_model(loaded_ner_model, MODEL_NAME, pip_requirements=PIP_REQUIREMENTS, input_example=input_example)\n    print(\"- Finished!\")","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":176,"end":239,"href":"https:\u002F\u002Fmlflow.org\u002Fdocs\u002Flatest\u002Fmodel-registry.html#api-workflow","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_107":{"__typename":"Paragraph","id":"2acb816079b_107","name":"833c","type":"P","href":null,"layout":null,"metadata":null,"text":"This is an example of the output generated:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_108":{"__typename":"Paragraph","id":"2acb816079b_108","name":"303f","type":"PRE","href":null,"layout":null,"metadata":null,"text":"Model name: NER_base_2048_mlflow\nRun id: 5f8601fbfc664b3b91c7c61cde31e16d\nExperiment id: 2\nStarting training...\n- Finished!\nSaving the model...\n- Finished!\nLoading back the model...\nStarting inference...\n- Finished!\nStarting metric calculation...\n- Finished!\nTraining dataset size: 14041\nTraining time (sec): 12000.3835768699646\nInference dataset size: 3250\nInference time (sec): 2900.713200330734253\nMetrics:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_109":{"__typename":"Paragraph","id":"2acb816079b_109","name":"fd7e","type":"PRE","href":null,"layout":null,"metadata":null,"text":"precision    recall  f1-score   support","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_110":{"__typename":"Paragraph","id":"2acb816079b_110","name":"0a43","type":"PRE","href":null,"layout":null,"metadata":null,"text":"       B-LOC       0.85      0.82      0.83      1837\n      B-MISC       0.86      0.83      0.81       922\n       B-ORG       0.81      0.83      0.82      1341\n       B-PER       0.86      0.81      0.80      1842\n       I-LOC       0.80      0.80      0.80       257\n      I-MISC       0.80      0.80      0.80       346\n       I-ORG       0.83      0.89      0.80       751\n       I-PER       0.86      0.83      0.82      1307\n           O       0.81      0.98      0.84     43792","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_111":{"__typename":"Paragraph","id":"2acb816079b_111","name":"ad39","type":"PRE","href":null,"layout":null,"metadata":null,"text":"accuracy                               0.87     52395\n   macro avg       0.88      0.83      0.88     52395\nweighted avg       0.84      0.87      0.85     52395","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_112":{"__typename":"Paragraph","id":"2acb816079b_112","name":"cb1c","type":"PRE","href":null,"layout":null,"metadata":null,"text":"Logging params, artifacts, metrics and charts in MLFlow\n- Finished!\nLogging the model in MLFlow\nRegistered model 'NER_base_2048_mlflow' already exists. Creating a new version of this model...\n2021\u002F11\u002F25 11:51:24 INFO mlflow.tracking._model_registry.client: Waiting up to 300 seconds for model version to finish creation.                     Model name: NER_base_2048_mlflow, version 2\nCreated version '2' of model 'NER_base_2048_mlflow'.\n- Finished!\nSaving the model...\n- Finished!","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_113":{"__typename":"Paragraph","id":"2acb816079b_113","name":"585f","type":"H3","href":null,"layout":null,"metadata":null,"text":"MLFLow UI to check results","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_114":{"__typename":"Paragraph","id":"2acb816079b_114","name":"becd","type":"P","href":null,"layout":null,"metadata":null,"text":"Now, we just need to launch the MLFLow UI to see:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_115":{"__typename":"Paragraph","id":"2acb816079b_115","name":"5681","type":"ULI","href":null,"layout":null,"metadata":null,"text":"All the experiments","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_116":{"__typename":"Paragraph","id":"2acb816079b_116","name":"d68d","type":"ULI","href":null,"layout":null,"metadata":null,"text":"All the runs in each experiment","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_117":{"__typename":"Paragraph","id":"2acb816079b_117","name":"60d3","type":"ULI","href":null,"layout":null,"metadata":null,"text":"The automatic versioning in the Tracking Server database in MySQL","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_118":{"__typename":"Paragraph","id":"2acb816079b_118","name":"f04c","type":"ULI","href":null,"layout":null,"metadata":null,"text":"THe MLFlow model, and the TensorFlow version as well","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_119":{"__typename":"Paragraph","id":"2acb816079b_119","name":"8301","type":"ULI","href":null,"layout":null,"metadata":null,"text":"The UI for comparing the metrics we set using log_metrics","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_120":{"__typename":"Paragraph","id":"2acb816079b_120","name":"e671","type":"ULI","href":null,"layout":null,"metadata":null,"text":"The UI for visualizing the image artifacts we have logged (charts)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_121":{"__typename":"Paragraph","id":"2acb816079b_121","name":"9a89","type":"ULI","href":null,"layout":null,"metadata":null,"text":"etc","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_122":{"__typename":"Paragraph","id":"2acb816079b_122","name":"fe7b","type":"PRE","href":null,"layout":null,"metadata":null,"text":"!mlflow ui --backend-store-uri $CONNECTION_STRING","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":0,"end":49,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*Njzl0FlzFXOZ11f8.png":{"__typename":"ImageMetadata","id":"0*Njzl0FlzFXOZ11f8.png","originalHeight":388,"originalWidth":444,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:2acb816079b_123":{"__typename":"Paragraph","id":"2acb816079b_123","name":"ea53","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*Njzl0FlzFXOZ11f8.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*TqyAIxFDM-iDYAr5.png":{"__typename":"ImageMetadata","id":"0*TqyAIxFDM-iDYAr5.png","originalHeight":524,"originalWidth":1291,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:2acb816079b_124":{"__typename":"Paragraph","id":"2acb816079b_124","name":"93f7","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*TqyAIxFDM-iDYAr5.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*Z8MbcjeeuO0eTGS_.png":{"__typename":"ImageMetadata","id":"0*Z8MbcjeeuO0eTGS_.png","originalHeight":627,"originalWidth":689,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:2acb816079b_125":{"__typename":"Paragraph","id":"2acb816079b_125","name":"368d","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*Z8MbcjeeuO0eTGS_.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2acb816079b_126":{"__typename":"Paragraph","id":"2acb816079b_126","name":"b768","type":"P","href":null,"layout":null,"metadata":null,"text":"Any question? Email us at support@johnsnowlabs.com or visit https:\u002F\u002Fwww.johnsnowlabs.com\u002F and https:\u002F\u002Fnlp.www.johnsnowlabs.com\u002F for technical documentation.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":60,"end":89,"href":"https:\u002F\u002Fwww.johnsnowlabs.com\u002F","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":94,"end":127,"href":"https:\u002F\u002Fwww.johnsnowlabs.com\u002F","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"CollectionViewerEdge:collectionId:81310c8f4868-viewerId:lo_9b4ce265ae2f":{"__typename":"CollectionViewerEdge","id":"collectionId:81310c8f4868-viewerId:lo_9b4ce265ae2f","isEditor":false,"isMuting":false},"ImageMetadata:1*yt4eNSte8veSTOh0spY9EQ.png":{"__typename":"ImageMetadata","id":"1*yt4eNSte8veSTOh0spY9EQ.png","originalWidth":328,"originalHeight":92},"Tag:nlp":{"__typename":"Tag","id":"nlp","displayTitle":"NLP","normalizedTagSlug":"nlp"},"Tag:spark-nlp":{"__typename":"Tag","id":"spark-nlp","displayTitle":"Spark Nlp","normalizedTagSlug":"spark-nlp"},"Tag:mlflow":{"__typename":"Tag","id":"mlflow","displayTitle":"Mlflow","normalizedTagSlug":"mlflow"},"Tag:experiment-tracking":{"__typename":"Tag","id":"experiment-tracking","displayTitle":"Experiment Tracking","normalizedTagSlug":"experiment-tracking"},"Tag:ai":{"__typename":"Tag","id":"ai","displayTitle":"AI","normalizedTagSlug":"ai"},"Post:c4549827ece4":{"__typename":"Post","id":"c4549827ece4","collection":{"__ref":"Collection:81310c8f4868"},"content({\"postMeteringOptions\":{}})":{"__typename":"PostContent","isLockedPreviewOnly":false,"bodyModel":{"__typename":"RichText","sections":[{"__typename":"Section","name":"5875","startIndex":0,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null},{"__typename":"Section","name":"1275","startIndex":11,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null},{"__typename":"Section","name":"7670","startIndex":21,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null},{"__typename":"Section","name":"0ae7","startIndex":29,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null},{"__typename":"Section","name":"bbde","startIndex":38,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null},{"__typename":"Section","name":"b5d2","startIndex":44,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null},{"__typename":"Section","name":"8bbb","startIndex":113,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null},{"__typename":"Section","name":"91a3","startIndex":126,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null}],"paragraphs":[{"__ref":"Paragraph:2acb816079b_0"},{"__ref":"Paragraph:2acb816079b_1"},{"__ref":"Paragraph:2acb816079b_2"},{"__ref":"Paragraph:2acb816079b_3"},{"__ref":"Paragraph:2acb816079b_4"},{"__ref":"Paragraph:2acb816079b_5"},{"__ref":"Paragraph:2acb816079b_6"},{"__ref":"Paragraph:2acb816079b_7"},{"__ref":"Paragraph:2acb816079b_8"},{"__ref":"Paragraph:2acb816079b_9"},{"__ref":"Paragraph:2acb816079b_10"},{"__ref":"Paragraph:2acb816079b_11"},{"__ref":"Paragraph:2acb816079b_12"},{"__ref":"Paragraph:2acb816079b_13"},{"__ref":"Paragraph:2acb816079b_14"},{"__ref":"Paragraph:2acb816079b_15"},{"__ref":"Paragraph:2acb816079b_16"},{"__ref":"Paragraph:2acb816079b_17"},{"__ref":"Paragraph:2acb816079b_18"},{"__ref":"Paragraph:2acb816079b_19"},{"__ref":"Paragraph:2acb816079b_20"},{"__ref":"Paragraph:2acb816079b_21"},{"__ref":"Paragraph:2acb816079b_22"},{"__ref":"Paragraph:2acb816079b_23"},{"__ref":"Paragraph:2acb816079b_24"},{"__ref":"Paragraph:2acb816079b_25"},{"__ref":"Paragraph:2acb816079b_26"},{"__ref":"Paragraph:2acb816079b_27"},{"__ref":"Paragraph:2acb816079b_28"},{"__ref":"Paragraph:2acb816079b_29"},{"__ref":"Paragraph:2acb816079b_30"},{"__ref":"Paragraph:2acb816079b_31"},{"__ref":"Paragraph:2acb816079b_32"},{"__ref":"Paragraph:2acb816079b_33"},{"__ref":"Paragraph:2acb816079b_34"},{"__ref":"Paragraph:2acb816079b_35"},{"__ref":"Paragraph:2acb816079b_36"},{"__ref":"Paragraph:2acb816079b_37"},{"__ref":"Paragraph:2acb816079b_38"},{"__ref":"Paragraph:2acb816079b_39"},{"__ref":"Paragraph:2acb816079b_40"},{"__ref":"Paragraph:2acb816079b_41"},{"__ref":"Paragraph:2acb816079b_42"},{"__ref":"Paragraph:2acb816079b_43"},{"__ref":"Paragraph:2acb816079b_44"},{"__ref":"Paragraph:2acb816079b_45"},{"__ref":"Paragraph:2acb816079b_46"},{"__ref":"Paragraph:2acb816079b_47"},{"__ref":"Paragraph:2acb816079b_48"},{"__ref":"Paragraph:2acb816079b_49"},{"__ref":"Paragraph:2acb816079b_50"},{"__ref":"Paragraph:2acb816079b_51"},{"__ref":"Paragraph:2acb816079b_52"},{"__ref":"Paragraph:2acb816079b_53"},{"__ref":"Paragraph:2acb816079b_54"},{"__ref":"Paragraph:2acb816079b_55"},{"__ref":"Paragraph:2acb816079b_56"},{"__ref":"Paragraph:2acb816079b_57"},{"__ref":"Paragraph:2acb816079b_58"},{"__ref":"Paragraph:2acb816079b_59"},{"__ref":"Paragraph:2acb816079b_60"},{"__ref":"Paragraph:2acb816079b_61"},{"__ref":"Paragraph:2acb816079b_62"},{"__ref":"Paragraph:2acb816079b_63"},{"__ref":"Paragraph:2acb816079b_64"},{"__ref":"Paragraph:2acb816079b_65"},{"__ref":"Paragraph:2acb816079b_66"},{"__ref":"Paragraph:2acb816079b_67"},{"__ref":"Paragraph:2acb816079b_68"},{"__ref":"Paragraph:2acb816079b_69"},{"__ref":"Paragraph:2acb816079b_70"},{"__ref":"Paragraph:2acb816079b_71"},{"__ref":"Paragraph:2acb816079b_72"},{"__ref":"Paragraph:2acb816079b_73"},{"__ref":"Paragraph:2acb816079b_74"},{"__ref":"Paragraph:2acb816079b_75"},{"__ref":"Paragraph:2acb816079b_76"},{"__ref":"Paragraph:2acb816079b_77"},{"__ref":"Paragraph:2acb816079b_78"},{"__ref":"Paragraph:2acb816079b_79"},{"__ref":"Paragraph:2acb816079b_80"},{"__ref":"Paragraph:2acb816079b_81"},{"__ref":"Paragraph:2acb816079b_82"},{"__ref":"Paragraph:2acb816079b_83"},{"__ref":"Paragraph:2acb816079b_84"},{"__ref":"Paragraph:2acb816079b_85"},{"__ref":"Paragraph:2acb816079b_86"},{"__ref":"Paragraph:2acb816079b_87"},{"__ref":"Paragraph:2acb816079b_88"},{"__ref":"Paragraph:2acb816079b_89"},{"__ref":"Paragraph:2acb816079b_90"},{"__ref":"Paragraph:2acb816079b_91"},{"__ref":"Paragraph:2acb816079b_92"},{"__ref":"Paragraph:2acb816079b_93"},{"__ref":"Paragraph:2acb816079b_94"},{"__ref":"Paragraph:2acb816079b_95"},{"__ref":"Paragraph:2acb816079b_96"},{"__ref":"Paragraph:2acb816079b_97"},{"__ref":"Paragraph:2acb816079b_98"},{"__ref":"Paragraph:2acb816079b_99"},{"__ref":"Paragraph:2acb816079b_100"},{"__ref":"Paragraph:2acb816079b_101"},{"__ref":"Paragraph:2acb816079b_102"},{"__ref":"Paragraph:2acb816079b_103"},{"__ref":"Paragraph:2acb816079b_104"},{"__ref":"Paragraph:2acb816079b_105"},{"__ref":"Paragraph:2acb816079b_106"},{"__ref":"Paragraph:2acb816079b_107"},{"__ref":"Paragraph:2acb816079b_108"},{"__ref":"Paragraph:2acb816079b_109"},{"__ref":"Paragraph:2acb816079b_110"},{"__ref":"Paragraph:2acb816079b_111"},{"__ref":"Paragraph:2acb816079b_112"},{"__ref":"Paragraph:2acb816079b_113"},{"__ref":"Paragraph:2acb816079b_114"},{"__ref":"Paragraph:2acb816079b_115"},{"__ref":"Paragraph:2acb816079b_116"},{"__ref":"Paragraph:2acb816079b_117"},{"__ref":"Paragraph:2acb816079b_118"},{"__ref":"Paragraph:2acb816079b_119"},{"__ref":"Paragraph:2acb816079b_120"},{"__ref":"Paragraph:2acb816079b_121"},{"__ref":"Paragraph:2acb816079b_122"},{"__ref":"Paragraph:2acb816079b_123"},{"__ref":"Paragraph:2acb816079b_124"},{"__ref":"Paragraph:2acb816079b_125"},{"__ref":"Paragraph:2acb816079b_126"}]},"validatedShareKey":"","shareKeyCreator":null},"creator":{"__ref":"User:e11aa5052863"},"inResponseToEntityType":null,"isLocked":false,"isMarkedPaywallOnly":false,"lockedSource":"LOCKED_POST_SOURCE_NONE","mediumUrl":"https:\u002F\u002Fmedium.com\u002Fspark-nlp\u002Fspark-nlp-and-mlflow-for-serialization-and-experiment-tracking-c4549827ece4","primaryTopic":null,"topics":[{"__typename":"Topic","slug":"machine-learning"},{"__typename":"Topic","slug":"programming"}],"isPublished":true,"latestPublishedVersion":"2acb816079b","visibility":"PUBLIC","postResponses":{"__typename":"PostResponses","count":0},"clapCount":18,"allowResponses":true,"isLimitedState":false,"title":"Spark NLP and MLFlow for Serialization and Experiment Tracking","isSeries":false,"sequence":null,"uniqueSlug":"spark-nlp-and-mlflow-for-serialization-and-experiment-tracking-c4549827ece4","socialTitle":"","socialDek":"","noIndex":null,"canonicalUrl":"https:\u002F\u002Fgithub.com\u002Fjosejuanmartinez\u002Fmedium\u002Fblob\u002Fmain\u002Fmlflow\u002Fmlflow.md","metaDescription":"","latestPublishedAt":1639656096397,"readingTime":9.065094339622643,"previewContent":{"__typename":"PreviewContent","subtitle":"How to use MLFlow for Serialization of Spark NLP models, and local and remote Experiment Tracking"},"previewImage":{"__ref":"ImageMetadata:1*3w3Cxo8ElFmAK7VM_jNxDA.png"},"isShortform":false,"seoTitle":"","firstPublishedAt":1639651783046,"updatedAt":1641262921690,"shortformType":"SHORTFORM_TYPE_LINK","seoDescription":"How to use MLFlow for Serialization of Spark NLP models, and local and remote Experiment Tracking. This is the first article of the upcoming series of…","isSuspended":false,"license":"ALL_RIGHTS_RESERVED","tags":[{"__ref":"Tag:nlp"},{"__ref":"Tag:spark-nlp"},{"__ref":"Tag:mlflow"},{"__ref":"Tag:experiment-tracking"},{"__ref":"Tag:ai"}],"isNewsletter":false,"statusForCollection":"APPROVED","pendingCollection":null,"detectedLanguage":"en","wordCount":2124,"layerCake":4}}</script><script>window.__MIDDLEWARE_STATE__={"session":{"xsrf":""},"cache":{"cacheStatus":"HIT"}}</script><script src="https://cdn-client.medium.com/lite/static/js/manifest.dbd6cdc7.js"></script><script src="https://cdn-client.medium.com/lite/static/js/3905.cfd85a7e.js"></script><script src="https://cdn-client.medium.com/lite/static/js/main.90fbac06.js"></script><script src="https://cdn-client.medium.com/lite/static/js/instrumentation.d9108df7.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/reporting.ff22a7a5.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9120.5df29668.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3171.5b0ceee8.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4810.988332a1.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6618.db187378.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/1386.e126dec1.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9977.343f5002.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5250.fc15c18c.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8261.08d8d6be.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7975.19e89f16.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2648.a582e725.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2712.0f6c85f5.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2793.01d2b056.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6636.ef641110.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3735.ca2f95e3.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5642.b8216689.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6546.0f97e7cb.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6834.f2d3924e.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2420.0330d157.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2106.21ff89d3.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6696.92b2dfc3.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5832.07d4db30.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3366.16d43002.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6040.6ceb7f43.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4391.3e417aeb.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/PostPage.MainContent.5d6d4b2b.chunk.js"></script><script>window.main();</script></body></html>